# ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2022å¹´11æœˆï¼‰

æ–‡æ›¸ã®ä¸€è¦§

- [JTC1/SC22/WG21 - Papers 2022 mailing2022-11](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/#mailing2022-11)

å…¨éƒ¨ã§75æœ¬ã‚ã‚Šã¾ã™ã€‚ï¼ˆæ–°è¦35æœ¬

### [N4924 WG21 2022-10 Admin telecon minutes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4924.pdf)

WG21ã®å„ä½œæ¥­éƒ¨ä¼šã®ç®¡ç†è€…ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è­°äº‹éŒ²ã€‚

å‰å›ã‹ã‚‰ä»Šå›ã®ä¼šè­°ã®é–“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å ±å‘ŠãŒã•ã‚Œã¦ã„ã¾ã™ã€‚

### [N4925 2023-02 Issaquah meeting information](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4925.pdf)

2023å¹´2æœˆã«è¡Œã‚ã‚Œã‚‹äºˆå®šã®WG21å…¨ä½“ä¼šè­°ã®ã‚¤ãƒ³ãƒ•ã‚©ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã€‚

æ¬¡å›ã¯ã€ã‚¢ãƒ¡ãƒªã‚«ã®ãƒ¯ã‚·ãƒ³ãƒˆãƒ³å·ã‚¤ã‚µã‚¯ã‚¢ã§è¡Œã‚ã‚Œã‚‹äºˆå®šã§ã€å†…å®¹ã¯ä¸»ã«ä¼šå ´ã®æ¡ˆå†…ã«ã¤ã„ã¦ã§ã™ã€‚

### [N4926 Working Draft, C++ Extensions for Library Fundamentals, Version 3](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4926.html)

Library Fundamental v3ã®ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆã€‚

### [N4927 Editor's Report: C++ Extensions for Library Fundamentals, Version 3](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/n4927.html)

â†‘ã®å·®åˆ†ã‚’è¨˜ã—ãŸæ–‡æ›¸ã€‚

å¤‰æ›´ç‚¹ã¯

- P2705R0 : å ±å‘Šã•ã‚ŒãŸIssueã®è§£æ±º
- P0987R2 : å‹æ¶ˆå»ã®ä»£ã‚ã‚Šã«`polymorphic_allocator<>`ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´
- P2708R1

ã®å†…å®¹ã‚’é©ç”¨ã—ãŸã“ã¨ãªã©ã§ã™ã€‚

### [P0901R10 Size feedback in operator new](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0901r10.html)
### [P1018R18 C++ Language Evolution status ğŸ¦  pandemic edition ğŸ¦  2022/07â€“2022/11](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1018r18.html)

2022å¹´7æœˆã‹ã‚‰11æœˆã«ã‹ã‘ã¦ã®EWGæ´»å‹•å ±å‘Šæ›¸ã€‚

ä¸»ã«ã‚³ã‚¢è¨€èªã®Issueã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒä¸»ã ã£ãŸã‚ˆã†ã§ã™ã€‚

ãªãŠã€C++23ã«ã¤ã„ã¦ã®ä½œæ¥­ã¯çµ‚äº†ã—ã¦ã„ã‚‹ã‚‰ã—ãã€ã“ã‚Œä»¥é™ã‚³ã‚¢è¨€èªã®ææ¡ˆã‚’C++23ã«å‘ã‘ã¦ä½œæ¥­ã™ã‚‹ã“ã¨ã¯ãªã„ã‚ˆã†ã§ã™ã€‚

### [P1018R19 C++ Language Evolution status](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1018r19.html)

2022å¹´11æœˆã®konaä¼šè­°ã®EWGæ´»å‹•å ±å‘Šæ›¸ã€‚

ã‚³ã‚¢è¨€èªã®Issueã‚„NBã‚³ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æŠ•ç¥¨ãŒè¡Œã‚ã‚Œã¦ã„ãŸã‚ˆã†ã§ã™ã€‚

C++26ã«å‘ã‘ã¦ã€ä»¥ä¸‹ã®ææ¡ˆãŒCWGã«è»¢é€ã•ã‚Œã¾ã—ãŸ

- [P1061R0 Structured Bindings can introduce a Pack](https://wg21.link/P1061R0)
- [P2361R0 Unevaluated string literals](https://wg21.link/P2361R0)
- [P2014R0 aligned allocation of coroutine frames](https://wg21.link/P2014R0)
- [P0609R1 Attributes for Structured Bindings](https://wg21.link/P0609R1)
- [P2558R0 Add @, $, and ` to the basic character set](https://wg21.link/P2558R0)
- [P2621R0 UB? In my Lexer?](https://wg21.link/P2621R0)
- [P2686R0 Updated wording and implementation experience for P1481 (constexpr structured bindings)](https://wg21.link/P2686R0)
- [P1967R0 #embed - a simple, scannable preprocessor-based resource acquisition method](https://wg21.link/P1967R0)
- [P2593R0 Allowing static_assert(false)](https://wg21.link/P2593R0)

æ¬¡ã®ææ¡ˆã¯LEWGã«è»¢é€ã•ã‚Œã¾ã—ãŸ

- [P2641R0 Checking if a union alternative is active](https://wg21.link/P2641R0)
- [P2546R0 Debugging Support](https://wg21.link/P2546R0)
- [P0876R5 fiber_context - fibers without scheduler](https://wg21.link/P0876R5)
- [P2141R0 Aggregates are named tuples](https://wg21.link/P2141R0)

### [P1028R4 SG14 status_code and standard error object](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1028r4.pdf)

ç¾åœ¨ã®`<sysytem_error>`ã«ã‚ã‚‹ã‚‚ã®ã‚’ç½®ãæ›ãˆã‚‹ã€ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰/ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ä¼æ¬ã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ©Ÿèƒ½ã®ææ¡ˆã€‚

`<sysytem_error>`ãƒ˜ãƒƒãƒ€ã¯`std::error_code`é–¢é€£ã®ã‚‚ã®ã‚’æ“ã™ã‚‹ãƒ˜ãƒƒãƒ€ã§ã€‚C++11ã«ã¦ã€å½“æ™‚ã®Filesystem TSã‹ã‚‰åˆ†é›¢ã•ã‚Œã‚‹å½¢ã§å…ˆè¡Œå°å…¥ã•ã‚Œã¾ã—ãŸã€‚`<filesystem>`ã‚’ä½¿ã†ã¨ãä»¥å¤–ã¯ã‚ã¾ã‚Šä½¿ç”¨ã•ã‚Œã‚‹ã“ã¨ã¯ãªã„ã‚ˆã†ã§ã™ãŒã€ã“ã‚Œã¯æ¨™æº–ã®å¤šãã®ãƒ˜ãƒƒãƒ€ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å‚ç…§ã•ã‚Œã¦ãŠã‚Šã€æ¨™æº–ãƒ˜ãƒƒãƒ€ã®å†…éƒ¨ä¾å­˜é–¢ä¿‚ã®ä¸€éƒ¨ã‚’æ§‹æˆã—ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®è¨­è¨ˆä¸Šã®å•é¡Œã¯è¿‘å¹´2018å¹´ï¼‰æ˜ã‚‰ã‹ã«ãªã‚Šã€æ­£ã—ãä½¿ã†ã“ã¨ãŒé›£ã—ãã€ã‚¨ãƒ©ãƒ¼å ±å‘Šã®ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãªã®ã«ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã—ã‚„ã™ã„ãªã©ã®å•é¡ŒãŒã‚ã‚Šã¾ã—ãŸã€‚ãã‚Œã¯[P0824R1](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0824r1.html)ã§çºã‚ã‚‰ã‚Œã¦å ±å‘Šã•ã‚Œã€ç¾åœ¨ã®`std::error_code`å‘¨ã‚Šã®å•é¡Œã‚’æ”¹å–„ã—ãŸä»£æ›¿ã®æ©Ÿèƒ½ãŒè¿½æ±‚ã•ã‚Œã¾ã—ãŸã€‚

ã“ã®ææ¡ˆã¯ã€ãã®ã‚ˆã†ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ã¨ã¨ã‚‚ã«Boost.Outcomeãªã©ã§ã®çµŒé¨“ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€ç¾åœ¨ã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®å•é¡Œã‚’è§£æ±ºã—ç½®ãæ›ãˆã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ©Ÿèƒ½ã‚’ææ¡ˆã™ã‚‹ã‚‚ã®ã§ã™ã€‚

ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸­æ ¸ã¯ã€`std::error_code`ã‚’ç½®ãæ›ãˆã‚‹`std::system_code`ã¨ã„ã†ã‚¯ãƒ©ã‚¹å‹ã§ã™ã€‚ã“ã‚Œã¯ã‚·ã‚¹ãƒ†ãƒ ã®ä½•ã‹ã—ã‚‰ã®ã‚³ãƒ¼ãƒ‰ï¼ˆå¿…ãšã—ã‚‚ã‚¨ãƒ©ãƒ¼ã§ã¯ãªã„ï¼‰ã‚’çµ±ä¸€çš„ã«è¡¨ç¾ã™ã‚‹ãŸã‚ã®ã‚¯ãƒ©ã‚¹ã§ã€ä½¿ç”¨æ„Ÿã¯ã»ã¼`std::error_code`ã¨åŒæ§˜ã§ã™ã€‚

```cpp
std::system_code sc;  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ§‹ç¯‰ã¯ç©ºï¼ˆæˆåŠŸã§ã‚‚ã‚¨ãƒ©ãƒ¼ã§ã‚‚ãªã„ï¼‰
native_handle_type h = open_file(path, sc);

// Is the code a failure?
if(sc.failure()) {
  // Do semantic comparison to test if this was a file not found failure
  // This will match any system-specific error codes meaning a file not found
  if(sc != std::errc::no_such_file_or_directory) {
    std::cerr << "FATAL: " << sc.message().c_str() << std::endl;
    std::terminate();
  }
}
```

ã“ã®`open_file()`ã¯ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«ã‚ˆã£ã¦æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã§ãã¾ã™ã€‚

```cpp
// POSIXã‚·ã‚¹ãƒ†ãƒ ã®å ´åˆ
using native_handle_type = int;

native_handle_type open_file(const char *path, std::system_code &sc) noexcept {
  sc.clear();  // éã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã«ã™ã‚‹
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ¼ãƒ—ãƒ³
  native_handle_type h = ::open(path, O_RDONLY);

  // ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
  if (h == -1) {
    // errnoã¯system_codeã«å‹æ¶ˆå»ã•ã‚Œã‚‹
    sc = std::posix_code(errno);
  }

  return h;
}
```

```cpp
// Windowsã®å ´åˆ
using native_handle_type = HANDLE;

native_handle_type open_file(const wchar_t *path, std::system_code &sc) noexcept {
  sc.clear();  // éã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã«ã™ã‚‹

  // ãƒ•ã‚¡ã‚¤ãƒ«ã‚ªãƒ¼ãƒ—ãƒ³
  native_handle_type h = CreateFile(path, GENERIC_READ,
    FILE_SHARE_READ|FILE_SHARE_WRITE|FILE_SHARE_DELETE,
    nullptr,
    OPEN_EXISTING,
    FILE_ATTRIBUTE_NORMAL,
    nullptr
  );

  // ã‚¨ãƒ©ãƒ¼ãƒã‚§ãƒƒã‚¯
  if (h == INVALID_HANDLE_VALUE) {
    // GetLastError()ã®çµæœã¯system_codeã«å‹æ¶ˆå»ã•ã‚Œã‚‹
    sc = std::win32_code(GetLastError());
  }

  return h;
}
```

ã“ã®æ–°ã—ã„`system_code`ã¯ã€`std::error_code`ã®æ¬¡ã®ã‚ˆã†ãªç‚¹ã‚’æ”¹å–„ã—ã¦ã„ã¾ã™

- `<string>`ã«ä¾å­˜ã—ãªã„
- `constexpr`å¯¾å¿œ
- `std::error_category`ã®ã€ãƒªãƒ³ã‚¯æ™‚ã«ãƒ©ãƒ³ãƒ€ãƒ ã«æ¯”è¼ƒãŒå£Šã‚Œã‚‹å•é¡ŒãŒèµ·ããªã„
- `bool`å¤‰æ›æ™‚ã®æ›–æ˜§ã•ãŒãªã„
    - `std::error_code`ã®`bool`å¤‰æ›ã§`true`ãŒå¸°ã‚‹ã®ã¯ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®æ™‚ã¨ã¯é™ã‚‰ãªã„ï¼ˆå€¤ãŒéã‚¼ãƒ­ã§ã‚ã‚‹ã“ã¨ã—ã‹æ„å‘³ã—ãªã„ï¼‰
- ä¸Šè¨˜ã¨é–¢é€£ã—ã¦ã€`0`ã‚’ç‰¹åˆ¥æ‰±ã„ã›ãšã€æˆåŠŸã¨å¤±æ•—ã‚’ä»»æ„ã«è¡¨ç¾ã§ãã‚‹
- æ¯”è¼ƒãŒæ„å‘³ãƒ™ãƒ¼ã‚¹ï¼ˆã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨ã®æ¯”è¼ƒã¯ãã®å€¤ã®æ¯”è¼ƒã§ã¯ãªãã€æ„å‘³ã™ã‚‹ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã®æ¯”è¼ƒã«ãªã‚‹ï¼‰
    - `std::error_code`ã®ã‚ˆã†ã«å€¤ãƒ™ãƒ¼ã‚¹ã§ã¯ãªã„
    - `std::error_condition`ã¨`std::error_code`ã®ã‚ˆã†ã«åˆ†ã‹ã‚Šã¥ã‚‰ã„é–¢ä¿‚æ€§ã®ã‚¯ãƒ©ã‚¹ã‚’å¿…è¦ã¨ã—ãªã„
- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã®å‹ãŒä»»æ„ï¼ˆ`std::error_code`ã¯`int`é™å®šï¼‰
- è¤‡æ•°ã®ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’æ‰±ã†ã“ã¨ãŒã§ãã‚‹
- ã‚¨ãƒ©ãƒ¼ã‚«ãƒ†ã‚´ãƒªã®å³å¯†ãªåŒºåˆ¥

ã¾ãŸã€ã“ã®ææ¡ˆã«ã¯å«ã¾ã‚Œã¦ã„ãªã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ãŒã€P0709ã§ææ¡ˆã•ã‚Œã¦ã„ã‚‹é™çš„ä¾‹å¤–ã‚¯ãƒ©ã‚¹`std::error`ã‚’å®Ÿè£…ã—ã€ãã‚Œã‚’ã‚¨ãƒ©ãƒ¼çŠ¶æ…‹ã¨ã™ã‚‹æˆ»ã‚Šå€¤å‹`result<T>`ã‚‚ææ¡ˆã—ã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚ã“ã‚Œã¯ã€`std::expected<T, std::error>`ã¨éå¸¸ã«ã‚ˆãä¼¼ã¦ã„ã‚‹ã‚¯ãƒ©ã‚¹ã§ã™ãŒã€ã‚¨ãƒ©ãƒ¼å‹ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦è‹¥å¹²ç•°ãªã‚‹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

- [P0824R1 Summary of SG14 discussion on <system_error>](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0824r1.html)
- [Reference implementation for proposed SG14 status_code (<system_error2>) in C++ 11 - Github](https://github.com/ned14/status-code)
- [P1028 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/405)

### [P1202R5 Asymmetric Fences](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1202r5.pdf)
### [P1264R2 Revising the wording of stream input operations](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1264r2.pdf)

`<istream>`ã®ä¾‹å¤–ã«é–¢ã™ã‚‹è¦å®šã‚’æ”¹å–„ã™ã‚‹ææ¡ˆã€‚

ç¾åœ¨ã®`<istream>`ã®è¦å®šã¯éå¸¸ã«è¤‡é›‘ã«ãªã£ã¦ãŠã‚Šã€ç‰¹ã«ã„ã¤ä¾‹å¤–ã‚’æŠ•ã’ã‚‹ã®ã‹ãŒåˆ†ã‹ã‚Šã¥ã‚‰ãã€ãã‚Œã«ã‚ˆã£ã¦å®Ÿè£…é–“ã§æŒ¯ã‚‹èˆã„ã«å·®ç•°ãŒç”Ÿã˜ã¦ã„ã¾ã™ã€‚

ç©ºã§ãªã„ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‹ã‚‰ã®æŠ½å‡ºã«å¤±æ•—ã™ã‚‹å…¥åŠ›æ“ä½œã®ä¾‹

```cpp
#include <iostream>
#include <sstream>

int main () {
  std::stringbuf buf("not empty");
  std::istream is(&buf);

  // failbitãŒã‚»ãƒƒãƒˆã•ã‚ŒãŸã‚‰ä¾‹å¤–ã‚’é€å‡ºã™ã‚‹
  is.exceptions(std::ios::failbit);

  bool threw = false;
  
  try {
    unsigned int tmp{};
    // æ•°å€¤ã‚’èª­ã¿å–ã‚Œãªã„ã®ã§å¤±æ•—ã™ã‚‹
    is >> tmp;
  } catch (std::ios::failure const&) {
    threw = true;
  }

  std::cout << "bad = " << is.bad() << std::endl;
  std::cout << "fail = " << is.fail() << std::endl;
  std::cout << "eof = " << is.eof() << std::endl;
  std::cout << "threw = " << threw << std::endl;
}
```

ã“ã®çµæœã¯ã€å®Ÿè£…ã«ã‚ˆã£ã¦æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

||libstdc++|MSVC STL|libc++|
|---|---|---|---|
|bad|0|0|1|
|fail|1|1|1|
|eof|0|0|0|
|threw|1|1|0|

æ­£ã—ã„ã®ã¯libstdc++/MSVC STLã®æŒ¯ã‚‹èˆã„ã«æ€ãˆã¾ã™ãŒã€ç¾åœ¨ã®è¤‡é›‘ãªè¦å®šã«ã‚ˆã‚Œã°libc++ã®æŒ¯ã‚‹èˆã„ã‚‚åˆæ³•ã®ã‚ˆã†ã§ã™ã€‚ãŸã ã€ã“ã®æŒ¯ã‚‹èˆã„ã¯æœ‰ç”¨ã§ã¯ãªãã€ã»ã¼ç„¡æ„å‘³ã§ã™ã€‚

ç©ºã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‹ã‚‰ã®æŠ½å‡ºã«å¤±æ•—ã™ã‚‹å…¥åŠ›æ“ä½œã®ä¾‹

```cpp
#include <iostream>
#include <sstream>

int main () {
  std::stringbuf buf; // empty
  std::istream is(&buf);

  // failbitãŒã‚»ãƒƒãƒˆã•ã‚ŒãŸã‚‰ä¾‹å¤–ã‚’é€å‡ºã™ã‚‹
  is.exceptions(std::ios::failbit);

  bool threw = false;
  
  try {
    unsigned int tmp{};
    // æ•°å€¤ã‚’èª­ã¿å–ã‚Œãªã„ã®ã§å¤±æ•—ã™ã‚‹
    is >> tmp;
  } catch (std::ios::failure const&) {
    threw = true;
  }

  std::cout << "bad = " << is.bad() << std::endl;
  std::cout << "fail = " << is.fail() << std::endl;
  std::cout << "eof = " << is.eof() << std::endl;
  std::cout << "threw = " << threw << std::endl;
}
```

ã“ã®çµæœã¯ã€å®Ÿè£…ã«ã‚ˆã£ã¦æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™

||libstdc++|MSVC STL|libc++|
|---|---|---|---|
|bad|0|0|1|
|fail|1|1|1|
|eof|1|1|1|
|threw|1|1|0|

æ­£ã—ã„ã®ã¯libstdc++/MSVC STLã®æŒ¯ã‚‹èˆã„ã«æ€ãˆã¾ã™ãŒã€ã‚„ã¯ã‚Šã“ã‚Œã‚‚libc++ã®æŒ¯ã‚‹èˆã„ãŒé–“é•ã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã‚ˆã†ã§ã™ã€‚

ã“ã®ææ¡ˆã¯ã€ã“ã®ã‚ˆã†ãªçŠ¶æ³ã‚’æ‹›ã„ã¦ã„ã‚‹è¤‡é›‘ãªè¦å®šã‚’æ˜ç¢ºã«ãªã‚‹ã‚ˆã†ã«ä¿®æ­£ã—ã€libstdc++/MSVC STLã®æŒ¯ã‚‹èˆã„ã‚’ç¶­æŒã—ãŸã¾ã¾libc++ã®æŒ¯ã‚‹èˆã„ã‚’ä¿®æ­£ã—ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

- [LWG Issue 2349. Clarify input/output function rethrow behavior](https://cplusplus.github.io/LWG/issue2349)
- [P1264 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/342)

### [P1478R8 Byte-wise atomic memcpy](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1478r8.html)
### [P1619R2 Functions for Testing Boundary Conditions on Integer Operations](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1619r2.pdf)

æ•´æ•°æ¼”ç®—ã®å¢ƒç•Œæ¡ä»¶ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªé–¢æ•°ã®ææ¡ˆã€‚

C++ã®æ•´æ•°æ¼”ç®—ã«ã¯èª°ã‚‚ãŒé­é‡ã™ã‚‹å¢ƒç•Œæ¡ä»¶ï¼ˆæœ€å¤§å€¤ãƒ»æœ€å°å€¤ã‚’è·¨ãã‚ˆã†ãªæ¼”ç®—ï¼‰ã«ã¤ã„ã¦ã®ç½ ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯åˆå¿ƒè€…ã§ã‚‚ç°¡å˜ã«é­é‡ã—ã†ã‚‹ä¸€æ–¹ã§ã€ãã®ç†è§£ã«ã¯C++è¨€èªã®çŸ¥è­˜ã‚„æ•´æ•°ã®ãƒãƒ¼ãƒ‰ä¸Šè¡¨ç¾ã®çŸ¥è­˜ã€æ•°å­¦çš„ãªçŸ¥è­˜ãªã©ã‚’å¿…è¦ã¨ã—ã€ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«ãã®åˆ¤å®šã‚’æ›¸ãã“ã¨ã¯ã‹ãªã‚Šã®æ³¨æ„ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚

ææ¡ˆã‚ˆã‚Šã€æ•´æ•°ã®äºŒé …æ¼”ç®—ã§è¡Œã‚ã‚Œã‚‹ã“ã¨ã®æµã‚Œå›³

![](20221224_wg21_paper_202211/step_in_alithmetric_binary_op.png)

ï¼ˆææ¡ˆã«ã‚ˆã‚Œã°ã€ã“ã®å›³ã¯ä¿®æ­£ãŒå¿…è¦ãªç®‡æ‰€ãŒã‚ã‚Šã€ä»–ã®éƒ¨åˆ†ã«ã¤ã„ã¦ã‚‚ä¿®æ­£ã®å¿…è¦ãŒã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã€ãã‚Œã“ããŒæ•´æ•°æ¼”ç®—ã®è¤‡é›‘ã•ã‚’ç¾ã—ã¦ã„ã‚‹ã€ã¨ã®ã“ã¨ã§ã™ãƒ»ãƒ»ãƒ»ï¼‰

ã“ã®ææ¡ˆã¯ã€ãã®ã‚ˆã†ãªå¢ƒç•Œæ¡ä»¶ã«é–¢ã™ã‚‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ã€æ¡ä»¶ã‚’ç°¡å˜ã‹ã¤ç›´æ¥çš„ã«å‘½ååŠã³è¡¨ç¾ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªé–¢æ•°ã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

ã“ã®ææ¡ˆã«ã‚ˆã‚‹é–¢æ•°ç¾¤ã¯å¤šå²ã«æ¸¡ã‚Šã¾ã™ãŒã€ã„ãšã‚Œã‚‚ãƒ—ãƒªãƒ•ã‚£ãƒƒã‚¯ã‚¹`can_~`ã§å§‹ã¾ã‚Šã€`bool`å€¤ã‚’è¿”ã™`constexpr`é–¢æ•°ã§ã™ã€‚

```cpp
#include <limits>

int add(std::integral auto lhs, std::integral auto rhs) {
  // 2ã¤ã®æ•´æ•°å€¤ã®è¶³ã—ç®—
  assert(std::can_add(lhs, rhs));
  assert(std::can_convert<int>(lhs + rhs));

  return lhs + rhs;
}
```

ä»–ã«ã‚‚ã€ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆç­‰ã®å˜é …æ¼”ç®—å­ã€å››å‰‡æ¼”ç®—ã¨`%`ãªã©ã®2é …æ¼”ç®—å­ã€`+= *=`ãªã©ã®è¤‡åˆä»£å…¥æ¼”ç®—å­ï¼ˆ`_in_place`ãŒå¾Œã‚ã«ã¤ãï¼‰ã«ãã‚Œãã‚Œå¯¾å¿œã—ãŸé–¢æ•°ãŒç”¨æ„ã•ã‚Œã€å…¨ã¦ã®é–¢æ•°ã«`_modular`ãŒå¾Œã‚ã«ã¤ããƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ`2^N`ã‚’æ³•ã¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ­æ¼”ç®—ã«ã‚ˆã‚‹ã‚‚ã®ï¼‰ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã®é–¢æ•°ç¾¤ã¯æ¬¡ã®æ¡ä»¶ã‚’å…¨ã¦ãƒ‘ã‚¹ã™ã‚‹å ´åˆã«`true`ã‚’è¿”ã—ã€ãã†ã§ãªã‘ã‚Œã°`false`ã‚’è¿”ã—ã¾ã™ã€‚

1. å„é–¢æ•°ã«æŒ‡å®šã•ã‚ŒãŸå¼ãŒè©•ä¾¡ã•ã‚Œã‚‹ã¨ã€ãã®å®Ÿè¡Œã¯well-formed
2. å„ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã«ã¤ã„ã¦ã€æ•´æ•°æ˜‡æ ¼ã¨å¤‰æ›ãŒé©ç”¨ã•ã‚Œã‚‹å‰å¾Œã®å€¤ã¯`2^N`ã‚’æ³•ã¨ã—ã¦åˆåŒã€‚ã¾ãŸã€æ¯”è¼ƒæ¼”ç®—ã¨`/ /= % %= >> >>=`ã®ä¸¡ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã€`<< <<=`ã®å³ã‚ªãƒšãƒ©ãƒ³ãƒ‰ã«ã¤ã„ã¦ã€æ•´æ•°æ˜‡æ ¼ã¨å¤‰æ›ã®é©ç”¨å‰å¾Œã®å€¤ã¯ç­‰ã—ããªã‚‹ã€‚
3. å¼ã®çµæœã¨æ•°å­¦æ¼”ç®—ã®çµæœã¯`2^N`ã‚’æ³•ã¨ã—ã¦åˆåŒã€‚ã¾ãŸã€ãƒã‚¹ãƒˆãƒ•ã‚£ãƒƒã‚¯ã‚¹ã«`_modular`ãŒä»˜ã‹ãªã„é–¢æ•°ã§ã¯ã€å¼ã®çµæœã¨æ•°å­¦æ¼”ç®—ã®çµæœã¯ç­‰ã—ããªã‚‹ã€‚

ã“ã®ææ¡ˆã«ã‚ˆã‚‹é–¢æ•°ç¾¤ã¯ã€C++26ä»¥é™ã§å°å…¥ã•ã‚Œã‚‹Contractã«ãŠã„ã¦ã‚‚æœ‰ç”¨ã§ã‚ã‚‹ã¨æ€ã‚ã‚Œã¾ã™ã€‚

- [P1619 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/393)

### [P2164R8 views::enumerate](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2164r8.pdf)
### [P2167R3 Improved Proposed Wording for LWG 2114 (contextually convertible to bool)](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2167r3.html)
### [P2248R7 Enabling list-initialization for algorithms](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2248r7.html)
### [P2396R1 Concurrency TS 2 fixes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2396r1.pdf)
### [P2434R0 Nondeterministic pointer provenance](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2434r0.html)
### [P2539R4 Should the output of std::print to a terminal be synchronized with the underlying stream?](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2539r4.html)
### [P2546R3 Debugging Support](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2546r3.html)
### [P2548R2 copyable_function](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2548r2.pdf)
### [P2548R3 copyable_function](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2548r3.pdf)
### [P2548R4 copyable_function](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2548r4.pdf)
### [P2552R1 On the ignorability of standard attributes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2552r1.pdf)
### [P2559R1 Plan for Concurrency Technical Specification Version 2](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2559r1.html)
### [P2564R1 consteval needs to propagate up](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2564r1.html)
### [P2564R2 consteval needs to propagate up](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2564r2.html)
### [P2564R3 consteval needs to propagate up](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2564r3.html)
### [P2570R1 Contract predicates that are not predicates](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2570r1.html)
### [P2588R2 Relax std::barrier phase completion step guarantees](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2588r2.html)
### [P2589R1 static operator[]](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2589r1.pdf)
### [P2602R2 Poison Pills are Too Toxic](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2602r2.html)
### [P2614R2 Deprecate numeric_limits::has_denorm](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2614r2.pdf)
### [P2615R1 Meaningful exports](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2615r1.html)
### [P2616R1 Making std::atomic notification/wait operations usable in more situations](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2616r1.html)
### [P2616R2 Making std::atomic notification/wait operations usable in more situations](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2616r2.html)
### [P2640R2 Modules: Inner-scope Namespace Entities: Exported or Not?](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2640r2.pdf)
### [P2644R1 Final Fix of Broken Range based for Loop Rev 1](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2644r1.pdf)
### [P2647R1 Permitting static constexpr variables in constexpr functions](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2647r1.html)
### [P2649R0 2022-10 Library Evolution Poll Outcomes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2649r0.html)
### [P2650R0 2022-11 Library Evolution Polls](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2650r0.html)
### [P2652R1 Disallow user specialization of allocator_traits](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2652r1.html)
### [P2653R1 Update Annex E based on Unicode 15.0 UAX 31 Steve Downey](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2653r1.pdf)
### [P2655R1 common_reference_t of reference_wrapper Should Be a Reference Type](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2655r1.html)
### [P2657R1 C++ is the next C++](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2657r1.html)
### [P2658R1 temporary storage class specifiers](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2658r1.html)
### [P2659R1 A Proposal to Publish a Technical Specification for Contracts](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2659r1.pdf)
### [P2664R0 Proposal to extend std::simd with permutation API](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2664r0.pdf)
### [P2674R1 A trait for implicit lifetime types](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2674r1.pdf)
### [P2679R1 Fixing std::start_lifetime_as and std::start_lifetime_as_array](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2679r1.pdf)
### [P2681R0 More Stats Functions](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2681r0.pdf)
### [P2693R0 Formatting thread::id and stacktrace](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2693r0.pdf)
### [P2695R0 A proposed plan for contracts in C++](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2695r0.pdf)
### [P2696R0 Introduce Cpp17Swappable as additional convenience requirements](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2696r0.html)
### [P2697R0 Interfacing bitset with string_view](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2697r0.pdf)
### [P2698R0 Unconditional termination is a serious problem](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2698r0.pdf)
### [P2700R0 Questions on P2680 â€œContracts for C++: Prioritizing Safetyâ€](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2700r0.pdf)
### [P2701R0 Translating Linker Input Files to Module Metadata Files](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2701r0.pdf)
### [P2702R0 Specifying Importable Headers](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2702r0.pdf)
### [P2703R0 C++ Standard Library Ready Issues to be moved in Kona, Nov. 2022](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2703r0.html)
### [P2704R0 C++ Standard Library Immediate Issues to be moved in Kona, Nov. 2022](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2704r0.html)
### [P2705R0 C++ Library Fundamentals TS Issues to be moved in Kona, Nov. 2022](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2705r0.html)
### [P2706R0 Drafting for US 26-061: Redundant specification for defaulted functions](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2706r0.html)
### [P2708R0 No Future Fundamentals TSes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2708r0.html)
### [P2708R1 No Future Fundamentals TSes](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2708r1.html)
### [P2709R0 Core Language Working Group â€œreadyâ€ Issues for the November, 2022 meeting](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2709r0.html)
### [P2710R0 Core Language Working Group NB comment resolutions for the November, 2022 meeting](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2710r0.html)
### [P2711R0 Making multi-param (and other converting) constructors of views explicit](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2711r0.html)
### [P2711R1 Making multi-param constructors of views explicit](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2711r1.html)
### [P2712R0 Classification of Contract-Checking Predicates](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2712r0.pdf)
### [P2718R0 Wording for P2644R1 Fix for Range-based for Loop](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2718r0.html)
### [P2722R0 Slides: Beyond operator() (P2511R2 presentation)](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2722r0.pdf)
### [P2723R0 Zero-initialize objects of automatic storage duration](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2723r0.html)
### [P2725R0 std::integral_constant Literals](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2725r0.html)
### [P2726R0 Better std::tuple Indexing](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2726r0.html)
### [P2727R0 std::iterator_interface](https://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2727r0.html)