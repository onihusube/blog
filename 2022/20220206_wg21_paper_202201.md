# ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2022å¹´01æœˆï¼‰

æ–‡æ›¸ã®ä¸€è¦§

- [JTC1/SC22/WG21 - Papers 2022 mailing2022-01](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/#mailing2022-01)

å…¨éƒ¨ã§52æœ¬ã‚ã‚Šã¾ã™ï¼ˆSG22ã®WG14ã‹ã‚‰ã®ã‚‚ã®ã¯é™¤ãã¾ã™ï¼‰ã€‚

[:contents]

### [P0447R18 Introduction of std::hive to the standard library](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0447r18.html)
### [P0792R6 function_ref: a non-owning reference to a Callable](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p0792r6.html)

*Callable*ã‚’æ‰€æœ‰ã—ãªã„`std::function`ã§ã‚ã‚‹`std::function_ref`ã®ææ¡ˆã€‚

C++ã«ãŠã„ã¦é«˜éšé–¢æ•°ï¼ˆé–¢æ•°ã‚’å—ã‘å–ã‚‹/è¿”ã™é–¢æ•°ï¼‰ã‚’æ›¸ãã¨ãã«ã€æ—¢å­˜ã®é–¢æ•°ï¼ˆ*Callable*ï¼‰ã‚’å‚ç…§ã—ãŸã„ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ç¾åœ¨ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯ãã®ãŸã‚ã«ä½¿ç”¨ã§ãã‚‹åŠ¹æœçš„ãªã‚‚ã®ãŒã‚ã‚Šã¾ã›ã‚“ã€‚æ—¢å­˜ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«ã¯ä»¥ä¸‹ã®3ã¤ãŒã‚ã‚Šã¾ã™

- é–¢æ•°ãƒã‚¤ãƒ³ã‚¿
    - å‚ç…§ã™ã‚‹ã‚‚ã®ãŒã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ã§ã‚ã‚‹å ´åˆã«ã®ã¿ä½¿ç”¨å¯èƒ½ã€‚ã¾ãŸã€ãƒ¡ãƒ³ãƒé–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã‚„ãƒ¡ãƒ³ãƒå¤‰æ•°ãƒã‚¤ãƒ³ã‚¿ã‚’å‡¦ç†ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
- `std::function`
    - æ ¼ç´ã™ã‚‹*Callable*ã‚’æ‰€æœ‰ã™ã‚‹ãŸã‚ã€æ„å›³ã—ãªã„ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒç™ºç”Ÿã—ã†ã‚‹
    - æ‰€æœ‰æ¨©ãŒå¿…è¦ãªã„å ´åˆã«ã¯ä¸é©æ ¼
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
    - ç‰¹å®šã®ã‚·ã‚°ãƒãƒãƒ£ã«åˆ¶ç´„ã™ã‚‹ã®ãŒé›£ã—ãã€ãƒ˜ãƒƒãƒ€ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã‹ãªã‘ã‚Œã°ãªã‚‰ãªã„

ç‰¹å®šã®*Callablel*ã‚’å˜ã«å‚ç…§ã—ãŸã„ã ã‘ã®å ´åˆã«æœ€é©ãªã‚‚ã®ãŒç¾åœ¨ã®C++ã«ã¯æ¬ ã‘ã¦ãŠã‚Šã€`std::function_ref`ã¯ãã®ã‚®ãƒ£ãƒƒãƒ—ã‚’åŸ‹ã‚ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã™ã€‚`std::function_ref`ã¯ãã®åå‰ã®é€šã‚Šå—ã‘å–ã£ãŸ*Callable*ã‚’æ‰€æœ‰ã›ãšå‚ç…§ã—ã€ãªãŠã‹ã¤`std::function`ã¨ã»ã¼åŒç­‰ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨å‹æ¶ˆå»ã‚’æä¾›ã—ã¾ã™ã€‚

`std::function_ref`ã¯ç‰¹ã«ã€é–¢æ•°ã®å¼•æ•°ã§ä»»æ„ã®*Callablel*ã‚’å—ã‘å–ã‚ŠãŸã„å ´åˆã«æœ‰ç”¨ã§ã™ã€‚ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ãªé–¢æ•°ã‚’æ›¸ãã¨ã

```cpp
struct payload { /* ... */ };

// timeså›ã¾ã§actionã‚’ç¹°ã‚Šè¿”ã™
// actionãŒæœ‰åŠ¹ãªpayloadã‚’è¿”ã—ãŸã¨ãã¯ãã“ã§çµ‚äº†
// ãã‚Œä»¥å¤–ã®å ´åˆã¯nulloptã‚’è¿”ã™
std::optional<payload> retry(std::size_t times, /* ????? */ action);
```

ã“ã®`/* ????? */`ã®éƒ¨åˆ†ã«ã¯å‰è¿°ã®ã„ãã¤ã‹ã®æ›¸ãæ–¹ãŒã‚ã‚Šã¾ã™

```cpp
// é–¢æ•°ãƒã‚¤ãƒ³ã‚¿
// åˆ©ç‚¹ : å®Ÿè£…ãŒç°¡å˜ã§è¿½åŠ ã®åˆ¶ç´„ãŒå¿…è¦ãªãã€ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã‚‚æœ€å°ï¼ˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯å‘¼ã³å‡ºã—ã‚’ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–ã§ãã‚‹ã¯ãšï¼‰
// æ¬ ç‚¹ : ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãªCallableã‚’æ‰±ãˆãªã„
std::optional<payload> retry(std::size_t times,
                             std::optional<payload>(*action)())
{
    /* ... */
}

// std::function
// åˆ©ç‚¹ : ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ã‚‚å«ã‚ã¦ã€æŒ‡å®šã—ãŸã‚·ã‚°ãƒãƒãƒ£ã«åˆã†ä»»æ„ã®Callableã‚’å—ã‘å–ã‚Œã‚‹
// æ¬ ç‚¹ : æ‰€æœ‰æ¨©ãŒä¸æ˜ç­ï¼ˆreference_wrapperã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰ã€å¤§ããªã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã‚’ç™ºç”Ÿã•ã›ã†ã‚‹ï¼ˆå‹•çš„å‰²ã‚Šå½“ã¦ã€åˆ†å²ã€ä¾‹å¤–ã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³åŒ–å›°é›£ï¼‰
std::optional<payload> retry(std::size_t times,
                             std::function<std::optional<payload>()> action)
{
    /* ... */
}

// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
// åˆ©ç‚¹ : ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ã‚‚å«ã‚ã¦ä»»æ„ã®Callableã‚’å—ã‘å–ã‚Œã‚‹ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒãªã„
// æ¬ ç‚¹ : å®Ÿè£…ã—ã¥ã‚‰ãèª­ã¿ã¥ã‚‰ã„ï¼ˆenable_ifã‚„is_invocableã«ã‚ˆã‚‹åˆ¶ç´„å‘¨ã‚Šï¼‰ã€ãƒ˜ãƒƒãƒ€ã«æ›¸ã‹ã–ã‚‹ã‚’å¾—ãªã„
template <typename F>
auto retry(std::size_t times, F&& action)
    -> std::enable_if_t<std::is_invocable_r_v<std::optional<payload>, F&&>,
                        std::optional<payload>>
{
    /* ... */
}
```

`std::function_ref`ã¯ã“ã‚Œã‚‰ã®ã„ã„ã¨ã“å–ã‚Šã‚’ã™ã‚‹ã‚‚ã®ã§ã€æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã¾ã™

```cpp
// function_ref
template <typename F>
auto retry(std::size_t times, std::function_ref<std::optional<payload>()> action)
{
    /* ... */
}
```

ä½¿ç”¨æ„Ÿã¯`std::fucntion`ã¨åŒæ§˜ã§ã€`std::fucntion`ã®ãƒ¡ãƒªãƒƒãƒˆã‚’ãã®ã¾ã¾äº«å—ã§ãã€æ‰€æœ‰æ¨©ã¯æ˜ç¢ºï¼ˆæ‰€æœ‰ã—ã¦ã„ãªã„ï¼‰ã§ã™ã€‚ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã«é–¢ã—ã¦ã¯é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã¨ã»ã¼åŒç­‰ã§ã‚ã‚Šã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å±•é–‹ã‚’æœŸå¾…ã§ãã¾ã™ã€‚ã¾ãŸã€`std::function_ref`ã¯ç©ºã®çŠ¶æ…‹ãŒãªã„ãŸã‚å‘¼ã³å‡ºã—æ™‚ã®nullãƒã‚§ãƒƒã‚¯ãŒä¸è¦ã§ã€`target_type`ãªã©ã®RTTIãŒå¿…è¦ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚‚æŒã¡ã¾ã›ã‚“ã€‚

ä»–ã«ã‚‚ã€`std::function_ref`ã¯`std::move_only_function`ã¨åŒæ§˜ã«`const, noexcept`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```cpp
struct A {
  int operator()() const noexcept { return 1; }
  int operator()() { return 2;}
} obj;

function_ref<int() const noexcept> fr = obj;
fr();  // 1
```

ã“ã®ææ¡ˆã¯ã€C++23ã‚’ç›®æŒ‡ã—ã¦LWGã§ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸­ã§ã™ã€‚

- [P0792 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/866)

### [P1018R14 C++ Language Evolution status ğŸ¦  pandemic edition ğŸ¦  2021/09â€“2022/01](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1018r14.html)

2021å¹´9æœˆã‹ã‚‰2022å¹´1æœˆã®é–“ã®EWGã®æ´»å‹•ã«ã¤ã„ã¦ã®ãƒ¬ãƒãƒ¼ãƒˆã€‚

2022å¹´1æœˆæœ«ã¾ã§ã«EWGã®é›»å­æŠ•ç¥¨ã«ã‹ã‘ã‚‰ã‚Œã‚‹ææ¡ˆã¯ä»¥ä¸‹ã®ã‚‚ã®ã§ã™

- [P2280R3 Using unknown references in constant expressions](https://wg21.link/P2280R3)
- [P2468R1 The Equality Operator You Are Looking For](https://wg21.link/P2468R1)
- [P2327R1 De-deprecating volatile compound operations](https://wg21.link/P2327R1)
- [P2266R2 Simpler implicit move](https://wg21.link/P2266R2)
- [P1467R8 Extended floating-point types and standard names](https://wg21.link/P1467R8)
- [P2350R2 constexpr class](https://wg21.link/P2350R2)
- [P1169R3 static operator()](https://wg21.link/P1169R3)
- [P1774R5 Portable assumptions](https://wg21.link/P1774R5)
- [P1494R2 Partial program correctness](https://wg21.link/P1494R2)
- [P2448R0 Relaxing some constexpr restrictions](https://wg21.link/P2448R0)
- [P2437R0 Support for #warning](https://wg21.link/P2437R0)
- [P2324R1 Labels at the end of compound statements (C compatibility)](https://wg21.link/P2324R1)
- [P2071R1 Named universal character escapes](https://wg21.link/P2071R1)
- [P2295R5 Support for UTF-8 as a portable source file encoding](https://wg21.link/P2295R5)
- [P2290R2 Delimited escape sequences](https://wg21.link/P2290R2)
- [P2362R3 Remove non-encodable wide character literals and multicharacter wide character literals](https://wg21.link/P2362R3)
- [P2348R2 Whitespaces Wording Revamp](https://wg21.link/P2348R2)

ã“ã‚Œã‚‰ã®ææ¡ˆã¯å…¨ã¦ã€C++23ã«å°å…¥ã™ã‚‹ã¹ãEWGã‹ã‚‰CWGã¸è»¢é€ã™ã‚‹ãŸã‚ã®æœ€çµ‚ç¢ºèªã®æŠ•ç¥¨ã«ã‹ã‘ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ç‰¹ã«ã€æœ€åˆã®3ã¤ã¨P2448R0ã¯DRã§ã™ã€‚

C++23ã«å‘ã‘ãŸEWGã®æ´»å‹•ã¨ã—ã¦ã¯ã‚ã¨ã¯ã‚³ã‚¢è¨€èªIssueã®è§£æ±ºã®ã¿ã§ã€ãŠãã‚‰ãã“ã‚Œä»¥ä¸Šã‚³ã‚¢è¨€èªã«å¯¾ã™ã‚‹æ©Ÿèƒ½è¿½åŠ ãŒC++23ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã‚‹ã“ã¨ã¯ãªã•ãã†ã§ã™ã€‚

### [P1083R4 Move `resource_adaptor` from Library TS to the C++ WP](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1083r4.pdf)

`pmr::resource_adaptor`ã‚’Library Foundermental TSã‹ã‚‰ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆã¸ç§»å‹•ã™ã‚‹ææ¡ˆã€‚

`pmr::resource_adaptor`ã¯ä»»æ„ã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’`memory_resource`ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã‚¢ãƒ€ãƒ—ãƒˆã•ã›ã‚‹ã‚‚ã®ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€`std::pmr::polymorphic_allocator`ã§ä»»æ„ã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’ã‚ˆã‚Šç°¡æ˜“ã«åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```cpp
template<typename Alloc>
class resource_adaptor_impl : std::memory_resource {
  // ...
};

template<typename Alloc>
using resource_adaptor = resource_adaptor_impl<typename std::allocator_traits<Allocator>::template rebind_alloc<char>>;
```

ã“ã®`resource_adaptor_impl`ã®ã‚ˆã†ãªã‚‚ã®ã¯èª¬æ˜å°‚ç”¨ã®ã‚¯ãƒ©ã‚¹ã¨ã—ã¦æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å®Ÿéš›ã«ã¯ã“ã®åå‰ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã‚Œã¯ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã—ã¾ã™

```cpp
// ã‚ªãƒ¬ã‚ªãƒ¬ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿
class my_allocator;

int main() {
  std::pmr::resource_adaptor<my_allocator> mr{};

  std::pmr::polymorphic_allocator<> pmralloc{&mr};
}
```

`pmr::resource_adaptor`ãŒãªã„å ´åˆã€`my_allocator`ã‚’ãƒ©ãƒƒãƒ—ã—ã¦`memory_resource`ã«ã‚¢ãƒ€ãƒ—ãƒˆã™ã‚‹ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ã‚’æ‰‹æ›¸ãã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚

`polymorphic_allocator`ã¯ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ä¾¿åˆ©ã§ã‚ã‚‹ãŸã‚ã€ä»Šå¾Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’å–ã‚‹ä»£ã‚ã‚Šã«åˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ãŒå¢—ãˆã¦ã„ãã¨æ€ã‚ã‚Œã¾ã™ã€‚ãã“ã«ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’æ¸¡ã™ã«ã¯ã€ãã‚ŒãŒã™ã§ã«`polymorphic_allocator`ãã®ã‚‚ã®ã§ã‚ã‚‹ã‹`memory_resource`ã«ã‚¢ãƒ€ãƒ—ãƒˆã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`resource_adaptor`ã¯å¾Œè€…ã®ã‚±ãƒ¼ã‚¹ã®ãƒ˜ãƒ«ãƒ‘ã¨ãªã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã‚ã‚Šã€ã“ã‚ŒãŒã‚ã‚‹ã“ã¨ã§`polymorphic_allocator`ã®åˆ©ç”¨ãŒã‚ˆã‚Šä¿ƒé€²ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€`resource_adaptor`ã¯é•·æœŸé–“Library Foundermental TSã«å­˜åœ¨ã—ã¦ãŠã‚Šã€ãã®å®Ÿè£…ã¯å®‰å®šã—ã¦ã„ã‚‹ãŸã‚ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆã¸ã®å°å…¥ã®æ•·å±…ã‚‚ä½ã„ã¨æ€ã‚ã‚Œã‚‹ã¾ã™ã€‚ã“ã®ææ¡ˆã¯ã“ã‚Œã‚‰ã®ç†ç”±ã‹ã‚‰`resource_adaptor`ã®æ¨™æº–å…¥ã‚Šã‚’ç›®æŒ‡ã™ã‚‚ã®ã§ã™ã€‚

ãŸã ã—ã€ã“ã®ææ¡ˆã§ã¯ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šå‘¨ã‚Šã®è¨­è¨ˆãŒå°‘ã—å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚`memory_resource`ã®`.do_allocate()`ï¼ˆãŠã‚ˆã³`.do_deallocate()`ï¼‰ã§ã¯ç¬¬äºŒå¼•æ•°ã«ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šã‚’å—ã‘å–ã‚Šã¾ã™ã€‚`resource_adaptor`ãŒãƒ©ãƒƒãƒ—ã—ã¦ã„ã‚‹ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã«æ­£ã—ãã“ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šã‚’ä¼é”ã™ã‚‹ã«ã¯ã€ãã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šã«æ²¿ã£ãŸã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’æŒã¤åˆ¥ã®å‹`U`ã§å…ƒã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’`rebind`ã™ã‚‹ã“ã¨ã§ã™ãŒã€`.do_allocate()`ã«ã¯ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šãŒå®Ÿè¡Œæ™‚ã«æ¸¡ã£ã¦ãã¾ã™ã€‚ãã®ãŸã‚ã€`resource_adaptor::do_allocate()`ã§ã¯ã€å¯èƒ½ãªã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆæŒ‡å®šæ¯ã«ãã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’æŒã¤å‹ã‚’æ±‚ã‚ã¦ãã‚Œã«ã‚ˆã£ã¦å…ƒã®ã‚¢ãƒ­ã‚±ãƒ¼ã‚¿ã‚’`rebind`ã—ã¦ã‹ã‚‰`allocate()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

```cpp
template<typename Alloc>
class resource_adaptor_impl : std::memory_resource {
  Alloc m_alloc;

  // ...

  void* do_allocate(std::size_t bytes, std::size_t alignment) override {
    // alignmentã¯2ã®ã¹ãä¹—ã®å€¤ã ã‘ã‚’è€ƒæ…®ã™ã‚‹
    // alignmentã®å€¤æ¯ã«é©åˆ‡ãªå‹Uã§rebindã™ã‚‹
    switch(alignment) {
      case 4 :
        {
          using U = int32_t;
          const std::size_t n = (bytes + sizeof(U) - 1) / sizeof(U);
          return allocator_traits<Alloc>::template rebind_traits<int32_t>::allocate(m_alloc, n);
        }
      case 8 :
        {
          using U = int64_t;
          const std::size_t n = (bytes + sizeof(U) - 1) / sizeof(U);
          return allocator_traits<Alloc>::template rebind_traits<int32_t>::allocate(m_alloc, n);
        }
      case 16 :
        ...
      case 32 :
        ...
      case 64 :
      ...
      default : assert(false);
    };

  }
};
```

ãŠãŠã‚ˆãã“ã®ã‚ˆã†ãªå®Ÿè£…ãŒè¡Œã‚ã‚Œã‚‹ã‚‰ã—ã„ã§ã™ãŒã€ã“ã®å®Ÿè£…ã¯æ˜ã‚‰ã‹ã«ä½™è¨ˆãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å®Ÿä½“åŒ–ã‚’ä¼´ã†ãŸã‚ã€ã‚³ãƒ¼ãƒ‰ã®è‚¥å¤§åŒ–ã‚„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚é–“ã®å¢—å¤§ã¨ã„ã£ãŸå•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œã¯ã©ã†ã—ã‚ˆã†ã‚‚ãªã„ã§ã™ãŒã€ã›ã‚ã¦è€ƒæ…®ã™ã¹ãæ•°ã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã“ã®ææ¡ˆã®`resource_adaptor`ã¯ç¬¬äºŒãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå¼•æ•°ã«ã“ã®ã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã®æœ€å¤§å€¤ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ä¿®æ­£ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®æœ€å¤§å€¤ã«ã‚ˆã£ã¦ä¸Šè¨˜ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ç”Ÿæˆã®ä¸Šé™ã‚’æŒ‡å®šã—ã¾ã™ã€‚

ã¾ãŸã€ä¸Šè¨˜ä¾‹ã§ã¯`U`ã«`int32_t`ãªã©ã‚’ä½¿ç”¨ã—ã¾ã—ãŸãŒã“ã‚Œã‚‚é©åˆ‡ã§ã¯ãªãã€ã“ã®æŒ‡å®šã—ãŸã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆã‚’æŒã¤`U`ã‚’æ±‚ã‚ã‚‹ãŸã‚ã®`aligned_raw_storage<Align, Size>`ï¼ˆã‚ªãƒ¼ãƒãƒ¼ã‚¢ãƒ©ã‚¤ãƒ³ã•ã‚Œã‚‹å ´åˆã®`U`ã‚’æ±‚ã‚ã‚‹ï¼‰ã€`aligned_type<Align>`ï¼ˆã‚ªãƒ¼ãƒãƒ¼ã‚¢ãƒ©ã‚¤ãƒ³ã•ã‚Œãªã„å ´åˆã«`U`ã¨ã—ã¦é©åˆ‡ãªã‚¹ã‚«ãƒ©å‹ã‚’æŒ‡å®šã™ã‚‹ï¼‰ã€`aligned_object_storage<T>`ï¼ˆ`T`ã«ã¤ã„ã¦`aligned_raw_storage<sizeof(T), sizeof(T)>`ã‚’æ±‚ã‚ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¨ã—ã¦åˆ©ç”¨ã—ã‚„ã™ãã™ã‚‹ãƒ˜ãƒ«ãƒ‘å‹ï¼‰ã¨ã„ã£ãŸå‹ç‰¹æ€§ã‚¯ãƒ©ã‚¹ã‚‚åŒæ™‚ã«ææ¡ˆã•ã‚Œã¦ã„ã¾ã™

- [`std::experimental::pmr::resource_adaptor` - cppreference](https://en.cppreference.com/w/cpp/experimental/resource_adaptor)
- [P1083 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/33)

### [P1206R7 Conversions from ranges to containers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1206r7.pdf)
### [P1240R2 Scalable Reflection](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1240r2.pdf)

å€¤ãƒ™ãƒ¼ã‚¹ã®é™çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®ææ¡ˆã€‚

ç¾åœ¨ã®Reflection TSï¼ˆN4766ï¼‰ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã¨ã®è¦ªå’Œæ€§ã‚’æ„è­˜ã—ã¦å‹ãƒ™ãƒ¼ã‚¹ã®ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚ãã“ã§ã¯ã€`reflexpr()`ã¨ã„ã†æ§‹æ–‡ã«ã‚ˆã£ã¦ä»»æ„ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‹ã‚‰ãƒ¡ã‚¿æƒ…å ±ã‚’å‹ã¨ã—ã¦æŠ½å‡ºã—ã€å„ç¨®traitså‹ã«ã‚ˆã£ã¦ãã‚Œã‚’å‡¦ç†ã—ã¾ã™ã€‚

```cpp
#include <reflect>

// å‹åã‚’å–å¾—ã™ã‚‹
template <typename T>
std::string get_type_name() {
  namespace reflect = std::experimental::reflect;
  
  // Tï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ã®ãƒ¡ã‚¿æƒ…å ±ã‚’å–å¾—
  using T_t = reflexpr(T);

  // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰å…ƒã®å‹ã®ãƒ¡ã‚¿æƒ…å ±ã‚’å¾—ã‚‹
  using aliased_T_t = reflect::get_aliased_t<T_t>;

  // Tã®å…ƒã®å‹åã‚’stringã§å–å¾—
  return reflect::get_name_v<aliased_T_t>;
}
```

ã“ã®ã‚ˆã†ãªå‹ãƒ™ãƒ¼ã‚¹ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯TMPã®æ–‡è„ˆã§ã¯æ‰±ã„ã‚„ã™ã„ã‚‚ã®ã§ã™ãŒ`constexpr`ã®æ–‡è„ˆã«ãŠã„ã¦ã¯æ‰±ã„ã¥ã‚‰ãã€é™çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§å¾—ãŸãƒ¡ã‚¿æƒ…å ±ã‹ã‚‰ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã‚’ã™ã‚‹å‡¦ç†ãªã©ãŒæ›¸ãã¥ã‚‰ããªã‚Šã¾ã™ã€‚ãã“ã§ã€`constexpr`ã¨è¦ªå’Œæ€§ã®é«˜ã„å€¤ãƒ™ãƒ¼ã‚¹ã®ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒææ¡ˆã•ã‚Œï¼ˆP0425R0ï¼‰ã€SG7(Reflection Study Group)ã§ã¯ãã®æ–¹å‘æ€§ã§ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ¤œè¨ã—ã¦ã„ãã“ã¨ã«ã—ãŸã‚ˆã†ã§ã™ã€‚

ã“ã®ææ¡ˆã¯ãã®å¾Œã®è­°è«–ã‚„ææ¡ˆã®ä½œæ¥­ã‚’åæ˜ ã—ãŸã€å€¤ãƒ™ãƒ¼ã‚¹ã®é™çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ææ¡ˆã™ã‚‹ã‚‚ã®ã§ã™ã€‚

å…ˆã»ã©ã®å‹åå–å¾—ã‚³ãƒ¼ãƒ‰ã¯ã€ã“ã®ææ¡ˆã§ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```cpp
#include <meta>

template<typename T>
std::string get_type_name() {

  // Tã®ãƒ¡ã‚¿æƒ…å ±ã‚’å–å¾—
  constexpr std::meta::info reflected = ^T;

  // Tã®å‹åã‚’string_viewã§å–å¾—
  std::string_view name = std::meta::name_of(reflected);

  return std::string(name);
}
```

`reflexpr`ã¯`^`ã«ãªã‚Šã€ãã®çµæœã¯å‹ã§ã¯ãªãå€¤ã¨ãªã‚Šã¾ã™ã€‚ãã®å¾Œã§ã‚‚ã€`get_name_v<T>`ã®ã‚ˆã†ãªå‹ç‰¹æ€§ã‚¯ãƒ©ã‚¹ã§ã¯ãªã`name_of()`ã®ã‚ˆã†ãªé–¢æ•°ã«ã‚ˆã£ã¦ãƒ¡ã‚¿æƒ…å ±ã‚’å‡¦ç†ã—ã¦ã„ãã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹`reflexpr(T)`ã§ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãã®ã‚‚ã®ã®ãƒ¡ã‚¿æƒ…å ±ãŒã¾ãšå¾—ã‚‰ã‚Œã¦ã„ã¾ã—ãŸãŒã€`^T`ã§ã¯ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–å¾Œã€å…·ä½“çš„ãªå‹ã§ç½®ãæ›ãˆã‚‰ã‚ŒãŸ`T`ã«ã¤ã„ã¦ã®ãƒ¡ã‚¿æƒ…å ±ï¼ˆã™ãªã‚ã¡ä¸ãˆã‚‰ã‚ŒãŸå‹ã®ç›´æ¥ã®ãƒ¡ã‚¿æƒ…å ±ï¼‰ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚ã‚€ã—ã‚ã€ã“ã®ææ¡ˆã§ã¯ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãã®ã‚‚ã®ã®ãƒ¡ã‚¿æƒ…å ±ã‚’å¾—ã‚‹æ‰‹æ®µã‚’æä¾›ã—ã¦ã„ã¾ã›ã‚“ã€‚

åˆ¥ã®ã‚µãƒ³ãƒ—ãƒ«

```cpp
// åˆ—æŒ™å€¤åã‚’æ–‡å­—åˆ—åŒ–ã™ã‚‹
template<Enum T>
std::string to_string(T value) {
  // Tã®åˆ—æŒ™å€¤ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å–å¾—
  template for (constexpr auto e : std::meta::members_of(^T)) {
    // valueã«ä¸€è‡´ã™ã‚‹åˆ—æŒ™å€¤åã‚’è¿”ã™
    if ([:e:] == value) {
      return std::string(std::meta::name_of(e));
    }
  }

  return "<unnamed>";
}
```

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®3ã¤ã®ã“ã¨ã‚’è¡Œãªã£ã¦ã„ã¾ã™

1. åˆ—æŒ™å‹ã‹ã‚‰åˆ—æŒ™å€¤ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å–å¾—ã™ã‚‹
2. åˆ—æŒ™å€¤ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‹ã‚‰ã€`value`ã¨ä¸€è‡´ã™ã‚‹ã‚‚ã®ã‚’æ¢ã™
3. ä¸€è‡´ã—ãŸåˆ—æŒ™å€¤ã®åå‰ã‚’è¿”ã™

1ã¯ã€`^T`ã«ã‚ˆã£ã¦å–å¾—ã—ãŸ`T`ã®ãƒ¡ã‚¿æƒ…å ±ã‹ã‚‰`members_of()`ã«ã‚ˆã£ã¦åˆ—æŒ™å‹`T`ã®ãƒ¡ãƒ³ãƒï¼ˆã™ãªã‚ã¡åˆ—æŒ™å€¤ï¼‰ã®ãƒ¡ã‚¿æƒ…å ±ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å–å¾—ã—ã¾ã™ã€‚`T`ã®åˆ—æŒ™å€¤ãã‚Œãã‚Œã«å¯¾ã—ã¦`^`ã—ãŸçµæœã®å‹ã‚’`info`ã¨ã™ã‚‹ã¨ï¼ˆã“ã‚Œã¯å®Ÿéš›ã«`std::meta::info`ã¨ã„ã†å‹ã§ã™ï¼‰ã€`members_of()`ã®æˆ»ã‚Šå€¤å‹ã¯`std::span<info, N>`ã¨ãªã‚Šã¾ã™ã€‚

2ã¯`template for`æ§‹æ–‡ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã¯*expansion-statement*ã¨ã„ã†æ§‹æ–‡ã§ã™ã€‚`members_of()`ã®æˆ»ã‚Šå€¤ã®`span`ã®å„è¦ç´ ã«å¯¾ã—ã¦ãã®æœ¬ä½“ãŒç¹°ã‚Šè¿”ã—é©ç”¨ã•ã‚Œã¾ã™ãŒã€ã“ã‚Œã¯å®Ÿè¡Œæ™‚ãƒ«ãƒ¼ãƒ—ã§ã¯ãªãã€`I = 0...N-1`æ¯ã«æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã®ç¹°ã‚Šè¿”ã—ã¨ã—ã¦å±•é–‹ã•ã‚Œã¾ã™ã€‚

```cpp
{
  constexpr std::meta::info e = s[I];
  if ([:e:] == value)
    return std::meta::name_of(e);
}
```

*expansion-statement*å†…ã§ã¯ã€`[:e:]`ã®æ§‹æ–‡ã«ã‚ˆã£ã¦`T`ã®åˆ—æŒ™å€¤ã®ãƒ¡ã‚¿æƒ…å ±`e`ã‹ã‚‰ãã®å€¤ã‚’å¾©å…ƒã—ã¾ã™ã€‚ã“ã®å‡¦ç†ã¯ã‚¹ãƒ—ãƒ©ã‚¤ã‚·ãƒ³ã‚°ã¨å‘¼ã°ã‚Œã€ã“ã‚Œã«ã‚ˆã£ã¦å®Ÿè¡Œæ™‚ã®å€¤`value`ã¨ã®æ¯”è¼ƒãŒå¯èƒ½ã¨ãªã‚Šã€æœ€åˆã«ãƒãƒƒãƒã—ãŸ`e`ã«ã¤ã„ã¦ã€ãã®åå‰ï¼ˆã‚³ãƒ¼ãƒ‰ä¸Šã§ã®åˆ—æŒ™å€¤åï¼‰ã‚’`name_of()`ã«ã‚ˆã£ã¦å–å¾—ï¼ˆ`std::string_view`ã§å¾—ã‚‰ã‚Œã‚‹ï¼‰ã—ã¦è¿”ã—ã¾ã™ã€‚ã‚‚ã—ä¸€è‡´ã™ã‚‹ã‚‚ã®ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆï¼ˆ`|`ã§ãƒ“ãƒƒãƒˆåˆæˆã—ãŸåˆ—æŒ™å€¤ãªã©ï¼‰ã€`"<unnamed>"`ã‚’è¿”ã—ã¾ã™ã€‚

ã“ã®ã‚³ãƒ¼ãƒ‰ã¯å®Ÿè¡Œæ™‚ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ãŒå…¥ã‚Šä¹±ã‚Œã¦ã„ã¦ã‚ã‹ã‚Šã¥ã‚‰ã„ã§ã™ãŒã€`^`ãªã©ã«ã‚ˆã£ã¦å¾—ã‚‰ã‚Œã‚‹ãƒ¡ã‚¿æƒ…å ±ã‚„*expansion-statement*ã«ã‚ˆã‚‹ã‚¤ãƒ†ãƒ¬ãƒ¼ãƒˆã€`[:...:]`ã«ã‚ˆã‚‹ã‚¹ãƒ—ãƒ©ã‚¤ã‚·ãƒ³ã‚°ãªã©ã¯å…¨ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å®Ÿè¡Œã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã«ã‚ˆã£ã¦ç”Ÿæˆãƒ»è¿½åŠ ã•ã‚Œã‚‹å®Ÿè¡Œæ™‚ãƒ¡ã‚¿æƒ…å ±ã¯ä½•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚`^`ã‹ã‚‰å§‹ã¾ã‚‹ä¸€é€£ã®ãƒ¡ã‚¿æƒ…å ±ã®å‡¦ç†ã¯å…¨ã¦é™çš„ã«è§£æ±ºã•ã‚Œã¦ãŠã‚Šã€ã“ã‚ŒãŒå€¤ãƒ™ãƒ¼ã‚¹ã®é™çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

ã“ã®ææ¡ˆã‚‚å«ã‚ã¦å€¤ãƒ™ãƒ¼ã‚¹ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã¾ã SG7ã§ã®è­°è«–ä¸­ã§ã‚ã‚‹ã®ã§ã€C++23ã«å…¥ã‚‹ã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã€‚ç¾åœ¨ã®Reflection TSã‚‚ã€å€¤ãƒ™ãƒ¼ã‚¹ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦æ›¸ãæ›ãˆã‚‰ã‚Œã‚‹ã¯ãšãªã®ã§ã€ãã‚Œã‚‚C++23ã«å°å…¥ã•ã‚Œã‚‹ã“ã¨ã¯ãªã•ãã†ã§ã™ã€‚é™çš„ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒC++ã«å°å…¥ã•ã‚Œã‚‹ã®ã¯æ—©ãã¦ã‚‚C++26ã€TSã¨ã—ã¦ã®çµŒé¨“ã‚’é‡è¦–ã™ã‚‹å ´åˆã¯ã‚‚ã£ã¨å¾Œã«ãªã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

- [N4766 Working Draft, C++ Extensions for Reflection](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4766.pdf)
- [P0425R0 Metaprogramming by design, not by accident](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0425r0.pdf)
- [P0993R0 Value-based Reflection](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0993r0.pdf)
- [P1240 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/545)

### [P1664R6 reconstructible_range - a concept for putting ranges back together](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1664r6.html)
### [P1841R2 Wording for Individually Specializable Numeric Traits](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1841r2.pdf)
### [P1854R3 Conversion to literal encoding should not lead to loss of meaning](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1854r3.pdf)
### [P1885R9 Naming Text Encodings to Demystify Them](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1885r9.pdf)
### [P1899R2 stride_view](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p1899r2.html)
### [P2000R3 Direction for ISO C++](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2000r3.pdf)
### [P2079R2 System execution context](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2079r2.html)
### [P2093R12 Formatted output](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2093r12.html)
### [P2165R3 Compatibility between tuple, pair and tuple-like objects](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2165r3.pdf)
### [P2248R4 Enabling list-initialization for algorithms](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2248r4.html)
### [P2249R4 Mixed comparisons for smart pointers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2249r4.html)
### [P2286R5 Formatting Ranges](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2286r5.html)
### [P2286R5 Formatting Ranges](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2286r6.html)
### [P2300R4 std::execution](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2300r4.html)
### [P2302R3 std::ranges::contains](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2302r3.html)
### [P2324R2 Labels at the end of compound statements (C compatibility)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2324r2.pdf)
### [P2363R3 Extending associative containers with the remaining heterogeneous overloads](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2363r3.html)
### [P2370R2 Stacktrace from exception](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2370r2.html)
### [P2375R1 Generalisation of nth_element to a range of nths](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2375r1.pdf)
### [P2404R1 Move-only types for equality_comparable_with, totally_ordered_with, and three_way_comparable_with](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2404r1.pdf)
### [P2404R2 Move-only types for equality_comparable_with, totally_ordered_with, and three_way_comparable_with](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2404r2.pdf)
### [P2424R0 Abbreviated Parameters](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2424r0.html)

é–¢æ•°å¼•æ•°ã®ç°¡æ˜“å®£è¨€æ§‹æ–‡ã®ææ¡ˆã€‚

1è¡Œã§æ¸ˆã‚€ã‚ˆã†ãªå˜ç´”ãªé–¢æ•°ã‚’ãƒ©ãƒ ãƒ€å¼ã‚’ç”¨ã„ã¦å®šç¾©ã—ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¤šãã€ãã®ãŸã‚ãƒ©ãƒ ãƒ€å¼ã‚’å¯èƒ½ãªé™ã‚Šç°¡æ½”ã«æ›¸ãã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ãŸã„ã¨ã„ã†è¦æœ›ãŒå¼·ãã‚ã‚Šã¾ã™ã€‚ãã‚Œã‚’å—ã‘ã¦ã€çŸ­ç¸®ãƒ©ãƒ ãƒ€ææ¡ˆï¼ˆ[P0573R2](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0573r2.html)ï¼‰ãªã©ã„ãã¤ã‹ã®ææ¡ˆãŒã•ã‚Œã¾ã—ãŸãŒã€ä»¥ä¸‹ã®ã‚ˆã†ãªç†ç”±ã«ã‚ˆã£ã¦ãƒªã‚¸ã‚§ã‚¯ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚

1. é€šå¸¸ã®ãƒ©ãƒ ãƒ€å¼ã¨æ„å‘³è«–ãŒç•°ãªã‚‹ã€‚é–¢æ•°æœ¬ä½“ãŒåŒã˜ã§ã‚‚ã€çŸ­ç¸®å½¢ã‹å¦ã‹ã«ã‚ˆã£ã¦æˆ»ã‚Šå€¤å‹ãŒç•°ãªã‚‹ã€‚
2. ä»»æ„ã®å…ˆèª­ã¿ãƒ‘ãƒ¼ã‚¹ãŒå¿…è¦ã¨ãªã‚‹ã€‚ãƒ‘ãƒ¼ã‚µãƒ¼ã¯ãƒ©ãƒ ãƒ€å¼ãŒçŸ­ç¸®å½¢ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ãŸã‚ã«ãƒ©ãƒ ãƒ€å¼æœ¬ä½“ã‚’å…ˆèª­ã¿ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚
3. å¾Œç½®æˆ»ã‚Šå€¤å‹ã¨ã®ä¸ä¸€è‡´ã€‚ãƒ©ãƒ ãƒ€æœ¬ä½“ã¨å¾Œç½®æˆ»ã‚Šå€¤å‹ã¨ã§ã¯è§£æãŒç•°ãªã‚‹ãŸã‚ã€çŸ­ç¸®ãƒ©ãƒ ãƒ€ã¯æ„å›³é€šã‚Šã«å‹•ä½œã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹
      - ã“ã®å•é¡Œã¯[P2036R2](https://wg21.link/p2036r2)ã§è§£æ±ºã•ã‚Œã‚‹ï¼ˆäºˆå®šï¼‰

ã“ã®å•é¡Œã®ã†ã¡ã€1ã¨3ã¯ãƒ©ãƒ ãƒ€æœ¬ä½“ã®æ„å‘³è«–ã«é–¢ã™ã‚‹ã“ã¨ã§ã€2ã¯ãƒ©ãƒ ãƒ€ã®å¼•æ•°å®£è¨€ã«é–¢ã™ã‚‹äº‹ã§ã™ã€‚ãã—ã¦ã€å¤šãã®å ´åˆãƒ©ãƒ ãƒ€å¼ã®å†—é•·æ€§ã‚’æœ€ã‚‚é«˜ã‚ã¦ã„ã‚‹ã®ã¯å¼•æ•°å®£è¨€å‘¨è¾ºã®æ§‹æ–‡ã§ã™ã€‚

```cpp
[](const auto& a, const auto& b) { return a < b; }
```

`auto&&`ã‚’ç”¨ã„ã‚‹ã¨ã‚‚ã†å°‘ã—çŸ­ç¸®ã§ãã‚‹ã¨ã„ã†ä¸»å¼µã‚‚ã‚ã‚Šã¾ã™ãŒã€`auto&&`ãŒ`const`ã¨ãªã‚‹ã®ã¯å®Ÿå¼•æ•°ãŒã™ã§ã«`const`ã§ã‚ã‚‹å ´åˆã®ã¿ã§ã™ã€‚ãƒ©ãƒ ãƒ€å¼ã§ã¯é`const`ãªã‚‚ã®ã‚’æ¸¡ã—ã¦å†…éƒ¨ã§ã¯`const`ã¨ã—ã¦æ‰±ã„ãŸã„å ´åˆãŒå¤šãã€`auto&&`ã¯æ„å‘³ãŒç•°ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

ã“ã“ã§ã€ã“ã®å¼•æ•°å®£è¨€ã‹ã‚‰å‹ã®æŒ‡å®šã‚’å–ã‚Šé™¤ãã¨å¤§ããå†—é•·æ€§ã‚’ä½ä¸‹ã•ã›ã‚‹ã“ã¨ãŒã§ãã€

ãã“ã§ã€ã“ã®ææ¡ˆã§ã¯ä¸Šè¨˜ã«åˆ—æŒ™ã—ãŸ2ã¤ç›®ã®å•é¡Œï¼ˆå¼•æ•°å®£è¨€å‘¨ã‚Šã®å•é¡Œï¼‰ã«çš„ã‚’çµã‚Šã€çœç•¥ã•ã‚ŒãŸä»®å¼•æ•°å®£è¨€ï¼ˆ*Abbreviated Parameters*ï¼‰ã¨ã„ã†æ§‹æ–‡ã®å°å…¥ã«ã‚ˆã‚Šã“ã®è§£æ±ºã‚’å›³ã‚Šã¾ã™ã€‚

```cpp
// ãƒ©ãƒ ãƒ€å¼
[]((a, b)) { return a < b; }
// é–¢æ•°
auto less_then((a, b)) { return a < b; }
```

äºŒé‡ã‹ã£ã“`(())`ã§å›²ã¾ã‚Œã¦ã„ã‚‹ã‚‚ã®ãŒçœç•¥ã•ã‚ŒãŸä»®å¼•æ•°ãƒªã‚¹ãƒˆã§ã™ã€‚ã“ã®å†…éƒ¨ã®è­˜åˆ¥å­ã¯å‹åã§ã¯ãªãå¤‰æ•°åï¼ˆå¼•æ•°åï¼‰ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™

```cpp
// stringå‹ã€vectorå‹ã®ä»®å¼•æ•°å®£è¨€ã€å¼•æ•°åãªã—
auto something(string, vector);

// stringã€vectorã¨ã„ã†åå‰ã®ä»®å¼•æ•°å®£è¨€ã€å‹æŒ‡å®šãªã—ï¼ˆã“ã®ææ¡ˆï¼‰
auto something((string, vector));
```

ã“ã®æ™‚ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šãƒªã‚¹ãƒˆã®å„è¦ç´ ã«2ã¤ä»¥ä¸Šã®è­˜åˆ¥å­ãŒæŒ‡å®šã•ã‚ŒãŸå ´åˆã€ãã‚Œã¯é€šå¸¸ã®ä»®å¼•æ•°å®£è¨€ã¨åŒã˜ã‚‚ã®ã¨ã—ã¦æ‰±ã‚ã‚Œã¾ã™ã€‚

```cpp
// ã“ã®2ã¤ã¯åŒã˜å®£è¨€ã¨ãªã‚‹
auto something(vector v);
auto something((vector v));

// ã“ã®2ã¤ã‚‚åŒã˜å®£è¨€ã¨ãªã‚‹
auto something(const vector& v);
auto something((const vector& v));
```

è¨€ã„æ›ãˆã‚‹ã¨ã€çœç•¥ã•ã‚ŒãŸä»®å¼•æ•°å®£è¨€ã«ãŠã„ã¦å‹åã®çœç•¥ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã“ã‚Œã¯å½“ç„¶æ··åœ¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```cpp
auto something((string, const vector& v));  // ok
```

çœç•¥ã•ã‚ŒãŸä»®å¼•æ•°å®£è¨€ï¼ˆã®ã†ã¡å‹åæŒ‡å®šãŒãªã„ã‚‚ã®ï¼‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¼´ã†å¼•æ•°å®£è¨€ã¨ã¿ãªã•ã‚Œã€é€šå¸¸ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆå®Ÿå¼•æ•°æ¨è«–ã«å¾“ã£ã¦å‹ãŒæ¨è«–ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã¯ã€ãƒ©ãƒ ãƒ€å¼ã®å¼•æ•°å®£è¨€ã‹ã‚‰ã•ã‚‰ã«`auto`ã‚’çœç•¥ã—ã¦ã„ã‚‹ã‚ã‘ã§ã™ã€‚

```cpp
// ã“ã‚Œã‚‰ã¯ï¼ˆã»ã¼ï¼‰åŒã˜å®£è¨€ã¨ãªã‚‹
template<typename T>
auto something(T/*qualifiers*/ v);

auto something(auto/*qualifiers*/ v);

auto something((v));
```

ãŸã ã—ã€ä¿®é£¾ï¼ˆ`/*qualifiers*/` : `&&`ã¨ã‹`const`ãªã©ï¼‰ã¯ç•°ãªã‚Šã€ã„ãã¤ã‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã‚ã‚Šã¾ã™ãŒã“ã®ææ¡ˆã§ã¯`const auto&`ã¨åŒã˜æ¨è«–ã‚’è¡Œã†ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚

```cpp
// ã“ã‚Œã‚‰ã¯åŒã˜å®£è¨€ã¨ãªã‚‹
template<typename T>
auto something(const T& v);

auto something(const auto& v);

auto something((v));
```

`auto&&`ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒå¯å¤‰å‚ç…§ã§ã‚ã‚Šãã‚ŒãŒè¦‹ãˆãªããªã‚‹ã“ã¨ã§å±é™ºæ€§ãŒå¢—ã™ã¨ã¨ã‚‚ã«æ³¨æ„ã™ã¹ãã“ã¨ã‚„å‰æçŸ¥è­˜ãŒå¢—ãˆã‚‹ãŸã‚ã€ã“ã®ææ¡ˆã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆimmutableãŒæœ€é©ã ã¨ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒå‚ç…§ã¨ãªã‚‹ãŸã‚å‹ã«ã‚ˆã£ã¦ã¯éåŠ¹ç‡ã¨ãªã‚Šå¾—ã¾ã™ãŒã€ãã®ã‚ˆã†ãªå‹ã«å¯¾ã—ã¦ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶ãŒã“ã‚Œã‚’ã‚³ãƒ”ãƒ¼ã«ç½®ãæ›ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã‚‚ææ¡ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

```cpp
std::string s;
std::vector<std::string> v;

std::for_each(s.begin(), s.end(), []((c)){ ... }); // decltype(c) is `const char`
std::for_each(v.begin(), v.end(), []((s)){ ... }); // decltype(s) is `const std::sting&`
```

ã“ã®ã‚ˆã†ãªæŒ¯ã‚‹èˆã„ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¼•æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹å ´åˆã«å•é¡Œã¨ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ãŒã€å¼•æ•°ã‚’ãƒã‚¤ãƒ³ã‚¿å‹ã§å®£è¨€ã—ãªã„ã®ã«å®Ÿå¼•æ•°ã®å‚ç…§å…ƒã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—ã™ã‚‹ã‚ˆã†ãªã‚±ãƒ¼ã‚¹ã¯è€ƒãˆã¥ã‚‰ã„ãŸã‚ã€ã“ã®ææ¡ˆã§ã¯è€ƒæ…®ã—ãªã„ã“ã¨ã«ã—ã¦ã„ã¾ã™ã€‚

```cpp
// å•é¡Œã¨ãªã‚Šã†ã‚‹ã‚±ãƒ¼ã‚¹ã ãŒ
void func((arg)) { persistAddrOf(&arg); ... }

// æ™®é€šã¯ã“ã†æ›¸ã‹ã‚Œã‚‹ã¯ãšï¼Ÿ
void func(const auto* arg)) { persistAddrOf(arg); ... }
```

- [P2424 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1166)

### [P2437R1 Support for #warning](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2437r1.pdf)
### [P2447R2 std::span and the missing constructor](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2447r2.html)
### [P2448R1 Relaxing some constexpr restrictions](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2448r1.html)
### [P2457R0 2021 December Library Evolution Poll Outcomes](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2457r0.html)
### [P2458R0 2022 January Library Evolution Polls](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2458r0.html)
### [P2468R2 The Equality Operator You Are Looking For](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2468r2.html)
### [P2474R1 views::repeat](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2474r1.html)
### [P2494R1 Relaxing range adaptors to allow for move only types](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2494r1.html)
### [P2498R1 Forward compatibility of text_encoding with additional encoding registries](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2498r1.pdf)
### [P2507R1 Limit [[assume]] to conditional-expressions](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2507r1.pdf)
### [P2508R1 Exposing std::basic-format-string](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2508r1.html)
### [P2511R0 Beyond operator(): NTTP callables in type-erased call wrappers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2511r0.html)
### [P2512R0 SG16: Unicode meeting summaries 2021-06-09 through 2021-12-15](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2512r0.html)
### [P2513R0 char8_t Compatibility and Portability Fixes](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2513r0.html)
### [P2514R0 std::breakpoint](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2514r0.html)
### [P2515R0 std::is_debugger_present](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2515r0.html)
### [P2516R0 string_view is implicitly convertible from what?](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2516r0.html)
### [P2517R0 Add a conditional noexcept specification to std::apply](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2517r0.html)
### [P2520R0 move_iterator should be a random access iterator](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2520r0.html)
### [P2521R0 Contract support -- Working Paper](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2521r0.html)
### [P2523R0 Request for re-inclusion of std::hive proposal in C++23](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2523r0.html)
### [P2524R0 SG14: Low Latency/Games/Embedded/Finance/Simulation 2020/12/09-2022/01/12](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2524r0.pdf)
### [P2525R0 SG19: Machine Learning Meeting Minutes 2020/12/10-2022/01/13](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2525r0.pdf)
### [P2527R0 std::variant_alternative_index and std::variant_alternative_index_v](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2022/p2527r0.html)