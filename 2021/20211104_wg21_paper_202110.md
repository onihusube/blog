# ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰

æ–‡æ›¸ã®ä¸€è¦§

- [JTC1/SC22/WG21 - Papers 2021 mailing2021-10](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/#mailing2021-10)

å…¨éƒ¨ã§74æœ¬ã‚ã‚Šã€SG22ï¼ˆC/C++ç›¸äº’äº’æ›æ€§ã«é–¢ã™ã‚‹ç ”ç©¶ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰ã®Cã®ææ¡ˆã‚’é™¤ãã¨73æœ¬ã«ãªã‚Šã¾ã™ã€‚

[:contents]

## æ¡æŠã•ã‚ŒãŸæ–‡æ›¸

ã“ã“ã«ã‚ã‚‹ã®ã¯10æœˆã®å…¨ä½“ä¼šè­°ã§ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆå…¥ã‚ŠãŒæ‰¿èªã•ã‚ŒãŸææ¡ˆã§ã™ã€‚ãŸã ã—ã€ä»Šæœˆææ¡ˆæ–‡æ›¸ã®æ”¹å®šãŒãªã„ã‚‚ã®ã‚‚ã‚ã‚‹ã®ã§ã“ã‚Œã§å…¨éƒ¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

### [P0798R8 Monadic operations for `std::optional`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p0798r8.html)

`std::optional`ã«*monadic interface*ã®ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P0798R6 Monadic operations for `std::optional` - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/06/13/165215#P0798R6-Monadic-operations-for-stdoptional)

R7ï¼ˆæœªå…¬é–‹ï¼‰ã®å¤‰æ›´ã¯

- æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒã‚¯ãƒ­ã®å¤‰æ›´
- å„é–¢æ•°ã®åˆ¶ç´„ã®èª¿æ•´

R8ã®å¤‰æ›´ã¯

- `transform`ã®å—ã‘å–ã‚‹é–¢æ•°ã®æˆ»ã‚Šå€¤å‹ã«`remove_cv`ã‚’é©ç”¨
- `or_else`ã‹ã‚‰äº‹å‰æ¡ä»¶ã‚’å‰Šé™¤
- `transform`ãŒã‚³ãƒ”ãƒ¼çœç•¥è¡Œãˆã‚‹ã‚ˆã†ã«èª¿æ•´

ãªã©ã§ã™ã€‚

- [P0798 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/112)

### [P1147R1 Printing `volatile` Pointers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1147r1.html)

æ¨™æº–ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ãŠã„ã¦ã€`volatile`ãƒã‚¤ãƒ³ã‚¿ã®`<<`ã«ã‚ˆã‚‹å‡ºåŠ›ã‚’ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ææ¡ˆã€‚

æ¨™æº–å‡ºåŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ã¦`volatile`ãƒã‚¤ãƒ³ã‚¿ã‚’å‡ºåŠ›ã™ã‚‹ã¨ã€äºˆæœŸã—ãªã„å€¤ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```cpp
int main() {
           int* p0 = reinterpret_cast<         int*>(0xdeadbeef);
  volatile int* p1 = reinterpret_cast<volatile int*>(0xdeadbeef);

  std::cout << p0 << std::endl; // 0xdeadbeef
  std::cout << p1 << std::endl; // 1
}
```

æ¨™æº–å‡ºåŠ›ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«å¯¾ã™ã‚‹ã‚¹ãƒˆãƒªãƒ¼ãƒ å‡ºåŠ›æ¼”ç®—å­ï¼ˆ`<<`ï¼‰ã§ã¯ã€`const void*`ï¼ˆé`volatile`ãƒã‚¤ãƒ³ã‚¿ï¼‰ã®å‡ºåŠ›ã‚’è¡Œã†ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã¯ã‚ã‚Šã€æ™®é€šã®ãƒã‚¤ãƒ³ã‚¿ã¯ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€`volatile`ãƒã‚¤ãƒ³ã‚¿ã¯ã“ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã§ããšï¼ˆCVä¿®é£¾ãŒåˆã‚ãªã„ãŸã‚ï¼‰ã€ãƒã‚¤ãƒ³ã‚¿->`bool`ã®å¤‰æ›ã‚’ä»‹ã—ã¦`bool`å€¤ã¨ã—ã¦å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

ã“ã®ææ¡ˆã¯ã€`operator<<(const volatile void*)`ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã“ã®æ„å›³ã—ãªã„å¤‰æ›ã‚’é˜²æ­¢ã—ã€`volatile`ãƒã‚¤ãƒ³ã‚¿ã‚’é©åˆ‡ã«å‡ºåŠ›ã§ãã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

- [P0798 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/320)

### [P1272R4 Byteswapping for fun&&nuf](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1272r4.html)

ãƒã‚¤ãƒˆã‚¹ãƒ¯ãƒƒãƒ—ï¼ˆãƒã‚¤ãƒˆã‚ªãƒ¼ãƒ€ãƒ¼å¤‰æ›ï¼‰ã®ãŸã‚ã®é–¢æ•°`std::byteswap()`ã®ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P1272R3 : Byteswapping for fun&&nuf - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´07æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/08/12/014639#P1272R3--Byteswapping-for-funnuf)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£ã®ã¿ã§ã™ã€‚

- [`std::byteswap` - cpprefjp](https://cpprefjp.github.io/reference/bit/byteswap.html)
- [P1272 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/270)

### [P2077R3 Heterogeneous erasure overloads for associative containers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2077r3.html)

é€£æƒ³ã‚³ãƒ³ãƒ†ãƒŠã«å¯¾ã—ã¦é€éçš„ãªè¦ç´ ã®å‰Šé™¤ã¨å–ã‚Šå‡ºã—æ–¹æ³•ã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2077R1 Heterogeneous erasure overloads for associative containers - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´9æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/10/09/221025#P2077R1--Heterogeneous-erasure-overloads-for-associative-containers)
- [P2077R2 Heterogeneous erasure overloads for associative containers - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´12æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/01/17/005823#P2077R2-Heterogeneous-erasure-overloads-for-associative-containers)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€LWGã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«åŸºã¥ã„ã¦ææ¡ˆã™ã‚‹æ–‡è¨€ã‚’ä¿®æ­£ã—ãŸã“ã¨ã§ã™ã€‚

- [P2077 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/804)

### [P2314R4 Character sets and encodings](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2314r4.html)

è¦æ ¼æ–‡æ›¸ä¸­ã® *~ character set*ã¨ã„ã†è¨€è‘‰ã‚’æ˜ç¢ºã«å®šç¾©ã—ç›´ã™ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2314R0 Character sets and encodings - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´02æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/03/12/225547#P2314R0-Character-sets-and-encodings)
- [P2314R1 Character sets and encodings - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´03æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/04/10/222356#P2314R1-Character-sets-and-encodings)
- [P2314R2 Character sets and encodings - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/06/13/165215#P2314R2-Character-sets-and-encodings)
- [P2314R3 Character sets and encodings - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2314R3-Character-sets-and-encodings)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯

- [P1949](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1949r7.html)ã®å¤‰æ›´ã‚’é©ç”¨ã™ã‚‹å½¢ã§æ›´æ–°
- CWGãªã©ã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«ã‚ˆã‚‹ææ¡ˆã™ã‚‹æ–‡è¨€ã®æ”¹å–„

ãªã©ã§ã™ã€‚

- [P2314 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/998)

### [P2415R2 What is a view?](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2415r2.html)

`view`ã‚³ãƒ³ã‚»ãƒ—ãƒˆã®è¦ä»¶ã‚’ç·©å’Œã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2415R0 What is a view? - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´07æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/08/14/213339#P2415R0-What-is-a-view)
- [P2415R1 What is a view? - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/09/03/230045#P2415R1-What-is-a-view)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£ã®ã¿ã§ã™ï¼ˆå¤šåˆ†ï¼‰ã€‚

- [P2415 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1085)

### [P2418R2 Add support for std::generator-like types to `std::format`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2418r2.html)

[`std::generator`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2168r3.pdf)-likeãªå‹ã«å¯¾ã™ã‚‹`<format>`ã®ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2418R0 Add support for std::generator-like types to `std::format` - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/09/03/230045#P2418R0-Add-support-for-stdgenerator-like-types-to-stdformat)
- [P2418R1 Add support for std::generator-like types to `std::format` - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2418R1-Add-support-for-stdgenerator-like-types-to-stdformat)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®æ”¹å–„ï¼ˆä¸»ã«*Formatter*è¦ä»¶ã‚’è¦æ±‚ã™ã‚‹ã¨ã“ã‚ã®èª¿æ•´ï¼‰ã§ã™ã€‚

- [P2418 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1092)

### [P2432R1 Fix `istream_view`, Rev 1](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2432r1.pdf)

`std::views::istream_view<T>()`ã®ä»–ã®`view`ã¨ã®éä¸€è²«æ€§ã‚’æ­£ã™ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2432R0 Fixing `istream_view` - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2432R0-Fixing-istream_view)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ä¾‹ã®ä¿®æ­£ã¨ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£ã§ã™ã€‚

- [P2432 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1098)

### [P2450R0 C++ Standard Library Issues to be moved in Virtual Plenary, Oct. 2021](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2450r0.html)

ä»Šå›ã®ä¼šè­°ã§æ¡æŠã•ã‚ŒãŸæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¤ã„ã¦ã®Issueå ±å‘Šã¨ãã®è§£æ±ºã€‚

1. [2191. Incorrect specification of `match_results(match_results&&)`](https://cplusplus.github.io/LWG/lwg-active.html#2191)
2. [2381. Inconsistency in parsing floating point numbers](https://cplusplus.github.io/LWG/lwg-active.html#2381)
3. [2762. unique_ptr `operator*()` should be noexcept](https://cplusplus.github.io/LWG/lwg-active.html#2762)
4. [3121. tuple constructor constraints for `UTypes&&...` overloads](https://cplusplus.github.io/LWG/lwg-active.html#3121)
5. [3123. duration constructor from representation shouldn't be effectively non-throwing](https://cplusplus.github.io/LWG/lwg-active.html#3123)
6. [3146. Excessive unwrapping in `std::ref/cref`](https://cplusplus.github.io/LWG/lwg-active.html#3146)
7. [3152. `common_type` and `common_reference` have flaws in common](https://cplusplus.github.io/LWG/lwg-active.html#3152)
8. [3293. move_iterator `operator+()` has incorrect constraints](https://cplusplus.github.io/LWG/lwg-active.html#3293)
9. [3361. `safe_range<SomeRange&>` case](https://cplusplus.github.io/LWG/lwg-active.html#3361)
10. [3392. `ranges::distance()` cannot be used on a move-only iterator with a sized sentinel](https://cplusplus.github.io/LWG/lwg-active.html#3392)
11. [3407. Some problems with the wording changes of P1739R4](https://cplusplus.github.io/LWG/lwg-active.html#3407)
12. [3422. Issues of seed_seq's constructors](https://cplusplus.github.io/LWG/lwg-active.html#3422)
13. [3470. convertible-to-non-slicing seems to reject valid case](https://cplusplus.github.io/LWG/lwg-active.html#3470)
14. [3480. directory_iterator and recursive_directory_iterator are not C++20 ranges](https://cplusplus.github.io/LWG/lwg-active.html#3480)
15. [3498. Inconsistent noexcept-specifiers for `basic_syncbuf`](https://cplusplus.github.io/LWG/lwg-active.html#3498)
16. [3535. `join_view::iterator::iterator_category` and `::iterator_concept` lie](https://cplusplus.github.io/LWG/lwg-active.html#3535)
17. [3554. `chrono::parse` needs `const charT*` and `basic_string_view<charT>` overloads](https://cplusplus.github.io/LWG/lwg-active.html#3554)
18. [3557. The static_cast expression in `convertible_to` has the wrong operand](https://cplusplus.github.io/LWG/lwg-active.html#3557)
19. [3559. Semantic requirements of `sized_range` is circular](https://cplusplus.github.io/LWG/lwg-active.html#3559)
20. [3560. `ranges::equal` and `ranges::is_permutation` should short-circuit for `sized_ranges`](https://cplusplus.github.io/LWG/lwg-active.html#3560)
21. [3561. Issue with internal counter in `discard_block_engine`](https://cplusplus.github.io/LWG/lwg-active.html#3561)
22. [3563. `keys_view` example is broken](https://cplusplus.github.io/LWG/lwg-active.html#3563)
23. [3566. Constraint recursion for `operator<=>(optional<T>, U)`](https://cplusplus.github.io/LWG/lwg-active.html#3566)
24. [3567. Formatting move-only iterators take two](https://cplusplus.github.io/LWG/lwg-active.html#3567)
25. [3568. `basic_istream_view` needs to initialize `value_`](https://cplusplus.github.io/LWG/lwg-active.html#3568)
26. [3570. `basic_osyncstream::emit` should be an unformatted output function](https://cplusplus.github.io/LWG/lwg-active.html#3570)
27. [3571. `flush_emit` should set badbit if the emit call fails](https://cplusplus.github.io/LWG/lwg-active.html#3571)
28. [3572. copyable-box should be fully constexpr](https://cplusplus.github.io/LWG/lwg-active.html#3572)
29. [3573. Missing Throws element for `basic_string_view(It begin, End end)`](https://cplusplus.github.io/LWG/lwg-active.html#3573)
30. [3574. `common_iterator` should be completely constexpr-able](https://cplusplus.github.io/LWG/lwg-active.html#3574)
31. [3580. `iota_view`'s iterator's binary `operator+` should be improved](https://cplusplus.github.io/LWG/lwg-active.html#3580)
32. [3581. The range constructor makes `basic_string_view` not trivially move constructible](https://cplusplus.github.io/LWG/lwg-active.html#3581)
33. [3585. Variant converting assignment with immovable alternative](https://cplusplus.github.io/LWG/lwg-active.html#3585)
34. [3589. The const lvalue reference overload of get for subrange does not constrain `I` to be `copyable` when `N == 0`](https://cplusplus.github.io/LWG/lwg-active.html#3589)
35. [3590. `split_view::base() const &` is overconstrained](https://cplusplus.github.io/LWG/lwg-active.html#3590)
36. [3592. `lazy_split_view` needs to check the simpleness of Pattern](https://cplusplus.github.io/LWG/lwg-active.html#3592)
37. [3593. Several iterators' `base() const &` and `lazy_split_view::outer-iterator::value_type::end()` missing `noexcept`](https://cplusplus.github.io/LWG/lwg-active.html#3593)
38. [3595. Exposition-only classes proxy and postfix-proxy for `common_iterator` should be fully constexpr](https://cplusplus.github.io/LWG/lwg-active.html#3595)

### [P2462R0 Core Language Working Group â€œreadyâ€ issues for the October, 2021 meeting](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2462r0.html)

ä»Šå›ã®ä¼šè­°ã§æ¡æŠã•ã‚ŒãŸã‚³ã‚¢è¨€èªã«ã¤ã„ã¦ã®Issueå ±å‘Šã¨ãã®è§£æ±ºã€‚

1. [1249. Cv-qualification of nested lambda capture](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1249)
2. [1724. Unclear rules for deduction failure](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1724)
3. [1726. Declarator operators and conversion function](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1726)
4. [1733. Return type and value for operator= with ref-qualifier](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#1733)
5. [2484. char8_t and char16_t in integral promotions](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2484)
6. [2486. Call to noexcept function via noexcept(false) pointer/lvalue](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2486)
7. [2490. Restrictions on destruction in constant expressions](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2490)
8. [2491. Export of typedef after its first declaration](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2491)
9. [2496. ref-qualifiers and virtual overriding](http://www.open-std.org/jtc1/sc22/wg21/docs/cwg_active.html#2496)

## ãã®ä»–ã®æ–‡æ›¸

### [N4896 PL22.16/WG21 agenda: 4 October 2021, Virtual Meeting](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4896.html)

2021å¹´10æœˆ4æ—¥ 08:00 (åŒ—ç±³æ™‚é–“)ã«è¡Œã‚ã‚ŒãŸWG21æœ¬ä¼šè­°ã®ã‚¢ã‚¸ã‚§ãƒ³ãƒ€ã§ã™ã€‚

C++23ã®ãŸã‚ã®3å›ç›®ã®å…¨ä½“ä¼šè­°ã§ã™ã€‚

### [N4897 WG21 admin telecon meeting: September 2021](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4897.pdf)

WG21ã®å„ä½œæ¥­éƒ¨ä¼šã®ç®¡ç†è€…ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€‚

å‰å›ã‹ã‚‰ä»Šå›ã®ä¼šè­°ã®é–“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã®å ±å‘ŠãŒã•ã‚Œã¦ã„ã¾ã™ã€‚

### [N4898 WG21 2021-10 Virtual Meeting Minutes of Meeting](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4898.pdf)

2021å¹´10æœˆ4æ—¥ï¼ˆåŒ—ç±³æ™‚é–“ï¼‰ã«è¡Œã‚ã‚ŒãŸã€WG21å…¨ä½“ä¼šè­°ã®è­°äº‹éŒ²ã€‚

CWG/LWG/LEWGã®æŠ•ç¥¨ã®æ§˜å­ãªã©ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

### [N4899 WG21 admin telecon meetings: 2022](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4899.pdf)

æ¬¡å›ä»¥é™ã®WG21ã®å„ä½œæ¥­éƒ¨ä¼šã®ç®¡ç†è€…ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€‚

æ¬¡ã¯2022å¹´1æœˆ24æ—¥ã«äºˆå®šã•ã‚Œã¦ã„ã¾ã™ã€‚

### [N4900 WG21 virtual plenary meeting(s): 2022](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4900.pdf)

æ¬¡å›ä»¥é™ã®WG21å…¨ä½“ä¼šè­°ã®äºˆå®šè¡¨ã€‚

æ¬¡ã¯2æœˆ7æ—¥ã«äºˆå®šã•ã‚Œã¦ã„ã¾ã™ã€‚

### [N4901 Working Draft, Standard for Programming Language C++](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4901.pdf)

C++23ãƒ¯ãƒ¼ã‚­ãƒ³ã‚°ãƒ‰ãƒ©ãƒ•ãƒˆç¬¬5å¼¾ã€‚

### [N4902 Editors' Report - Programming Languages - C++](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/n4901.pdf)

â†‘ã®å¤‰æ›´ç‚¹ã‚’ã¾ã¨ã‚ãŸæ–‡æ›¸ã€‚

10æœˆã®ä¼šè­°ã§æ¡æŠã•ã‚ŒãŸææ¡ˆã¨ã‚³ã‚¢è¨€èª/ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®Issueè§£æ±ºãŒé©ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

### [P0009R13 MDSPAN](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p0009r13.html)

å¤šæ¬¡å…ƒé…åˆ—ã«å¯¾ã™ã‚‹`std::span`ã§ã‚ã‚‹ã€`mdspan`ã®ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P0009R12 MDSPAN - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/06/13/165215#P0009R12-MDSPAN)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯

- [P2299R3](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2299r3.html)ã®å†…å®¹ã®é©ç”¨
- ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£
- LEWGã®ã‚¬ã‚¤ãƒ€ãƒ³ã‚¹ã«å¾“ã£ã¦ã€è¨­è¨ˆã«é–¢ã™ã‚‹è­°è«–ã‚’è¿½è¨˜
- ãƒ©ãƒ³ã‚¯0`mdpsna`ã®`required_span_size`ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿®æ­£
- å°‘ãªãã¨ã‚‚1ã¤ã®è¦ç´ æ•°æŒ‡å®šãŒ0ã§ã‚ã‚‹`mdspan`ã®`layout_stride::required_span_size`ã‚’ä¿®æ­£
- `operator[]`ã‚’å¤šæ¬¡å…ƒé…åˆ—ã‚¢ã‚¯ã‚»ã‚¹ã«ä½¿ç”¨
- `span`ã¸ã®æ–‡è¨€ã®å‚ç…§ã‚’è§£æ¶ˆ
- `layout_stride`ã«ã‚¹ãƒˆãƒ©ã‚¤ãƒ‰ã¨ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ãŸã‚ã®å¤‰æ›ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ 
- `mdspan`ã«ãƒã‚¤ãƒ³ã‚¿ã¨ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ãƒˆã‹ã‚‰ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ 
- *layout policy mapping*ã«*nothrow move constructible/assignable*ã®è¦ä»¶ã‚’è¿½åŠ 
- *accessor policy*ã«*nothrow move constructible/assignable*ã®è¦ä»¶ã‚’è¿½åŠ 
- *accessor policy*ã«*accessor policy pointer*ã®è¦ä»¶ã‚’è¿½åŠ 
- `mdspan/submdspan`ãŒä½•ã‚‚ä¾‹å¤–ã‚’æŠ•ã’ãªã„ã¨ã„ã†æŒ‡å®šã‚’å‰Šé™¤

ãªã©ã§ã™ã€‚

- [P2299R3 mdspans of All Dynamic Extents - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´06æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/07/12/182757#P2299R3-mdspans-of-All-Dynamic-Extents)
- [P0009 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/96)

### [P0627R6 Function to mark unreachable code](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p0627r6.pdf)

åˆ°é”ä¸å¯èƒ½ãªã‚³ãƒ¼ãƒ‰é ˜åŸŸã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ã€`std::unreachable()`ã®ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P0627R5 Function to mark unreachable code - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P0627R5-Function-to-mark-unreachable-code)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒã‚¯ãƒ­è¡¨ç¾ã‚’ä¿®æ­£ã—ãŸã“ã¨ã§ã™ã€‚

ã“ã®ææ¡ˆã¯ã™ã§ã«LWGã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’çµ‚ãˆã¦ãŠã‚Šã€æ¬¡ã®å…¨ä½“ä¼šè­°ã§æŠ•ç¥¨ã«ã‹ã‘ã‚‰ã‚Œã‚‹äºˆå®šã§ã™ã€‚

- [P0627 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/275)

### [P1169R3 static operator()](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1169r3.html)

é–¢æ•°å‘¼ã³å‡ºã—æ¼”ç®—å­ï¼ˆ`operator()`ï¼‰ã‚’ã€é™çš„ãƒ¡ãƒ³ãƒé–¢æ•°ã¨ã—ã¦å®šç¾©ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P1169R1 `static operator()` - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´04æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/05/14/214016#P1169R1-static-operator)
- [P1169R2 `static operator()` - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/09/03/230045#P1169R2-static-operator)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒã‚¯ãƒ­ã‚’è¿½åŠ ã—ãŸã“ã¨ã€[LWG Issue 3617](https://cplusplus.github.io/LWG/issue3617)ã®å¤‰æ›´ã‚’å‰æã¨ã—ãŸæ–‡è¨€ã®è¿½åŠ ã§ã™ã€‚

- [P1169 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1022)

### [P1467R5 Extended floating-point types and standard names](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1467r5.html)

C++ã‚³ã‚¢è¨€èª/æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æ‹¡å¼µæµ®å‹•å°æ•°ç‚¹å‹ã®ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P1467R4 : Extended floating-point types and standard names - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´06æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/07/05/003248#P1467R4--Extended-floating-point-types-and-standard-names)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯

- æ–‡è¨€ã¨è¨­è¨ˆã«é–¢ã™ã‚‹æ–‡æ›¸ã‚’å€‹åˆ¥ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«åˆ†å‰²
- Cè¨€èªã¨ã®äº’æ›æ€§ã«é–¢ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¿½è¨˜
    - 2ã¤ã®è¨€èªã§ã®åŒã˜æµ®å‹•å°æ•°ç‚¹æ•°å‹ã‚’æŒ‡ã™å‹åã«ã¤ã„ã¦
    - 2ã¤ã®è¨€èªã®é–“ã®æ‹¡å¼µæµ®å‹•å°æ•°å‹ã®å¤‰æ›ï¼ˆ*usual arithmetic conversion*ï¼‰ã®é•ã„ã«ã¤ã„ã¦
- å¯å¤‰å¼•æ•°é–¢æ•°ã«æ¸¡ã—ãŸæ™‚ã®`double`ã¸ã®æ˜‡æ ¼ã‚’å‰Šé™¤
- `<format>`å‘¨ã‚Šã®æ–‡è¨€ã«é–¢ã™ã‚‹èª¬æ˜ã‚’è¿½è¨˜ï¼ˆä¸è¦ã ã£ãŸï¼‰
- I/Oã‚¹ãƒˆãƒªãƒ¼ãƒ ã«ã€`long double`ä»¥ä¸‹ã®å¹…ã‚’æŒã¤æ‹¡å¼µæµ®å‹•å°æ•°ç‚¹æ•°å‹ã®ã‚µãƒãƒ¼ãƒˆè¿½åŠ 
- `<charconv>/<cmath>`ã®æ–‡è¨€ã«ã¤ã„ã¦ã®èƒŒæ™¯ã®è¿½è¨˜
- ã‚ˆãçŸ¥ã‚‰ã‚Œã¦ã„ã‚‹æµ®å‹•å°æ•°ç‚¹æ•°ã«å¯¾å¿œã™ã‚‹å‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã®åå‰ã‚’ã€`std::floatN_t`ã¨ã™ã‚‹äº‹ã‚’æ±ºå®š

ãªã©ã§ã™ã€‚

- [P1450 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/227)

### [P1642R7 Freestanding Library: Easy [utilities], [ranges], and [iterators]](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1642r7.html)

[[utility]](https://timsong-cpp.github.io/cppwp/n4861/#utilities)ã€`<ranges>`ã€`<iterator>`ã‹ã‚‰ä¸€éƒ¨ã®ã‚‚ã®ã‚’ãƒ•ãƒªãƒ¼ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

å‰å›ã®è¨˜äº‹ã‚’å‚ç…§

- [P1642R3 Freestanding Library: Easy [utilities], [ranges], and [iterators] - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´6æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/07/05/003248#P1642R3--Freestanding-Library-Easy-utilities-ranges-and-iterators)
- [P1642R4 Freestanding Library: Easy [utilities], [ranges], and [iterators] - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´7æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/08/12/014639#P1642R4--Freestanding-Library-Easy-utilities-ranges-and-iterators)
- [P1642R5 Freestanding Library: Easy [utilities], [ranges], and [iterators] - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´12æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/01/17/005823#P1642R5-Freestanding-Library-Easy-utilities-ranges-and-iterators)
- [P1642R6 Freestanding Library: Easy [utilities], [ranges], and [iterators] - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´06æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/07/12/182757#P1642R6-Freestanding-Library-Easy-utilities-ranges-and-iterators)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€`<atomic>`ãŒãƒ•ãƒªãƒ¼ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã§ã‚ã‚Šç¶šã‘ã‚‹ã‚ˆã†ã«æ–‡è¨€ã‚’èª¿æ•´ã—ãŸã“ã¨ã€`std::unreachable`ã®è¿½åŠ ã«é–¢ã™ã‚‹è­°è«–ã‚’è¿½è¨˜ã—ãŸã“ã¨ã§ã™ã€‚

ã“ã®ææ¡ˆã§ã¯ã€`<utility>`å…¨ä½“ã‚’ãƒ•ãƒªãƒ¼ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¨ã—ã¦ã„ã¾ã™ãŒã€`std::unreachable`ã¯`<utility>`ã«è¿½åŠ ã•ã‚Œã‚‹äºˆå®šã®ãŸã‚è¡çªã—ã¦ã„ã¾ã™ã€‚`std::unreachable`ã‚’ãƒ•ãƒªãƒ¼ã‚¹ã‚¿ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¨ã™ã‚‹ã“ã¨ã«å¯¾ã™ã‚‹æŠ•ç¥¨ãŒè¡Œã‚ã‚ŒãŸã‚ˆã†ã§ã™ãŒã€åå¯¾ã™ã‚‹äººã¯ã„ãªã‹ã£ãŸã‚ˆã†ã§ã™ã€‚

- [P1642 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/429)

### [P1673R5 A free function linear algebra interface based on the BLAS](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1673r5.html)

æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã€BLASã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸå¯†è¡Œåˆ—ã®ãŸã‚ã®ç·šå½¢ä»£æ•°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

- [P1673R3 A free function linear algebra interface based on the BLAS - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´04æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/05/14/214016#P1673R3-A-free-function-linear-algebra-interface-based-on-the-BLAS)
- [P1673R4 A free function linear algebra interface based on the BLAS - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/09/03/230045#P1673R4-A-free-function-linear-algebra-interface-based-on-the-BLAS)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€`mdspan`ãŒ`()`ã«ä»£ã‚ã£ã¦`[]`ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«ãªã£ãŸãŸã‚ã€ãã®å¤‰æ›´ã‚’åæ˜ ã—ãŸã“ã¨ã§ã™ã€‚

ã©ã†ã‚„ã‚‰ã“ã®ææ¡ˆã¯C++26ã‚’ç›®æŒ‡ã™ã“ã¨ã«ãªã£ãŸã‚ˆã†ã§ã™ã€‚

- [P1673 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/557)

### [P1854R1 Conversion to literal encoding should not lead to loss of meaning](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1854r1.pdf)

æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å®Ÿè¡Œæ™‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«å¤‰æ›ã™ã‚‹éš›ã€æ–‡å­—è¡¨ç¾ãŒå¤±ã‚ã‚Œã‚‹å ´åˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ã™ã‚‹ææ¡ˆã€‚

æ–‡å­—åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰ã¨å®Ÿè¡Œæ™‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒç•°ãªã‚‹ã‚±ãƒ¼ã‚¹ã¯æ¯”è¼ƒçš„ã‚ˆãç™ºç”Ÿã—ã€ãã®æ™‚ã®æŒ¯ã‚‹èˆã„ã¯å®Ÿè£…å®šç¾©ã¨ã•ã‚Œã¦ã„ã¾ã™ã€‚

```cpp
#include <cstdio>

int main() {
  puts("ã“ã‚“ã«ã¡ã¯");
}
```

- [Compiler Explorer](https://compiler-explorer.com/z/4vheqx1oj)

ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’UTF-8ã§ä¿å­˜ã—ã€å®Ÿè¡Œæ™‚ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’Asciiã¨ã—ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ã¨ã€MSVCã§ã¯è­¦å‘Šã®ã¿ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚‹ã®ã«å¯¾ã—ã¦GCCã§ã¯ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã€ãã®éš›MSVCã¯Asciiå†…ã®ä»£æ›¿æ–‡å­—ï¼ˆ`?`ï¼‰ã§æ–‡å­—ã‚’ç½®æ›ã—ã¦ã„ã¾ã™ã€‚

ã“ã®äº‹ã¯C++ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç§»æ¤æ€§ã‚’æã­ã¦ãŠã‚Šã€æ–‡å­—åˆ—ã¯æ„å‘³ã‚„ç›®çš„ã‚’æŒã¤æ–‡æ›¸ã§ã‚ã‚Šå®Ÿè£…ãŒãã®æ„å‘³ã‚’å¤‰ãˆã‚‹ã¹ãã§ã¯ãªã„ãŸã‚ã€ã“ã®ã‚ˆã†ãªã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ç¸®å°å¤‰æ›ãŒèµ·ã“ã‚‹å ´åˆã‚’ill-formedã¨è¦å®šã—ã‚ˆã†ã¨ã™ã‚‹ææ¡ˆã§ã™ã€‚

ã“ã®ææ¡ˆã§ã¯ã¾ãŸã€è¤‡æ•°ã®æ–‡å­—ã«ã‚ˆã£ã¦1æ–‡å­—ã‚’æ§‹æˆã™ã‚‹ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰æ–‡å­—ï¼ˆ`Ã©`ã€`ğŸ‡¯ğŸ‡µ`ãªã©ï¼‰ãŒãƒãƒ«ãƒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒªãƒ†ãƒ©ãƒ«ã¨ã—ã¦èª­ã¿å–ã‚‰ã‚Œã¦æ„å›³ã—ãªã„1æ–‡å­—ã«ãªã‚‹å ´åˆã‚’ã‚¨ãƒ©ãƒ¼ã¨ã™ã‚‹äº‹ã‚‚åŒæ™‚ã«ææ¡ˆã—ã¦ã„ã¾ã™ã€‚

```cpp
int main() {
  [[maybe_unused]]
  char c = 'ğŸ‡¯ğŸ‡µ';
}
```
- [Compiler Explorer](https://godbolt.org/z/o9sjdoobq)

ãƒãƒ«ãƒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒªãƒ†ãƒ©ãƒ«ã«å«ã¾ã‚Œã‚‹æ–‡å­—ã¯åŸºæœ¬ãƒªãƒ†ãƒ©ãƒ«æ–‡å­—é›†åˆã®è¦ç´ ã®ã¿ã€ã¨è¦å®šã™ã‚‹äº‹ã§ã“ã®ã‚ˆã†ãªæ–‡å­—ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ã¨ãªã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€çµåˆæ–‡å­—ãªã©ã®ä¸å¯è¦–æ–‡å­—ãŒæ’é™¤ã•ã‚Œã‚‹ãŸã‚è¦‹ãŸç›®ã®æ›–æ˜§ã•ãŒè§£æ¶ˆã•ã‚Œã€ãƒãƒ«ãƒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒªãƒ†ãƒ©ãƒ«ã®çµæœãŒ`int`ã«åã¾ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

- [P1854 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/608)

### [P1885R8 Naming Text Encodings to Demystify Them](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1885r8.pdf)

ã‚·ã‚¹ãƒ†ãƒ ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å–å¾—ã—ã€è­˜åˆ¥ã‚„å‡ºåŠ›ãŒå¯èƒ½ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P1885R3 Naming Text Encodings to Demystify Them - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´9æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/10/09/221025#P1885R3--Naming-Text-Encodings-to-Demystify-Them)
- [P1885R4 Naming Text Encodings to Demystify Them - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´11æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/12/06/015108#P1885R4-Naming-Text-Encodings-to-Demystify-Them)
- [P1885R5 Naming Text Encodings to Demystify Them - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´02æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/03/12/225547#P1885R5-Naming-Text-Encodings-to-Demystify-Them)
- [P1885R6 Naming Text Encodings to Demystify Them - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/09/03/230045#P1885R6-Naming-Text-Encodings-to-Demystify-Them)
- [P1885R7 Naming Text Encodings to Demystify Them - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´08æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P1885R7-Naming-Text-Encodings-to-Demystify-Them)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯

- `wide_environment()`ã«é–¢ã™ã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®è¿½åŠ 
- å®Ÿè£…ãŒä»»æ„ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«è¿½åŠ ã™ã‚‹æ–¹æ³•ãŒå®Ÿè£…å®šç¾©ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«ã—ãŸ
- ææ¡ˆã™ã‚‹æ–‡è¨€ã«æ¨å¥¨æ–¹æ³•ã‚’è¿½åŠ 
- ãƒªãƒ†ãƒ©ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè¡¨ç¾ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã§ã‚ã‚‹ã“ã¨ã‚’æŒ‡å®š
- ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ã¯ã€ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚­ãƒ¼ãƒ ã§ã‚ã‚‹ã“ã¨ã‚’æŒ‡å®š
- UTF-16LE/BEã‚’å¸¸ã«UTF-16ã«ãƒãƒƒãƒ—ã™ã‚‹
- ä¾‹ã®ä¿®æ­£
- ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£

ãªã©ã§ã™ã€‚

- [P1885 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/634)

### [P2012R2 Fix the range-based for loop, Rev2](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2012r2.pdf)

ç¾åœ¨ã®*range-based for*ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã€ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å¯¾è±¡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ç”Ÿå­˜æœŸé–“ã«ã¾ã¤ã‚ã‚‹ç½ ã‚’ä¿®æ­£ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2012R0 Fix the range-based for loop, Rev0 - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´11æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/12/06/015108#P2012R0-Fix-the-range-based-for-loop-Rev0ix-the-range-based-for-loop)
- [P2012R1 Fix the range-based for loop, Rev1 - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2012R1-Fix-the-range-based-for-loop-Rev1)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®æ”¹å–„ãªã©ã§ã™ã€‚

- [P2012 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/939)

### [P2066R10 Suggested draft TS for C++ Extensions for Minimal Transactional Memory](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2066r10.html)

ç¾åœ¨ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒŠãƒ«ãƒ¡ãƒ¢ãƒªTSä»•æ§˜ã®ä¸€éƒ¨ã ã‘ã‚’ã€è»½é‡ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒŠãƒ«ãƒ¡ãƒ¢ãƒªã¨ã—ã¦C++ã¸å°å…¥ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2066R2 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/06/01/001003#P2066R2--Suggested-draft-TS-for-C-Extensions-for-Transaction-Memory-Light)
- [P2066R3 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/10/09/221025#P2066R3--Suggested-draft-TS-for-C-Extensions-for-Transaction-Memory-Light)
- [P2066R4 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´10æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/11/02/221657#P2066R4-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)
- [P2066R5 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´02æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/03/12/225547#P2066R5-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)
- [P2066R6 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´03æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/04/10/222356#P2066R6-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)
- [P2066R7 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/06/13/165215#P2066R7-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)
- [P2066R8 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´07æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/08/14/213339#P2066R8-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)
- [P2066R9 Suggested draft TS for C++ Extensions for Minimal Transactional Memory - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2066R9-Suggested-draft-TS-for-C-Extensions-for-Minimal-Transactional-Memory)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®å¤‰æ›´ç‚¹ã¯ã€LWGã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã«å¯¾å¿œã—ã¦æ–‡è¨€ã‚’ä¿®æ­£ã—ãŸäº‹ã§ã™ã€‚

ã“ã®ææ¡ˆã¯å…¨ä½“ä¼šè­°ã§æ‰¿èªã•ã‚Œã€ã€ŒMinimal Transactional Memory TSã€ã¨ã—ã¦ç™ºè¡Œã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

- [P2066 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/793)

### [P2248R2 Enabling list-initialization for algorithms](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2248r2.html)

å€¤ã‚’æŒ‡å®šã™ã‚‹ã‚¿ã‚¤ãƒ—ã®æ¨™æº–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ãŠã„ã¦ã€ãã®éš›ã®å‹æŒ‡å®šã‚’çœç•¥ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2248R0 Enabling list-initialization for algorithms - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´11æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/12/06/015108#P2248R0-Enabling-list-initialization-for-algorithms)
- [P2248R1 Enabling list-initialization for algorithms - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´12æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/01/17/005823#P2248R1-Enabling-list-initialization-for-algorithms)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯

- ç†è«–çš„æ ¹æ‹ ã«ã¤ã„ã¦è©³ã—ãè¿½è¨˜
- å‡ºåŠ›ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ`value_type`ã«ã¤ã„ã¦ã®èª¬æ˜ã®è¿½è¨˜
- ãƒ†ã‚¹ãƒˆå®Ÿè£…ã®ãƒªãƒ³ã‚¯è¿½åŠ 
- `*_scan`ç³»æ•°å€¤ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚’ä¿®æ­£

ãªã©ã§ã™ã€‚

- [P2248 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/944)

### [P2249R2 Mixed comparisons for smart pointers](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2249r2.html)

ã‚¹ãƒãƒ¼ãƒˆãƒã‚¤ãƒ³ã‚¿ãƒ¼ã®æ¯”è¼ƒæ¼”ç®—å­ã«ç”Ÿãƒã‚¤ãƒ³ã‚¿ã¨ã®ç›´æ¥æ¯”è¼ƒã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§

- [P2249R0 Mixed comparisons for smart pointers - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´02æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/03/12/225547#P2249R0-Mixed-comparisons-for-smart-pointers)
- [P2249R1 Mixed comparisons for smart pointers - ï¼»C++ï¼½WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´07æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/08/14/213339#P2249R1-Mixed-comparisons-for-smart-pointers)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã§ã®å¤‰æ›´ã¯ã€ææ¡ˆã™ã‚‹æ–‡è¨€ã®ä¿®æ­£ã§ã™ã€‚

- [P2249 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/981)

### [P2255R2 A type trait to detect reference binding to temporary](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2255r2.html)
### [P2264R1 Make assert() macro user friendly for C and C++](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2264r1.html)
### [P2264R2 Make assert() macro user friendly for C and C++](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2264r2.html)
### [P2291R3 Add Constexpr Modifiers to Functions to_chars and from_chars for Integral Types in Header](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2291r3.pdf)
### [P2300R2 std::execution](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2300r2.html)
### [P2322R5 `ranges::fold`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2322r5.html)
### [P2324R1 Labels at the end of compound statements (C compatibility)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2324r1.pdf)
### [P2327R1 De-deprecating volatile compound operations](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2327r1.pdf)
### [P2347R2 Argument type deduction for non-trailing parameter packs](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2347r2.pdf)
### [P2348R2 Whitespaces Wording Revamp](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2348r2.pdf)
### [P2350R2 constexpr class](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2350r2.pdf)
### [P2361R3 Unevaluated strings](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2361r3.pdf)
### [P2384R1 2021 Spring Library Evolution Poll Outcomes](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2384r1.html)

2021å¹´ã®æ˜¥ï¼ˆ4æœˆã‹ã‚‰6æœˆã«ã‹ã‘ã¦ï¼‰ã«è¡Œã‚ã‚ŒãŸã€LEWGã®å…¨ä½“æŠ•ç¥¨ã®çµæœã€‚

ä»¥å‰ã®è¨˜äº‹ã‚’å‚ç…§ã€‚

- [P2384R0 2021 Spring Library Evolution Poll Outcomes - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´6æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/07/12/182757#P2384R0-2021-Spring-Library-Evolution-Poll-Outcomes)

ã“ã®ãƒªãƒ“ã‚¸ãƒ§ãƒ³ã®å¤‰æ›´ã¯å¼•ç”¨ã™ã‚‹æ–‡æ›¸ãŒé–“é•ã£ã¦ã„ãŸã®ã‚’ä¿®æ­£ã—ãŸã ã‘ã§ã™ã€‚

### [P2387R2 Pipe support for user-defined range adaptors](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2387r2.html)
### [P2388R3 Minimum Contract Support: either No_eval or Eval_and_abort](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2388r3.html)
### [P2390R2 Add annotations for unreachable control flow](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2390r2.pdf)
### [P2400R2 Library Evolution Report: 2021-06-01 to 2021-09-20](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2400r2.html)
### [P2408R2 Ranges iterators as inputs to non-Ranges algorithms](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2408r2.html)
### [P2417R1 A more constexpr bitset](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2417r1.pdf)
### [P2435R1 2021 Summer Library Evolution Poll Outcomes](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2435r1.html)
### [P2445R0 `forward_like`](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2445r0.pdf)

ã‚¯ãƒ©ã‚¹å‹ã®ãƒ¡ãƒ³ãƒå¤‰æ•°ã«ã¤ã„ã¦ã€`const`æ€§ã‚‚å«ã‚ãŸæ­£ã—ã„å®Œå…¨è»¢é€ã‚’è¡Œã†`std::forward_like`ã®ææ¡ˆã€‚

ã“ã‚Œã¯[Deducing This](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p0847r7.html)ã«ã‚ˆã£ã¦é »å‡ºã™ã‚‹ã§ã‚ã‚ã†ã‚³ãƒ¼ãƒ‰ã‚’æ­£ã—ãæ›¸ããŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã§ã™ã€‚

```cpp
template<typename T>
struct wrap {
  T v;

  template<typename Self>
  auto value(this Self&& self) -> decltype(auto) {
    return std::forward<Self>(self).v; // ã‚ã£ã¦ã‚‹ï¼Ÿ
  }
};
```

ã“ã®`.value()`ãƒ¡ãƒ³ãƒé–¢æ•°ã¯`this`ï¼ˆ`self`ï¼‰ã®å€¤ã‚«ãƒ†ã‚´ãƒªã«å¿œã˜ã¦ãƒ¡ãƒ³ãƒ`v`ã®è¿”ã™å‹ï¼ˆå€¤ã‚«ãƒ†ã‚´ãƒªï¼‰ã‚’å¤‰åŒ–ã•ã›ãŸã„ã‚ã‘ã§ã™ã€‚C++20ã¾ã§ã¯`std::optional`ã®`.valeu()`ã®ã‚ˆã†ã«`const`ã¨å‚ç…§ä¿®é£¾ã«ã‚ˆã£ã¦4ã¤ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã«åˆ†ã‘ã¦ã„ã¾ã—ãŸãŒã€C++23ä»¥é™ã¯Deducing Thisã«ã‚ˆã£ã¦`this`ã«å¯¾å¿œã™ã‚‹å¼•æ•°ã‚’æ˜ç¤ºçš„ã«å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸäº‹ã‹ã‚‰1ã¤ã®é–¢æ•°ã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ãã®éš›ã€`this`ã®çŠ¶æ…‹ã«ã‚ˆã£ã¦ãƒ¡ãƒ³ãƒã‚’å®Œå…¨è»¢é€ã™ã‚‹ã«ã¯ãŠãŠã‚ˆãä¸Šè¨˜ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã«ãªã‚‹ã®ã§ã™ãŒã€ãƒ¡ãƒ³ãƒãŒå‚ç…§ã§ã‚ã‚‹å ´åˆã‚„`this`ãŒ`const`ã§ã‚ã‚‹å ´åˆã«æ­£ã—ã„çµæœã«ãªã‚Šã¾ã›ã‚“ã€‚æ¬¡ã®è¡¨ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«æ›¸ã„ãŸæ™‚ã®`.value()`ã®æˆ»ã‚Šå€¤å‹ãŒ`this`ã®çŠ¶æ…‹ã¨ãƒ¡ãƒ³ãƒã®çŠ¶æ…‹ã«ã‚ˆã£ã¦ã©ã†ãªã‚‹ã‹ã‚’ç¤ºã—ãŸã‚‚ã®ã§ã™

|`this`ï¼ˆ`self`ï¼‰|ãƒ¡ãƒ³ãƒï¼ˆ`v`ï¼‰|`std::forwad(self).v`|
|---|---|---|
|||`&&`|
|`&`||`&`|
|`&&`||`&&`|
|`const`||`const &&`|
|`const &`||`const &`|
|`const &&`||`const &&`|
||`const`|`const &&`|
|`&`|`const`|`const &`|
|`&&`|`const`|`const &&`|
|`const`|`const`|`const &&`|
|`const &`|`const`|`const &`|
|`const &&`|`const`|`const &&`|
||`&`|`&`|
|`&`|`&`|`&`|
|`&&`|`&`|`&`|
|`const`|`&`|`&`|
|`const &`|`&`|`&`|
|`const &&`|`&`|`&`|
||`&&`|`&`|
|`&`|`&&`|`&`|
|`&&`|`&&`|`&`|
|`const`|`&&`|`&`|
|`const &`|`&&`|`&`|
|`const &&`|`&&`|`&`|
||`const &`|`const &`|
|`&`|`const &`|`const &`|
|`&&`|`const &`|`const &`|
|`const`|`const &`|`const &`|
|`const &`|`const &`|`const &`|
|`const &&`|`const &`|`const &`|
||`const &&`|`const &`|
|`&`|`const &&`|`const &`|
|`&&`|`const &&`|`const &`|
|`const`|`const &&`|`const &`|
|`const &`|`const &&`|`const &`|
|`const &&`|`const &&`|`const &`|

è¡¨ä¸­ã®ç©ºç™½ã¯`const`ã‚‚å‚ç…§ä¿®é£¾ã‚‚ãªã„çŠ¶æ…‹ã€ã™ãªã‚ã¡å˜ãªã‚‹å€¤ã¨ã—ã¦å®£è¨€ã•ã‚Œã¦ã„ã‚‹å ´åˆã§ã™ï¼ˆ`this`ã®å ´åˆã¯ã‚³ãƒ”ãƒ¼ã•ã‚Œã¦ã„ã‚‹ã€ã™ãªã‚ã¡*prvlaue*ã®çŠ¶æ…‹ï¼‰ã€‚

ã“ã‚Œã‚’è¦‹ã‚‹ã¨ã€`std::forward<Self>(self).v`ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒå•é¡Œãªã„ã®ã¯ã€`v`ãŒéå‚ç…§ã§ã‚ã‚‹æ™‚ãã‚‰ã„ã®ã‚‚ã®ã§ã™ã€‚ãƒ¡ãƒ³ãƒãŒå‚ç…§ã§ã‚ã‚‹å ´åˆã¯`this`ã®`const`ãŒæ­£ã—ãä¼ã‚ã£ã¦ãŠã‚‰ãšã€ãƒ¡ãƒ³ãƒãŒ`const`å‚ç…§ã®å ´åˆã¯`this`ã®å€¤ã‚«ãƒ†ã‚´ãƒªï¼ˆç‰¹ã«å³è¾ºå€¤`&&`ï¼‰ãŒæ­£ã—ãä¼æ’­ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

`std::forward_like`ã¯ã“ã®ä¼æ’­ã‚’æ­£ã—ãè¡Œã„å®Œå…¨è»¢é€ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã€`std::forward`ã¨ã‚ˆãä¼¼ã¦ã„ã¾ã™ã€‚`forward_like`ã‚’ä½¿ã†ã¨å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã‚‰ã‚Œã¾ã™

```cpp
template<typename T>
struct wrap {
  T v;

  template<typename Self>
  auto value(this Self&& self) -> decltype(auto) {
    return std::forward_like<Self>(self.v);
  }
};
```

æ¬¡ã®è¡¨ã¯ã€å…ˆã»ã©ã®è¡¨ã«`forward_like`ã®çµæœã‚’è¿½è¨˜ã—ãŸã‚‚ã®ã§ã™

|`this`|ãƒ¡ãƒ³ãƒ|`forwad`|`forward_like`|
|---|---|---|---|
|||`&&`|`&&`|
|`&`||`&`|`&`|
|`&&`||`&&`|`&&`|
|`const`||`const &&`|`const &&`|
|`const &`||`const &`|`const &`|
|`const &&`||`const &&`|`const &&`|
||`const`|`const &&`|`const &&`|
|`&`|`const`|`const &`|`const &`|
|`&&`|`const`|`const &&`|`const &&`|
|`const`|`const`|`const &&`|`const &&`|
|`const &`|`const`|`const &`|`const &`|
|`const &&`|`const`|`const &&`|`const &&`|
||`&`|`&`|`&&`|
|`&`|`&`|`&`|`&`|
|`&&`|`&`|`&`|`&&`|
|`const`|`&`|`&`|`const &&`|
|`const &`|`&`|`&`|`const &`|
|`const &&`|`&`|`&`|`const &&`|
||`&&`|`&`|`&&`|
|`&`|`&&`|`&`|`&`|
|`&&`|`&&`|`&`|`&&`|
|`const`|`&&`|`&`|`const &&`|
|`const &`|`&&`|`&`|`const &`|
|`const &&`|`&&`|`&`|`const &&`|
||`const &`|`const &`|`const &&`|
|`&`|`const &`|`const &`|`const &`|
|`&&`|`const &`|`const &`|`const &&`|
|`const`|`const &`|`const &`|`const &&`|
|`const &`|`const &`|`const &`|`const &`|
|`const &&`|`const &`|`const &`|`const &&`|
||`const &&`|`const &`|`const &&`|
|`&`|`const &&`|`const &`|`const &`|
|`&&`|`const &&`|`const &`|`const &&`|
|`const`|`const &&`|`const &`|`const &&`|
|`const &`|`const &&`|`const &`|`const &`|
|`const &&`|`const &&`|`const &`|`const &&`|

`std::forwad`ã®æ™‚ã¨æ¯”è¼ƒã™ã‚‹ã¨ã€ãƒ¡ãƒ³ãƒãŒå‚ç…§ã§ã‚ã‚‹å ´åˆã«ã‚‚æ­£ã—ãï¼ˆç†æƒ³çš„ã«ï¼‰`const`ã¨å€¤ã‚«ãƒ†ã‚´ãƒªãŒä¼æ’­ã—ã¦ã„ã‚‹ã®ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚Deducing Thisã§å¯èƒ½ã«ãªã‚‹ã“ã¨ã‚’è€ƒãˆã‚Œã°ã“ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¯è‰¯ãæ›¸ã‹ã‚Œã‚‹ã“ã¨ãŒäºˆæƒ³ã•ã‚Œã€`forward_like`ã®å¿…è¦æ€§ã¯Deducing Thisã®ææ¡ˆä¸­ã§ã‚‚æŒ‡æ‘˜ã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

`std::forward_like`ã¯ç°¡å˜ã«ã¯æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¾ã™ã€‚


```cpp
// T->Uã¸å‚ç…§ï¼ˆå€¤ã‚«ãƒ†ã‚´ãƒªï¼‰ã‚’ä¼æ’­ã™ã‚‹
template <typename T, typename U>
using __override_ref_t = std::conditional_t<std::is_rvalue_reference_v<T>,
                                            std::remove_reference_t<U>&&, U&>;

// T->Uã¸constã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹
template <typename T, typename U>
using __copy_const_t = std::conditional_t<std::is_const_v<std::remove_reference_t<T>>,
                                          U const, U>;

// forward_likeã®çµæœå‹ã‚’æ±‚ã‚ã‚‹
template <typename T, typename U>
using __forward_like_t = __override_ref_t<T&&, __copy_const_t<T, std::remove_reference_t<U>>>;


template <typename T>
[[nodiscard]]
constexpr auto forward_like(auto&& x) noexcept -> __forward_like_t<T, decltype(x)> {
  return static_cast<__forward_like_t<T, decltype(x)>>(x);
}
```

å„ãƒ¡ã‚¿é–¢æ•°ã®`T`ã¯`*this`ã®ã€`U`ã¯ãƒ¡ãƒ³ãƒã®å‹ãŒæ¥ã¾ã™ã€‚ã™ãªã‚ã¡ã€ãªã‚‹ã¹ã`this`ã®å€¤ã‚«ãƒ†ã‚´ãƒªã‚’åˆ©ç”¨ã—ã¦ãƒ¡ãƒ³ãƒã®å€¤ã‚«ãƒ†ã‚´ãƒªã‚’æŒ‡å®šã—ã¤ã¤`this`ã®`const`ã‚’ä¼æ’­ã—ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

å€¤ã‚«ãƒ†ã‚´ãƒªã«ã‚ˆã£ã¦æŒ¯ã‚‹èˆã„ã‚’å¤‰åŒ–ã™ã‚‹ãƒ©ãƒ ãƒ€å¼ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã®ã‚µãƒ³ãƒ—ãƒ«

```cpp
auto callback = [m=get_message(), &scheduler](this auto&& self) -> bool {
  return scheduler.submit(std::forward_like<decltype(self)>(m));
};

callback();             // retry(callback)
std::move(callback)();  // try-or-fail(rvalue)
```

ã“ã®ä¾‹ã®ã‚ˆã†ã«ã€Deducing thisã«ã‚ˆã£ã¦ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦ã„ã‚‹ãƒ©ãƒ ãƒ€ã‚’æ‰±ã†éš›ã«`forward_like`ã¯ç‰¹ã«é‡è¦ã¨ãªã‚Šã¾ã™ã€‚

é–“æ¥çš„ãªæ‰€æœ‰æ¨©ã‚’æŒã¤ã‚¯ãƒ©ã‚¹ã«ãŠã‘ã‚‹ã€æ‰€æœ‰ã™ã‚‹ãƒ¡ãƒ³ãƒã®è»¢é€ã®ã‚µãƒ³ãƒ—ãƒ«

```cpp
struct fwd {
  std::unique_ptr<std::string> ptr;
  std::optional<std::string> opt;
  std::deque<std::string> container;

  auto get_ptr(this auto&& self) -> std::string {
    if (ptr) {
      return std::forward_like<decltype(self)>(*ptr);
    }
    return "";
  }

  auto get_opt(this auto&& self) -> std::string {
    if (opt) {
      return std::forward_like<decltype(self)>(*m);
    }
    return "";
  }

  auto operator[](this auto&& self, size_t i) -> std::string {
    return std::forward_like<decltype(self)>(container[i]); // dequeã¯å³è¾ºå€¤ç”¨[]ã‚’æŒãŸãªã„
  }
};
```

ã“ã®ä¾‹ã§ã¯ã€ãƒã‚¤ãƒ³ã‚¿ã‚’ä»‹ã—ãŸæ‰€æœ‰ãªã©ã«ã‚ˆã£ã¦`this`ã®`const`æ€§ãŠã‚ˆã³å€¤ã‚«ãƒ†ã‚´ãƒªã®ä¼æ’­ãŒæ–­ã¡åˆ‡ã‚‰ã‚Œã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ã§ã‚‚ã€Deducing Thisã¨`forward_like`ã«ã‚ˆã£ã¦æœ›ã¾ã—ã„è»¢é€ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

- [è‡ªå·±å†å¸°ã™ã‚‹ãƒ©ãƒ ãƒ€å¼ @ C++23 - yohhoyã®æ—¥è¨˜](https://yohhoy.hatenadiary.jp/entry/20211025/p1)
- [P0847R7 Deducing This](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p0847r7.html)
- [P2445 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1117)

### [P2447R0 std::span and the missing constructor](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2447r0.html)

`std::span`ã«`initializer_list`ã‚’å—ã‘å–ã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ç¾åœ¨ã®`std::span`ã«ã¯`std::initializer_list`ã‚’å—ã‘å–ã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒãªãã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚

```cpp
void foo(std::span<const int>);

int main() {
  foo({1, 2, 3}); // error
}
```

ã“ã®ææ¡ˆã¯`std::span`ã«ã¯`std::initializer_list`ã‚’å—ã‘å–ã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ ã—ã¦ã“ã‚ŒãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹ã‚ˆã†ã«ã—ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

ã“ã®ææ¡ˆã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€å¾“æ¥`std::vector`ã‚’åˆ©ç”¨ã—ã¦ã„ãŸé–¢æ•°å¼•æ•°ã‚’`std::span`ã«ç½®ãæ›ãˆãŸæ™‚ã«ç™ºç”Ÿã™ã‚‹å•é¡Œã‚’è§£æ±ºã™ã‚‹ã“ã¨ã«ã‚ã‚Šã¾ã™ã€‚

```cpp
// C++17ã¾ã§ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
void foo(const std::vector<int>&);

// C++20ã‹ã‚‰ã¯spanã‚’ä½¿ã„æ›¸ãæ›ãˆãŸã„
void foo(std::span<const int>);

int main() {
  foo({1, 2, 3}); // C++17ã¾ã§ã¯OKã€C++20ã‹ã‚‰ã¯ã‚¨ãƒ©ãƒ¼
}
```

ã“ã®å¤‰æ›´ãŒé©ç”¨ã•ã‚Œã‚‹ã¨`{}`ã«ã‚ˆã£ã¦ç°¡å˜ã«ãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°`std::span`ã‚’ä½œã‚Œã¦ã—ã¾ã†ã‚ˆã†ã«ãªã‚Šã¾ã™ãŒã€ç¾çŠ¶ã§ã‚‚ãƒ€ãƒ³ã‚°ãƒªãƒ³ã‚°`span`ã¯å‰²ã¨ç°¡å˜ã«ã§ãã¦ã—ã¾ã„ã€`std::span`ãŒ`view`ã§ã‚ã‚‹ä»¥ä¸Šãã‚Œã¯é¿ã‘ã‚‰ã‚Œãªã„ãŸã‚ã€`std::initializer_list`ã‚’å–ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã®ãƒ¡ãƒªãƒƒãƒˆã®æ–¹ãŒå¤§ãã„ã¨ã„ã†ä¸»å¼µã§ã™ã€‚

ã¾ãŸã€`std::initializer_list`ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã¯`{}`åˆæœŸåŒ–æ™‚ã«æœ€å„ªå…ˆã§é¸æŠã•ã‚Œã‚‹ã“ã¨ã‹ã‚‰ã€ã“ã®å¤‰æ›´ã¯ç ´å£Šçš„å¤‰æ›´ã¨ãªã‚Šã¾ã™ã€‚ã—ã‹ã—ã€`std::initializer_list`ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«åˆ¶ç´„ã‚’è¨­ã‘ã‚‹ã“ã¨ã§ã“ã®å½±éŸ¿ã¯ä½æ¸›ã§ãã€ç ´å£Šçš„ã¨ãªã‚‹ã®ã¯éå¸¸ã«ãƒ¬ã‚¢ã‚±ãƒ¼ã‚¹ã¨ãªã‚‹ã‚ˆã†ã§ã™ã€‚

```cpp
const std::vector<int>;

// ã“ã®å¤‰æ›´ã®å¾Œã§ã‚‚ã€ã“ã‚Œã‚‰ã®æŒ¯ã‚‹èˆã„ã¯å¤‰åŒ–ã—ãªã„
auto sp1 = std::span{v};
auto sp2 = std::span{v.begin(), v.end()};
auto begin = v.data();
auto end = begin + v.size();
auto sp3 = std::span{begin, end};

// ã“ã®ææ¡ˆä»¥å‰ã¯void*1ã¤ã®span
// ã“ã®ææ¡ˆã®å¾Œã§ã¯ã€void*2ã¤ã®span
void* vp = nullptr;
span<void* const> sp4{&vp, &vp+1};

// ã“ã®ææ¡ˆä»¥å‰ã¯any1ã¤ã®span
// ã“ã®ææ¡ˆã®å¾Œã§ã¯ã€any2ã¤ã®span
std::any a;
std::any* ap = &a;
span<std::any> sa{&ap, &ap+1};
```

`std::span`ã®ä¸»ãªç”¨é€”ã®ä¸€ã¤ã¯é–¢æ•°å¼•æ•°ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ã€‚ãã®å ´åˆã€`span`ã®è¦ç´ å‹ã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã™ã‚‹ã“ã¨ã¯ã§ããªã„ãŸã‚`span`ã®è¦ç´ å‹ã¯æ˜ç¤ºçš„ã«æŒ‡å®šã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚å¾“ã£ã¦ã€`void*`ãªã©ã®ç‰¹æ®Šãªè¦ç´ å‹ã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ã¯é€šå¸¸ãªã„ãŸã‚ã€ç ´å£Šçš„å¤‰æ›´ã¯ã‚„ã¯ã‚Šå•é¡Œã¨ãªã‚‰ãªã„ã¨ã®ã“ã¨ã§ã™ã€‚

- [P2447 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1118)

### [P2448R0 Relaxing some constexpr restrictions](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2448r0.html)

`constexpr`é–¢æ•°ãŒã™ã¹ã¦ã®å¼•æ•°ã«ã¤ã„ã¦å®šæ•°å®Ÿè¡Œä¸å¯èƒ½ã¨ãªã‚‹å ´åˆã§ã‚‚ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ã—ãªã„ã‚ˆã†ã«ã™ã‚‹ææ¡ˆã€‚

ä¾‹ãˆã°ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¯C++20ã¾ã§ã¯ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ãŒã€C++23ä»¥é™ï¼ˆ[P2231R1](https://wg21.link/p2231r1)å®Ÿè£…å¾Œï¼‰ã¯å®šæ•°å®Ÿè¡Œå¯èƒ½ã¨ãªã‚‹ãŸã‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã›ã‚“ã€‚

```cpp
constexpr void h(std::optional<int>& o) {
  o.reset();  // C++20ã¾ã§éconstexpr
}
```

ç¾åœ¨ã®ä»•æ§˜ã§ã¯ã€`constexpr`é–¢æ•°ãŒãã®ã‚ã‚‰ã‚†ã‚‹å¼•æ•°ã«ã¤ã„ã¦å®šæ•°å®Ÿè¡Œå¯èƒ½ã§ã¯ãªã„å ´åˆã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ï¼ˆã‚‚ã—ãã¯è¨ºæ–­ä¸è¦ã®ill-formedï¼‰ã¨ã™ã‚‹äº‹ãŒæ±‚ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€`constexpr`é–¢æ•°å†…ã§é`constexpr`é–¢æ•°ã‚’å‘¼ã³å‡ºã™å ´åˆã¯å¸¸ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã‚’é©å¿œçš„ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ãŸã‚ã€æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒã‚¯ãƒ­ã‚’ä½¿ç”¨ã—ã¦æ¬¡ã®ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™

```cpp
#if __cpp_lib_optional >= 202106
constexpr
#endif
void h(std::optional<int>& o) {
    o.reset();
}
```

ã—ã‹ã—ã€ã“ã®æ–¹æ³•ã¯é©åˆ‡ã§ã—ã‚‡ã†ã‹ï¼Ÿ

`std::optional`ã®ã“ã®ä¾‹ã«è¦‹ãˆã‚‹ã‚ˆã†ã«ã€ã‚ã‚‹é–¢æ•°ãŒã‚ã‚‹æ™‚ç‚¹ã§`constexpr`ã§ã¯ãªã‹ã£ãŸã¨ã—ã¦ã‚‚å°†æ¥çš„ã«`constexpr`ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚`constexpr`ã®ãƒ«ãƒ¼ãƒ«ã¯C++ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã”ã¨ã«æ‹¡å¼µã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãã‚Œã¾ã§`constexpr`å¯¾å¿œã§ããªã‹ã£ãŸå‡¦ç†ã§ã‚‚ã€ã‚ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‹ã‚‰ã¯`constexpr`åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šå¾—ã¾ã™ã€‚ã—ã‹ã—ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚µãƒãƒ¼ãƒˆã¯ãã‚ŒãŒå¯èƒ½ã«ãªã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‹ã‚‰é…ã‚Œã¦ãã‚Œã«å¯¾å¿œã—ã€åœ¨é‡ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã•ã‚‰ã«é…ã‚Œã‚‹ã®ãŒå¸¸ã§ã™ã€‚ã¾ãŸã“ã®ã‚ˆã†ãªæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒã‚¯ãƒ­ãŒéæ¨™æº–ã®ã‚‚ã®ã«ã¤ã„ã¦æä¾›ã•ã‚Œã‚‹ã“ã¨ã¯ã»ã¼ãªãã€åœ¨é‡ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ã“ã®ã‚ˆã†ãªå¯¾å¿œã¯æ‰‹ä½œæ¥­ã§è¡Œã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®ã‚ˆã†ãªè¨ºæ–­ã¯å®šæ•°å¼ã§å®Ÿè¡Œå¯èƒ½ãªã‚‚ã®ãŒå¤§ããåˆ¶é™ã•ã‚Œã¦ã„ãŸC++11ã®æ™‚ä»£ã«ã¯æœ‰ç”¨ã ã£ãŸã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚ˆã‚Šå¤šãã®ã‚‚ã®ãŒå®šæ•°å¼ã§å®Ÿè¡Œå¯èƒ½ã¨ãªã£ãŸç¾åœ¨ï¼ˆC++23ï¼‰ã®ç’°å¢ƒã«ã¯å³ã—ã¦ãŠã‚‰ãšã€`constexpr`ã§ã®å®Ÿè¡Œå¯å¦ã®è¨ºæ–­ã¯å®Ÿéš›ã«å®šæ•°å¼ã§å®Ÿè¡Œã™ã‚‹æ™‚ã«ã¾ã§é…å»¶ã—ã¦ãŠãæ–¹ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚ã“ã®ææ¡ˆã¯ã€ãã®ã‚ˆã†ãªè¦å®šã‚’å–ã‚Šé™¤ã“ã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

- [P2448 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1119)

### [P2451R0 2021 September Library Evolution Poll Outcomes](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2451r0.html)

2021å¹´ã®ç§‹ã«è¡Œã‚ã‚ŒãŸã€LEWGã®å…¨ä½“æŠ•ç¥¨ã®çµæœã€‚

ä»¥ä¸‹ã®5ã¤ã®ææ¡ˆãŒæŠ•ç¥¨ã«ã‹ã‘ã‚‰ã‚Œã€LWGã«è»¢é€ã•ã‚Œã‚‹ã“ã¨ãŒå¯æ±ºã•ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãã®éš›ã«å¯„ã›ã‚‰ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [P2418R0 Add Support For `std::generator`-like Types To `std::format`](https://wg21.link/)
- [P2415R1 What Is A view?](https://wg21.link/)
- [P2432R0 Fix istream_view](https://wg21.link/)
- [P2351R0 Mark All Library Static Cast Wrappers As `[[nodiscard]]`](https://wg21.link/)
- [P2291R2 Add Constexpr Modifiers To Functions `to_chars` And `from_chars` For Integral Types In `<charconv>` Header](https://wg21.link/)

### [P2460R0 Relax requirements on wchar_t to match existing practices](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2460r0.pdf)

`wchar_t`ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«ã¤ã„ã¦ã®å®Ÿæ…‹ã«ãªã˜ã¾ãªã„åˆ¶ç´„ã‚’å–ã‚Šé™¤ãææ¡ˆã€‚

ç¾åœ¨ã®C++æ¨™æº–ã«ãŠã‘ã‚‹`wchar_t`ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«é–¢ã™ã‚‹è¦å®šã¯ã€ãƒ¯ã‚¤ãƒ‰æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®ã™ã¹ã¦ã®æ–‡å­—ã‚’å˜ä¸€ã®ã‚³ãƒ¼ãƒ‰å˜ä½ã¨ã—ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆã™ãªã‚ã¡ã€ã™ã¹ã¦ã®æ–‡å­—ãŒ`wchar_t`1ã¤ã«åã¾ã‚‰ãªã‘ã‚Œã°ãªã‚‰ãªã„ï¼‰ã“ã¨ã‚’è¦æ±‚ã—ã¦ã„ã¾ã™ã€‚ä¾‹ãˆã°Windowsã§ã¯ãã‚Œã¯UTF-16ã§ã‚ã‚Šã€UTF-16ã¯ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒšã‚¢ã‚’æŒã¤ãŸã‚ãã®è¦ä»¶ã«é•åã—ã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã•ã‚‰ã«ã€`wchar_t`ã®å€¤ã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ­ã‚±ãƒ¼ãƒ«ã§æŒ‡å®šã•ã‚ŒãŸæ‹¡å¼µæ–‡å­—ã‚»ãƒƒãƒˆã®å€‹åˆ¥ã®æ–‡å­—ã‚’è¡¨ç¾ã§ãã‚‹ã“ã¨ã‚‚è¦æ±‚ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€å®Ÿè¡Œå­—æ–‡å­—é›†å·ãŒUTF-8ã®å ´åˆã¯ã™ã¹ã¦ã®ãƒ¦ãƒ‹ã‚³ãƒ¼ãƒ‰æ–‡å­—ã‚’`wchar_t`1ã¤ã§è¡¨ç¾å¯èƒ½ã§ã‚ã‚‹ã“ã¨ãŒæ±‚ã‚ã‚‰ã‚Œã€å®Ÿè³ªçš„ã«2ãƒã‚¤ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ’é™¤ã—ã¦ã„ã¾ã™ã€‚

ã“ã‚Œã‚‰ã®ã“ã¨ã¯å®Ÿéš›ã®å®Ÿè£…ï¼ˆä¸»ã«Windowsï¼‰ã«æ²¿ã£ã¦ãŠã‚‰ãšã€C++ã‚’å¤šæ§˜ãªOSä¸Šã§ã®é–‹ç™ºã«é©ã•ãªã„ã‚‚ã®ã«ã—ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€å®Ÿè£…ã®æ…£è¡Œã«å¾“ã†å½¢ã§ã“ã‚Œã‚’ä¿®æ­£ã™ã‚‹ã®ãŒã“ã®ææ¡ˆã®ç›®çš„ã§ã™ã€‚

ã“ã®ææ¡ˆã«ã‚ˆã‚‹å¤‰æ›´ã¯å®Ÿè£…ã§ã™ã§ã«è¡Œã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¨™æº–åŒ–ã™ã‚‹ã ã‘ãªã®ã§ã€å®Ÿè£…åŠã³ãƒ—ãƒ­ã‚°ãƒ©ãƒã«å½±éŸ¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

- [P2460 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1122)

### [P2461R0 Closure-based Syntax for Contracts](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2461r0.pdf)

å±æ€§likeãªæ§‹æ–‡ã«ä»£ã‚ã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆæ§‹æ–‡ã®ææ¡ˆã€‚

ææ¡ˆã•ã‚Œã¦ã„ã‚‹æ§‹æ–‡ã¯`pre, post, assert`ã®3ã¤ã®æ–‡è„ˆä¾å­˜ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ç¶šã„ã¦ã€ãƒ©ãƒ ãƒ€å¼ï¼ˆã«è¿‘ã„æ§‹æ–‡ï¼‰ã«ã‚ˆã£ã¦å¥‘ç´„æ¡ä»¶ã‚’è¨˜è¿°ã—ã¾ã™ã€‚`pre/post`ã¯å¾Œç½®æˆ»ã‚Šå€¤å‹ã®å¾Œã‚ã®`requires`ç¯€ã¨åŒã˜ä½ç½®ã«æ›¸ãã€`assert`ã¯é–¢æ•°æœ¬ä½“å†…ã«æ›¸ãã¾ã™ã€‚

```cpp
auto plus(auto const x, auto const y) -> decltype(x + y)
  pre { x > 0 }
  pre {
    // ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã®ãƒã‚§ãƒƒã‚¯
    // ã“ã“ã«æ›¸ã‘ã‚‹ã‚‚ã®ã¯æ¡ä»¶å¼ã ã‘ãªã®ã§ã€&&ã§çµåˆã™ã‚‹
    (x > 0 && y > 0 ? as_unsigned(x) + as_unsigned(y) > as_unsigned(x) : true) &&
    (x < 0 && y < 0 ? as_unsigned(x) + as_unsigned(y) < as_unsigned(x) : true)
  }
  // retã¯auto&&ã¨å®£è¨€ã—ãŸã‹ã®ã‚ˆã†ãªå¼•æ•°ã€æˆ»ã‚Šå€¤ãŒæ¸¡ã•ã‚Œã‚‹
  post (ret) { ret == (x + y) }
{
  assert { x > 0 }; // ã“ã®æ§‹æ–‡ã¯ç¾åœ¨æœ‰åŠ¹ï¼ˆassertæ§‹é€ ä½“ã®é›†æˆä½“åˆæœŸåŒ–ï¼‰
  auto cx = x;
  return cx += y;
}
```

ãŸã ã—ã€ã“ã®ææ¡ˆã¯ç´”ç²‹ã«æ§‹æ–‡ã®ã¿ã‚’ææ¡ˆã™ã‚‹ã‚‚ã®ã§ã€P2388ã®æ„å‘³è«–ã‚’ã»ã¼è¸è¥²ã—ã¦ãŠã‚Šã€P2388ãŠã‚ˆã³MVPï¼ˆ*Minimum Viable Product*ï¼‰ã¨å‘¼ã°ã‚Œã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æœ€å°ã‚»ãƒƒãƒˆã«ç•°ã‚’å”±ãˆã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ææ¡ˆã¯ã€P2388ã§ç¤ºã•ã‚Œã¦ã„ã‚‹ã„ãã¤ã‹ã®å•é¡Œã‚’è§£æ±ºå¯èƒ½ãªæ§‹æ–‡ã‚’æ¢ç´¢ã—ã€ææ¡ˆã™ã‚‹ã‚‚ã®ã§ã™ã€‚

æ§‹æ–‡å®šç¾©ã¯æ¬¡ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™

```ebnf
correctness-specifier:
    correctness-specifier-keyword correctness-specifier-introducer(opt) correctness-specifier-body

correctess-specifier-keyword:
    pre | post | assert

correctness-specifier-introducer:
    lambda-introducer(opt) return-value-id(opt)

return-value-decl:
    ( identifier )

correctness-specifier-body:
    { conditional_expression }
```

`pre, post, assert`ã®å¾Œã«ã¯ãƒ©ãƒ ãƒ€å¼ï¼ˆã®ã‚ˆã†ãªï¼‰æ§‹æ–‡ã‚’ç½®ãã“ã¨ãŒã§ãã¦ã€ãƒ©ãƒ ãƒ€ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚‚æ©Ÿèƒ½ã—ã¾ã™ã€‚çœç•¥ã•ã‚ŒãŸå ´åˆã¯`[&]`ã‹ã‚‰å§‹ã¾ã£ãŸã‚‚ã®ã¨ã¿ãªã•ã‚Œã¦ã„ã¾ã™ã€‚ãŸã ã—ã€ç¾åœ¨åˆæ„ãŒå–ã‚Œã¦ã„ã‚‹MVPã¨å‘¼ã°ã‚Œã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æœ€å°ã‚»ãƒƒãƒˆã«å¾“ã†å ´åˆã€ãƒ©ãƒ ãƒ€å°å…¥å­ã¯å¸¸ã«çœç•¥ã•ã‚Œãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
`correctess-specifier-keyword`ã«ç¶šã`{}`ã®ä¸­ã«ã¯æ¡ä»¶å¼ã®ã¿ã‚’æ›¸ãã“ã¨ãŒã§ãã¦ã€ã“ã‚Œã¯`requires`ç¯€ã¨åŒã˜ã§ã™ã€‚

ãƒ©ãƒ ãƒ€å°å…¥å­ã‚’è¨±å¯ã—ãªã‹ã£ãŸã¨ã—ã¦ã‚‚ã€ã“ã®æ§‹æ–‡ã§ã¯P2388ã§å°å…¥ã•ã‚Œã‚‹æœªå®šç¾©å‹•ä½œã‚’æ¸›ã‚‰ã™ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã§ã™ã€‚

ãƒ©ãƒ ãƒ€å°å…¥å­ã‚’è¨±å¯ã™ã‚‹ã¨ã€ã‚³ãƒ”ãƒ¼ã‚­ãƒ£ãƒ—ãƒãƒ£ã«ã‚ˆã£ã¦P2388ã«å­˜åœ¨ã™ã‚‹äº‹å¾Œæ¡ä»¶ã§é`const`å¼•æ•°ã‚’å‚ç…§ã§ããªã„ã¨ã„ã†å•é¡Œã‚’è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯äº‹å¾Œæ¡ä»¶ã‹ã‚‰å‚ç…§ã•ã‚Œã‚‹å®Ÿå¼•æ•°ãŒã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã‚ˆã£ã¦å¤‰åŒ–ã—ã†ã‚‹ã“ã¨ã§æ¡ä»¶ã®æ„å‘³ãŒå¤‰ã‚ã£ã¦ã—ã¾ã†ã“ã¨ã‚’é˜²æ­¢ã™ã‚‹ãŸã‚ã«ç¾åœ¨ï¼ˆMVPï¼‰ã§ã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚

- [P2388R0 Abort-only contract support - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´05æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/07/12/182757#P2388R0-Abort-only-contract-support)
- [P2388R2 Minimum Contract Support: either Ignore or Check_and_abort - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´09æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/10/03/193523#P2388R2-Minimum-Contract-Support-either-Ignore-or-Check_and_abort)
- [P2461 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1123)

### [P2463R0 Slides for P2444r0 The Asio asynchronous model](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2463r0.pdf)

[P2444](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2444r0.pdf)ã®è§£èª¬ã‚¹ãƒ©ã‚¤ãƒ‰ã€‚

ASIOã®éåŒæœŸãƒ¢ãƒ‡ãƒ«ã¨Executorã€éåŒæœŸå‡¦ç†ã‚°ãƒ©ãƒ•ã®æ§‹æˆãªã©ãŒä½œè€…è‡ªã‚‰ã«ã‚ˆã£ã¦è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚

### [P2464R0 Ruminations on networking and executors](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2464r0.html)

P0443ã®Executorã‚’ä½¿ç”¨ã™ã‚‹Networking TSã‚’æ¨™æº–åŒ–ã™ã¹ãã§ã¯ãªã„ã¨ã„ã†ææ¡ˆã€‚

ã“ã®ææ¡ˆã§å•é¡Œã¨ã•ã‚Œã¦ã„ã‚‹ã®ã¯Networking TSã®å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ãŒExecutorãã®ã‚‚ã®ãŒã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã•ãªã„ã¨ä»®å®šã—ã¦ã„ã‚‹äº‹ã€ãŠã‚ˆã³P0443ã®`executor`ã«ã‚¨ãƒ©ãƒ¼ã‚„å‡¦ç†ã®æˆå¦ã‚’é€šçŸ¥ã™ã‚‹ãƒãƒ£ãƒãƒ«ãŒç„¡ã„ã“ã¨ã€Networking TSã®Executorã¨å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã«ã‚ˆã‚‹éåŒæœŸãƒ¢ãƒ‡ãƒ«ã¯`sender/reciever`ã¨æ¯”è¼ƒã™ã‚‹ã¨ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã§ã‚‚æ§‹æˆå¯èƒ½ã§ã‚‚ç„¡ã„ã“ã¨ã§ã™ã€‚

Networking TSï¼ˆASIOï¼‰ã®éåŒæœŸå‡¦ç†ã§ã¯I/Oå‡¦ç†ã®ç¶™ç¶šä½œæ¥­ã‚’å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã§è¡Œã„ã¾ã™ã€‚å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã§ã¯Associated Executorã‚’å–å¾—ã—åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ãã®I/Oå‡¦ç†ã‚„å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã®å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ç¶™ç¶šä½œæ¥­ã‚’æŠ•å…¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®Associated Executorã¯P0443ã®`executor`ã§ã¯ã‚ã‚Šã¾ã™ãŒ`scheduler`ã§ã¯ãªãã€å‡¦ç†ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã«ä¼´ã†ã‚¨ãƒ©ãƒ¼ã‚„ã€å…ˆè¡Œã™ã‚‹å‡¦ç†ã®å¤±æ•—ã‚’ç¶™ç¶šå‡¦ç†ã«é€šçŸ¥ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãã—ã¦ã€Associated Schedulerã®ã‚ˆã†ãªã‚‚ã®ã‚’å–å¾—ã™ã‚‹APIã¯ãªãã€éåŒæœŸå‡¦ç†ã‚°ãƒ©ãƒ–ã®æ§‹æˆã‚‚ãã®å ´ã—ã®ãçš„ãªæ›¸ãæ–¹ã—ã‹ã§ãã¾ã›ã‚“ã€‚ã¾ãŸã€å®Ÿè¡Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’Associated Executorä»¥å¤–ã®Executorã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›´ã™ã‚‹æ–¹æ³•ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚

Executorãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å°å…¥å¾Œã€å¹¾ã¤ã‚‚ã®ExecutorãŒä½œæˆã•ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã€ãã“ã§ã¯Executorã®è¡¨ç¾åŠ›ä¸è¶³ã«ä¼´ã†å•é¡Œã‚’è§£æ±ºã™ã‚‹äº‹ã‚’ç¹°ã‚Šè¿”ã—è¡Œã†å¿…è¦ãŒå‡ºã¦ãã¾ã™ã€‚Executorã¯ãƒ¯ãƒ¼ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã®æŠ½è±¡åŒ–ã§ã—ã‹ãªãã€æ±ç”¨çš„ãªã‚¨ãƒ©ãƒ¼å‡¦ç†/æ¤œå‡ºã®æ–¹æ³•ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¾“ã£ã¦ã€Networking TSã®ãŠã‚ˆã³P0443ã®`executor`ã¨ã¯ã€`scheduler`ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚`scheduler`ã¯`executor`ã¨åŒç­‰ã®èƒ½åŠ›ã‚’æŒã¡ãªãŒã‚‰ã€`reciever`ã«ã‚ˆã‚‹æˆå¦ã¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ã®é€šçŸ¥ãƒãƒ£ãƒãƒ«ã€`sender`ã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†ã‚°ãƒ©ãƒ•ã®ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ãªæ§‹æˆã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

ãã®å ´åˆã€Networking TSã®éåŒæœŸå‡¦ç†ã¯å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã®ä»£ã‚ã‚Šã«`sender`ã‚’å—ã‘å–ã‚‹ã‚ˆã†ã«ãªã‚‹ã§ã—ã‚‡ã†ã€‚`sender`ã¯ã‚ã‚‰ã‹ã˜ã‚æ§‹æˆã•ã‚ŒãŸéåŒæœŸå‡¦ç†ã®ã‚°ãƒ©ãƒ•ã‚’ç¤ºã™éåŒæœŸã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã‚ã‚Šã€Networking TSã‹ã‚‰æä¾›ã•ã‚Œã‚‹`scheduler`ã‚’ãã®ã¾ã¾ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã€åˆ¥ã®`scheduler`ã«å®Ÿè¡Œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¹ã‚¤ãƒƒãƒã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ã•ã‚‰ã«ã€`sender`ã«ã‚ˆã‚‹æ§‹æˆã§ã¯ã€å‰ã®å‡¦ç†ãŠã‚ˆã³ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ®µéšã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã‚‹å ´åˆå¾Œç¶šã®å‡¦ç†ã¯å®Ÿè¡Œã•ã‚Œãšã€ãã®ã‚¨ãƒ©ãƒ¼ã‚’ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã™ã‚‹æ–¹æ³•ãŒæä¾›ã•ã‚Œã¾ã™ã€‚ãã—ã¦ã€ãã‚Œã‚‰ã®å‡¦ç†ã¯ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã«æ§‹æˆã™ã‚‹ã“ã¨ãŒã§ãã€ç‰¹å®šã®`scheduler`ãŠã‚ˆã³ç‰¹å®šã®ç¶™ç¶šæ“ä½œã«ä¾å­˜ã›ãšã€å®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã®ã‚ˆã†ã«ã‚¢ãƒ‰ãƒ›ãƒƒã‚¯çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```cpp
// æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹éåŒæœŸI/Oã¨ç¶™ç¶šã®ä¾‹
void run_that_io_operation(scheduler auto sched,
                           sender_of<network_buffer> auto wrapping_continuation)
{
  // ç‰¹å®šã®I/Oæ“ä½œ
  launch_our_io();
  // I/Oçµæœã®å–å¾—
  auto [buffer, status] = fetch_io_results_somehow(maybe_asynchronously);
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŒ‡å®šã—ãŸç¶™ç¶šã‚’ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æŒ‡å®šã—ãŸschedulerã§å®Ÿè¡Œã™ã‚‹
  run_on(sched, queue_onto(wrapping_continuation,
                           make_it_queueable(buffer, status)));
}
```

ã“ã“ã§ã¯ã€`scheduler`ã®å…·ä½“çš„ãªå‹ã‚‚`sender`ï¼ˆ`wrapping_continuation`ï¼‰ã®å…·ä½“çš„ãªå‹ã‚‚çŸ¥ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®é–¢æ•°ã®ä½œè€…ãŒè©³ã—ãçŸ¥ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã¯I/Oæ“ä½œã«é–¢ã™ã‚‹ã“ã¨ã®ã¿ã§ã™ã€‚ç¶™ç¶šãƒ©ãƒƒãƒ‘ï¼ˆ`wrapping_continuation`ï¼‰ãŒä½•ã‚’ã™ã‚‹ã‹ã‚‚çŸ¥ã‚‹å¿…è¦ãŒãªãã€ãã‚ŒãŠã‚ˆã³ãã‚ŒãŒã©ã“ã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ã‹ã‚’æ±ºã‚ã‚‹ã®ã¯ã“ã®é–¢æ•°ã‚’åˆ©ç”¨ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ã™ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯`sender`ã®å…ˆã«è‡ªç”±ã«ç¶™ç¶šã‚’æ§‹æˆã§ãã€ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ©ãƒƒãƒ—ã—ãŸå‡¦ç†ã‚’ä½¿ç”¨ã™ã‚‹åˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚‚ã¾ãŸåŒæ§˜ã®æ–¹æ³•ã«ã‚ˆã£ã¦ç¶™ç¶šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®é–¢æ•°ã®ä½œè€…ã¯ä¸Šä½ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½•ã‚’ã—ãŸã®ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãªãI/Oå‡¦ç†ã‚’å®Ÿè¡Œã—ã€`scheduler`ã«`sender`ã‚’æŠ•å…¥ã§ãã€ä¸Šä½ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯I/OãŒä½•ã‚’ã—ãŸã®ã‹ç¶™ç¶šã‚’ã©ã†å®Ÿè¡Œã—ãŸã®ã‹ã‚’çŸ¥ã‚‹ã“ã¨ãªãã€ãã®çµæœã‹ã‚‰å¤‰æ›ã•ã‚ŒãŸæŒ‡å®šã—ãŸç¶™ç¶šã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å¤šæ•°ã®å®Ÿè¡Œæˆ¦ç•¥ï¼ˆ`executor/scheduler`ï¼‰ã¨ã•ã‚‰ã«å¤šæ•°ã®ç¶™ç¶šï¼ˆå®Œäº†ãƒãƒ³ãƒ‰ãƒ©ã‚„`sender`ï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ã€Networking TSã¯å¤šæ•°ã®ã‚‚ã®ï¼ˆè¿½åŠ ã®é–¢æ•°ã®å¤‰ç¨®ï¼‰ã‚’å¿…è¦ã¨ã—ã¾ã™ãŒP2300ï¼ˆ`sender/reciever`ï¼‰ã§ã¯1ã¤ã ã‘ã§ã™ã¿ã¾ã™ã€‚

P0443ã®`executor`ã¯ã“ã‚ŒãŒã§ãã¾ã›ã‚“ã€‚`executor`ã¯ã‚ã‚‰ã‚†ã‚‹ç¨®é¡ã®å¤±æ•—ã‚„ã‚¨ãƒ©ãƒ¼ã‚’é€šçŸ¥ã™ã‚‹æ–¹æ³•ã‚’æŒã¡ã¾ã›ã‚“ã€‚ãã—ã¦ã€Networking TSã§ã®å…¥åŠ›å®Ÿè¡Œæˆ¦ç•¥ã¯`executor`ã®ã¿ã§ã™ã€‚

ã“ã®ææ¡ˆãŒç¤ºã—ã¦ã„ã‚‹ã®ã¯æ¬¡ã®2ã¤ã®æ–¹å‘æ€§ã§ã™ã€‚

1. Networking TSã®Executorãƒ¢ãƒ‡ãƒ«ã‚’P0443ã‹ã‚‰P2300ã¸å¤‰æ›´ã™ã‚‹
2. C++23 Networking TSã®æ¨™æº–åŒ–ã‚ˆã‚Šã‚‚ã€`sender/reciever`ï¼ˆP2300ï¼‰ã®é–‹ç™ºã«é›†ä¸­ã™ã‚‹
    - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ãã®å®Œæˆå¾Œã«ãã‚Œã«ãƒ•ã‚£ãƒƒãƒˆã™ã‚‹ã‚‚ã®ã‚’æ¨™æº–åŒ–ã™ã‚‹

ç­†è€…ã®æ–¹ã¯2ã¤ç›®ã‚’æ¨ã—ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

- [P2235R0 Disentangling schedulers and executors - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2020å¹´10æœˆï¼‰](https://onihusube.hatenablog.com/entry/2020/11/02/221657#P2235R0-Disentangling-schedulers-and-executors)
- [P2461 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1123)

### [P2465R0 Standard Library Modules std and std.all](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2465r0.pdf)

â†“

### [P2465R1 Standard Library Modules std and std.compat](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2465r1.pdf)

æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ã¤ã„ã¦æœ€å°ã®ã‚µãƒãƒ¼ãƒˆã‚’C++23ã«è¿½åŠ ã™ã‚‹ææ¡ˆ

ã“ã‚Œã¯ä»¥å‰ã®P2412R0ã‚’å—ã‘ã¦ã€å…·ä½“çš„ã«ãã®å†…å®¹ã‚’è©°ã‚ã‚‹ã‚‚ã®ã§ã™ã€‚

- [P2412R0 Minimal module support for the standard library - WG21æœˆæ¬¡ææ¡ˆæ–‡æ›¸ã‚’çœºã‚ã‚‹ï¼ˆ2021å¹´07æœˆï¼‰](https://onihusube.hatenablog.com/entry/2021/08/14/213339#P2412R0-Minimal-module-support-for-the-standard-library)


P2412R0ã®LEWGã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«ãŠã„ã¦å•é¡Œã¨ãªã£ãŸæœ€å¤§ã®äº‹é …ã¯ã€`import std;`ï¼ˆ`std`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰ãŒ`std`åå‰ç©ºé–“ã§ã¯ãªãã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã«ã‚ã‚‹ã‚‚ã®ã‚’å«ã‚€ã‹ã©ã†ã‹ã¨ã„ã†ç‚¹ã§ã—ãŸã€‚ç¾åœ¨ã®C++æ¨™æº–ã§ã¯ã€`<meow.h>`ã¯`::meow`ã‚’ç¢ºå®Ÿã«æä¾›ã—`std::meow`ã‚’æä¾›ã™ã‚‹ã‹ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ã€`<cmeow>`ã¯`::meow`ã¨`std::meow`ã®ä¸¡æ–¹ã‚’ç¢ºå®Ÿã«æä¾›ã—ã¾ã™ã€‚ã“ã‚Œã¯èª¬æ˜ã‚‚å¯¾å‡¦ã‚‚å„ä»‹ãªå•é¡Œã§ã‚ã‚Šã€ã¾ãŸã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã®æš—é»™ã®æ±šæŸ“ã‚’ã‚‚ãŸã‚‰ã—ã¾ã™ã€‚æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹å”¯ä¸€ã®æ©Ÿä¼šã ã¨è¨€ãˆã¾ã™ã€‚

ãŸã ã€`std`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã«ã‚ã‚‹ã‚‚ã®ã‚’æä¾›ã—ãªã„å ´åˆã€æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã®æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å¯¾å¿œãŒå¦¨ã’ã‚‰ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

ãã“ã§ã“ã®ææ¡ˆã§ã¯ã€2ã¤ã®æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æä¾›ã™ã‚‹ã“ã¨ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é¸æŠè‚¢ã‚’ä¸ãˆã€ã“ã®å•é¡Œã«å¯¾å‡¦ã—ã¾ã™ã€‚

- `import std;`
    - C++æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å…¨ã¦ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚ã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã‚’æ¸…æ½”ã«ä¿ã¡ãŸã„å ´åˆ
- `import std.compat;`
    - `std`+Cãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ˜ãƒƒãƒ€ã®éƒ¨åˆ†ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€‚Cç”±æ¥ã®ã‚‚ã®ãŒã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ã€‚æ—¢å­˜ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®ç§»è¡Œæ™‚ãªã©
    - `import std;`ã‚ˆã‚Šã‚‚é‡ããªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŒã€Cäº’æ›ãƒ˜ãƒƒãƒ€ã¯ã‚µã‚¤ã‚ºãŒå°ã•ã„ãŸã‚ãã“ã¾ã§å•é¡Œã«ãªã‚‰ãªã„ã¯ãš

`std`ã¨`std.compat`ã®é•ã„ã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã«ä½•ã‹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‹ã©ã†ã‹ã ã‘ã§ã™ã€‚`std`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä½¿ç”¨æ™‚ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã¯æ¸…æµ„ã«ä¿ãŸã‚Œã¾ã™ã€‚ä¾‹ãˆã°ã€`<cmath>`ã¯`std`åå‰ç©ºé–“ã«ã‚‚ã‚°ãƒ­ãƒ¼ãƒãƒ«åå‰ç©ºé–“ã«ã‚‚ã»ã¼åŒã˜ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ãŒå®šç¾©ã•ã‚Œã¾ã™ãŒã€`import std;`ã®å ´åˆã¯`std::~`ã ã‘ãŒä½¿ç”¨å¯èƒ½ã¨ãªã‚Šã€`import std.compat;`ã®æ™‚ã¯ãã‚Œã«åŠ ãˆã¦`::~`ã®ã‚‚ã®ã‚‚ä½¿ç”¨å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

ã“ã®ææ¡ˆã¯ç¾åœ¨ã®å†…å®¹ã§LWGã«è»¢é€ã™ã‚‹ãŸã‚ã«ã€æ¬¡ã®LEWGå…¨ä½“æŠ•ç¥¨ã«ã‹ã‘ã‚‰ã‚Œã¾ã™ã€‚

- [P2465 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1115)

### [P2466R0 The notes on contract annotations](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2466r0.html)

C++å¥‘ç´„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ãƒ“ã‚¸ãƒ§ãƒ³ã¨è¨­è¨ˆç›®æ¨™ã«ã¤ã„ã¦è§£èª¬ã—ãŸæ–‡æ›¸ã€‚

é–¢æ•°ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆï¼ˆ*function contract*ï¼‰ã¨ã„ã†æ¦‚å¿µã¨ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆæ³¨é‡ˆï¼ˆ*contract annotation*ï¼‰ã®é–¢ä¿‚ã‚’èª¬æ˜ã—ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆæ³¨é‡ˆã«æ±‚ã‚ã‚‰ã‚Œã‚‹ã“ã¨ã‚„å½¹å‰²ã«ã¤ã„ã¦èª¬æ˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€äº‹å¾Œæ¡ä»¶ã§é–¢æ•°ã®éå‚ç…§`const`å¼•æ•°ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã®å•é¡Œç‚¹ã¨è§£æ±ºç­–ã®è€ƒå¯ŸãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚

### [P2468R0 The Equality Operator You Are Looking For](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2468r0.html)

`==`ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹`!=`æ¼”ç®—å­ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©`!=`æ¼”ç®—å­ãŒè¡çªã—ã¦ã—ã¾ã†ã®ã‚’è§£æ¶ˆã™ã‚‹ææ¡ˆã€‚

æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã£ã¦æ‰±ã„ãŒå¤‰åŒ–ã—ã¾ã™ã€‚

```cpp
struct S {
  bool operator==(const S&) { return true; }  // (1) éconstãƒ¡ãƒ³ãƒé–¢æ•°
  bool operator!=(const S&) { return false; } // (2) éconstãƒ¡ãƒ³ãƒé–¢æ•°
};

int main() {
  bool b = S{} != S{};  // #1
}
```

#1ã®ç®‡æ‰€ã§ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©`!=`(2)ã¨(1)ã‹ã‚‰å°å‡ºã•ã‚ŒãŸ`!=`ã®2ã¤ãŒå€™è£œã¨ã—ã¦ä¸ŠãŒã‚Šã¾ã™ã€‚`S`ã®å³è¾ºå€¤ã¨ã®æ¯”è¼ƒã§ãƒ™ã‚¹ãƒˆãƒãƒƒãƒã‚‚ã®ã¯ãªã„ã®ã§`S`ã®å€¤ã¸ã®å¤‰æ›ãŒã©ã¡ã‚‰ã§ã‚‚è¡Œã‚ã‚Œã€ãƒ¡ãƒ³ãƒé–¢æ•°ã®`const`ä¿®é£¾ãŒãªã•ã‚Œã¦ã„ãªã„ã“ã¨ã«ã‚ˆã£ã¦ã©ã¡ã‚‰ã®å€™è£œã‚‚æœ€é©ã¨ã¿ãªã•ã‚Œã€ãã®æ‰±ã„ãŒã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã£ã¦å¤‰åŒ–ã—ã¦ã„ã¾ã™ã€‚

- GCC : (1)ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆè­¦å‘Šãªã—ï¼‰
    - å¤‰æ›ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã®å‰ã«ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‹ãŒä¸€è‡´ã™ã‚‹è¤‡æ•°ã®å€™è£œãŒã‚ã‚‹å ´åˆã«ç”Ÿæˆã•ã‚ŒãŸå€™è£œã‚’ç„¡è¦–ã™ã‚‹
- clang : (1)ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆè­¦å‘Šã‚ã‚Šï¼‰
- MSVC : (1)ã‚’ä½¿ç”¨ã™ã‚‹ï¼ˆè­¦å‘Šãªã—ï¼‰
    - ç”Ÿæˆã•ã‚ŒãŸå€™è£œã‚’å‰Šé™¤ã™ã‚‹

[godbolt](https://godbolt.org/z/796sz3Mhj)

ç¾åœ¨ã®æ¯”è¼ƒæ¼”ç®—å­ï¼ˆ`a @ b`ï¼‰ã®è‡ªå‹•å°å‡ºã«ä¼´ã†ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰è§£æ±ºã®ãƒ«ãƒ¼ãƒ«ã§ã¯ã€`@`ãã®ã‚‚ã®->ç”Ÿæˆã•ã‚ŒãŸæ­£é †ã®å¼ï¼ˆ`a @' b`ï¼‰->ç”Ÿæˆã•ã‚ŒãŸé€†é †ã®å¼ï¼ˆ`b @' a`ï¼‰ã®é †ã§å„ªå…ˆé †ä½ãŒé«˜ããªã‚‹ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚‹ã®ã§ã™ãŒã€ã“ã®ã‚±ãƒ¼ã‚¹ï¼ˆ`@`ã¯`!=`ï¼‰ã§ã¯å¤‰æ›ãªã—ã§ãƒ™ã‚¹ãƒˆãƒãƒƒãƒã™ã‚‹`!=`ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¨ç”Ÿæˆã•ã‚ŒãŸã‚‚ã®ã¨ã§å„ªå…ˆé †ä½ãŒåŒç­‰ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‹ã‚‰è¦‹ã‚‹ã¨å…ˆã»ã©ã®ä¾‹ã¯ã€æ¬¡ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¨åŒã˜ã“ã¨ã‚’ã—ã¦ã„ã¾ã™

```cpp
struct S {
  friend bool f(S, const S&) { ... }
  friend bool f(const S&, S) { ... }
};
bool b = f(S{}, S{});
```

ã“ã®ææ¡ˆã§ã¯ã€ç¾åœ¨ã®å³æ ¼ãªãƒ«ãƒ¼ãƒ«ã‚’MSVCã«ã¦å®Ÿè£…ï¼ˆå‡ºè·ã•ã‚Œã¦ã„ã‚‹MSVCã®å®Ÿè£…ã¨ã¯ç•°ãªã‚‹ï¼‰ã—ã€59ã®ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®èª¿æŸ»ã‚’è¡Œãªã£ã¦ã„ã¾ã™ã€‚ãã®çµæœã€20ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã“ã®å•é¡Œã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸã€‚

```cpp
template <typename T>
struct Base {
  bool operator==(const T&) const;
};

struct Derived : Base<Derived> { };

bool b = Derived{} == Derived{};
```

ã“ã®ã‚±ãƒ¼ã‚¹ã§ã¯ã€æ´¾ç”Ÿã‚¯ãƒ©ã‚¹ã‹ã‚‰åŸºåº•ã‚¯ãƒ©ã‚¹ã¸ã®å¤‰æ›ãŒç™ºç”Ÿã—ã€åŒæ§˜ã®å•é¡Œã«é™¥ã£ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã¹ãã§ã™ã€‚

```cpp
template <bool>
struct GenericIterator {
  using ConstIterator = GenericIterator<true>;
  using NonConstIterator = GenericIterator<false>;

  GenericIterator() = default;
  GenericIterator(const NonConstIterator&); // (1)

  bool operator==(ConstIterator) const;
};
using Iterator = GenericIterator<false>;

bool b = Iterator{} == Iterator{};
```

ã“ã®ã‚±ãƒ¼ã‚¹ã¯ã€`Iterator`ï¼ˆ`GenericIterator<false>`ï¼‰ã®æ¯”è¼ƒã‚’æš—é»™å¤‰æ›ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿(1)ã‚’é€šã™ã“ã¨ã«ã‚ˆã£ã¦ã€`ConstIterator`ï¼ˆ`GenericIterator<true>`ï¼‰ã®æ¯”è¼ƒã¨ã—ã¦å®Ÿè¡Œã—ã¦ã„ã¾ã™ã€‚æš—é»™å¤‰æ›ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ã«ã‚ˆã£ã¦åŒæ§˜ã®å•é¡ŒãŒèµ·ãã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯æ„å›³çš„ã§ã‚ã‚‹ã®ã§å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã¹ãã§ã™ã€‚

```cpp
struct Iterator {
  Iterator();
  Iterator(int*);

  bool operator==(const Iterator&) const; // (1)
  operator int*() const;  // (2)
};

bool b = nullptr != Iterator{};
```

ã“ã®ã‚±ãƒ¼ã‚¹ã¯ã€(2)ã«ã‚ˆã£ã¦`Iterator`ã‹ã‚‰ãƒã‚¤ãƒ³ã‚¿ã¸æš—é»™å¤‰æ›ã™ã‚‹ã“ã¨ã§ã€`!=`ã‚’æä¾›ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚æš—é»™å¤‰æ›ãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ã«ã‚ˆã£ã¦åŒæ§˜ã®å•é¡ŒãŒèµ·ãã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã“ã®å ´åˆã€é€†é †ã®`==`ä½¿ç”¨æ™‚ã«ã‚‚æš—é»™å¤‰æ›ã«ã‚ˆã£ã¦çµ„ã¿è¾¼ã¿`==`ãŒä½¿ç”¨ã•ã‚Œã¦ã—ã¾ã„ã€ã‚ˆã‚Šæœ€é©ãªã¯ãšã®`nullptr`ã‹ã‚‰`Iterator`ã‚’æ§‹ç¯‰ã—ã¦`==`(1)ãŒä½¿ç”¨ã•ã‚Œãªã„ã¨ã„ã†å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ã‚±ãƒ¼ã‚¹ã¯ãƒªã‚¸ã‚§ã‚¯ãƒˆã•ã‚Œã‚‹ã¹ãã§ã™ã€‚

```cpp
using ubool = unsigned char;

struct S {
  operator bool() const;
};
ubool operator==(S, S); // (1)

ubool b = S{} != S{};
```

ã“ã‚Œã¯å³å¯†ã«ã¯å…ˆç¨‹ã¾ã§ã®å•é¡Œã¨é–¢ä¿‚ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ã“ã®ä¾‹ãŒã‚¨ãƒ©ãƒ¼ã¨ãªã‚‹ã®ã¯ã€(1)ã®`==`ã®æˆ»ã‚Šå€¤å‹ãŒ`bool`ã§ã¯ãªã„ã‹ã‚‰ã§ã™ã€‚`!=`ã®å°å‡ºã«ä½¿ç”¨ã•ã‚Œã‚‹`==`ã®æˆ»ã‚Šå€¤å‹ã¯`(cv)bool`ã§ãªã‘ã‚Œã°ãªã‚‰ãšã€ãã†ã§ãªã„å ´åˆã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰è§£æ±ºã§é¸ã°ã‚Œã‚‹ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚

GCCã®å®Ÿè£…ã§ã¯ã€ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰è§£æ±ºã«ãŠã„ã¦å¤‰æ›ã‚’è€ƒæ…®ã™ã‚‹å‰ã«ã€å€™è£œé›†åˆã®ä¸­ã«åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å‹ã‚’æŒã¤å€™è£œãŒã‚ã‚Šç‰‡æ–¹ãŒç”Ÿæˆã•ã‚ŒãŸå€™è£œã§ã‚ã‚‹å ´åˆã«ã€ãã®ç”Ÿæˆã•ã‚ŒãŸå€™è£œã‚’ä»¥é™ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰è§£æ±ºã§ç„¡è¦–ã™ã‚‹ã“ã¨ã§ä»¥å‰ã®æŒ¯ã‚‹èˆã„ã‚’ç¶­æŒã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®GCCå®Ÿè£…ã‚’MSVCã«ã‚‚å®Ÿè£…ã—ã¦å†åº¦ãƒ†ã‚¹ãƒˆã—ãŸã¨ã“ã‚ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã«å¤±æ•—ã—ãŸã®ã¯10ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ-10ï¼‰ã¨ãªã‚Šã¾ã—ãŸï¼ˆä¸Šè¨˜ã®å—ã‘å…¥ã‚ŒãŸã„/ãƒªã‚¸ã‚§ã‚¯ãƒˆã—ãŸã„ã‚±ãƒ¼ã‚¹ã¯æ„å›³é€šã‚Šã¨ãªã£ã¦ã„ã‚‹ï¼‰ã€‚

ã“ã®ææ¡ˆã§ã¯ã€GCCã®å®Ÿè£…ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦å®Ÿè£…ã®è‡ªç”±åº¦ã‚‚è€ƒæ…®ã—ã¦ã€ã€Œç”Ÿæˆã•ã‚ŒãŸæ¼”ç®—å­å€™è£œã«ã¤ã„ã¦ã€åŒã˜ã‚¹ã‚³ãƒ¼ãƒ—ã§å®£è¨€ã•ã‚ŒãŸåŒã˜ã‚·ã‚°ãƒãƒãƒ£ã‚’æŒã¤åˆ¥ã®å€™è£œãŒå­˜åœ¨ã—ã€ãã®å€™è£œãŒç”Ÿæˆã•ã‚Œã¦ã„ãªã„ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©ã§ã‚ã‚‹ï¼‰å€™è£œã§ã‚ã‚‹å ´åˆã€ç”Ÿæˆã•ã‚ŒãŸæ¼”ç®—å­ã¯ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰å€™è£œã‹ã‚‰é™¤å¤–ã•ã‚Œã‚‹ã€ã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰è§£æ±ºã®ãƒ«ãƒ¼ãƒ«ã«è¿½åŠ ã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚ãã‚Œã«ã‚ˆã£ã¦ã€æœ€åˆã®ä¾‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¯æ›–æ˜§ã§ã¯ãªããªã‚Šã€ä¸Šè¨˜ã®ã‚¢ã‚¯ã‚»ãƒ—ãƒˆã—ãŸã„æ—¢å­˜ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œãƒªã‚¸ã‚§ã‚¯ãƒˆã—ãŸã„ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œãªã„ã€ã¨ã„ã†æŒ¯ã‚‹èˆã„ã‚’æ‰‹ã«å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

- [P2468 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1127)

### [P2469R0 Response to P2464: The Networking TS is baked, P2300 Sender/Receiver is not.](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2469r0.pdf)

ã€Œ[P2464R0 Ruminations on networking and executors](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2464r0.html)ã€ã®ä¸»å¼µã«åè«–ã™ã‚‹æ–‡æ›¸ã€‚

ASIOï¼ˆNetworkingTSã€ä»¥ä¸‹ASIOã¨ã¯=NetworkingTSã‚‚æ„å‘³ã™ã‚‹ï¼‰ã®å®šç¾©ã™ã‚‹éåŒæœŸãƒ¢ãƒ‡ãƒ«ã«ãŠã‘ã‚‹Executorã¨ã¯ã€éåŒæœŸå‡¦ç†ã®*tail call*ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ãƒã‚¤ãƒ³ãƒˆã§ã‚ã‚‹ã¨ã„ã†å‰æã‚’èª¬æ˜ã—ã€P2300ã®æŠ½è±¡åŒ–ã¯`scheduler`ã®å…·ä½“çš„å®Ÿè£…ã‚’çŸ¥ã£ã¦ã„ãªã‘ã‚Œã°ä¸€èˆ¬çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æ§‹æˆã§ããšã€P2300ã¯éåŒæœŸãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã™ã‚‹ã‚‚ã®ã§ã¯ãªãéåŒæœŸå‡¦ç†ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®DSLã«éããšã€ASIO/NetworkingTSã®éåŒæœŸãƒ¢ãƒ‡ãƒ«ã¯P2300ã®DSLã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã‚ŠåŸºç¤çš„ãªãƒ¢ãƒ‡ãƒ«ã§ã‚ã‚‹ã¨ä¸»å¼µã—ã¦ã„ã¾ã™ã€‚

### [P2470R0 Slides for presentation of P2300R2: std::execution (sender/receiver)](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2470r0.pdf)

P2300ã®ç´¹ä»‹ãƒ»è§£èª¬ã‚¹ãƒ©ã‚¤ãƒ‰ã€‚

P2300ã®`scheduler`ã¨`sender/reciever`ã«ã‚ˆã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç´¹ä»‹ã¨ãã‚Œã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†ã‚°ãƒ©ãƒ•ã®æ§‹æˆã€`then`ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…è§£èª¬ã€ã‚³ãƒ«ãƒ¼ãƒãƒ³ã¨`sender`ã®è¦ªå’Œã€`sender`ã«ãŠã‘ã‚‹ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãªã©ã«ã¤ã„ã¦è§£èª¬ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã¾ãŸã€P2300ã®å®Ÿè£…ï¼ˆlibunifexï¼‰ãŒFacebookã«ã¦åºƒãå®Ÿé‹ç”¨ã•ã‚Œã¦ã„ã‚‹ã»ã‹ã€NVIDIAãŒãã®å®Ÿç¾ã«ã‚³ãƒŸãƒƒãƒˆã—ã¦ã„ãã“ã¨ã‚„ã€Bloombergç¤¾å†…ã§ã‚‚å¥½å°è±¡ã‚’å¾—ã¦ã„ã‚‹ã“ã¨ãŒç´¹ä»‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

### [P2471R0 NetTS, ASIO and Sender Library Design Comparison](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2471r0.pdf)

â†“

### [P2471R1 NetTS, ASIO and Sender Library Design Comparison](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2471r1.pdf)

ASIOã¨NetworkingTSã¨P2300(P0443)ã®è¨­è¨ˆã‚’æ¯”è¼ƒã™ã‚‹æ–‡æ›¸ã€‚

ãã‚Œãã‚Œã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ¢ãƒ‡ãƒ«ã‚„è¦æ±‚ã™ã‚‹ã“ã¨ãªã©ã‚’ã‚³ãƒ³ã‚»ãƒ—ãƒˆã«ã‚ˆã£ã¦è¡¨ç¾ã—ã€è¡¨ã«ã¾ã¨ã‚ã¦æ¯”è¼ƒã—ã¦ã„ã¾ã™ã€‚

### [P2472R0 make_function_ref: A More Functional function_ref](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2472r0.html)

`function_ref`ã«é©å¿œçš„ã«å‹æ¶ˆå»ã•ã›ã‚‹ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘é–¢æ•°`make_function_ref()`ã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

`function_ref`ã¯é–¢æ•°å‘¼ã³å‡ºã—å¯èƒ½ãªã‚‚ã®ã«å¯¾ã™ã‚‹`view`ã§ã‚ã‚Šã€ä¸»ã¨ã—ã¦é–¢æ•°å¼•æ•°ã§ä»»æ„ã®*Callable*ãªã‚‚ã®ã‚’å—ã‘å–ã‚‹ã¨ãã«ä½¿ç”¨ã—ã¾ã™ã€‚ãã“ã§ã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ˆã‚‹å—ã‘å–ã‚Šã¨`std::function`ã«ã‚ˆã‚‹å—ã‘å–ã‚Šã®ã„ã„ã¨ã“å–ã‚Šã®ã‚ˆã†ãªæ€§è³ªã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚

```cpp
// ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã‚ˆã‚‹å—ã‘å–ã‚Š
// é–¢æ•°ã®ã‚·ã‚°ãƒãƒãƒ£ãªã©ã®æƒ…å ±ãŒãªãã€è¿½åŠ ã®åˆ¶ç´„ãŒå¿…è¦ã«ãªã‚‹
// å¯èª­æ€§ãŒä½ä¸‹ã—ã€è¤‡é›‘ã•ãŒå¢—å¤§ã™ã‚‹
template<typeanme F>
void f(F&& f);

// std::functionã«ã‚ˆã‚‹å—ã‘å–ã‚Š
// æ‰€æœ‰æ¨©ãŒä¸æ˜ï¼ˆ`std::reference_wrapper`ã‚’ä¿æŒã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ï¼‰ã€ç©ºã‹ã‚‚ã—ã‚Œãªã„
// å‹æ¶ˆå»ã®ãŸã‚ã®è¿½åŠ ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ï¼ˆå‹•çš„ç¢ºä¿ãªã©ï¼‰ãŒå¿…è¦ã¨ãªã‚‹
void f(std::function<bool(int)> f);

// function_refã«ã‚ˆã‚‹å—ã‘å–ã‚Š
void f(function_ref<bool(int)> f);
```

`function_ref`ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãªãƒ©ãƒ ãƒ€ã‚’å«ã‚ãŸã‚ã‚‰ã‚†ã‚‹*Callable*ã‚’å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ã—ãªãŒã‚‰ã€æ±‚ã‚ã‚‰ã‚Œã¦ã„ã‚‹é–¢æ•°ã®æƒ…å ±ãŒæœ€å°ã®å½¢ã§å¼•æ•°å‹ã«è¡¨ç¤ºã•ã‚Œã€è¿½åŠ ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ã‚’å›é¿ã§ãã¾ã™ã€‚ãã—ã¦ã€`function_ref`ã¯`view`ã§ã‚ã‚Šå¸¸ã«æ‰€æœ‰æ¨©ã‚’æŒã¡ã¾ã›ã‚“ã€‚

`function_ref`ã¯æ¬¡ã®ã‚ˆã†ã«å®Ÿè£…ã•ã‚Œã¾ã™ã€‚

```cpp
template<typename F>
class function_ref;

template<typename R, typename... Args>
class function_ref<R(Args...)> {
  void* erased_object;
  R(*erased_function)(Args...);

public:

  template<typename F>
  function_ref(F&&);

  // ...
};
```

`function_ref`ã¯ãƒ¡ãƒ³ãƒã¨ã—ã¦2ã¤ã®ãƒã‚¤ãƒ³ã‚¿ã‚’æŒã¡ã€`erased_object`ã¯æ¸¡ã•ã‚ŒãŸé–¢æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãã®ã‚‚ã®ï¼ˆãƒ•ã‚¡ãƒ³ã‚¯ã‚¿ãªã©ï¼‰ã®ãƒã‚¤ãƒ³ã‚¿ã‚’ã€`erased_function`ã¯ãã®é–¢æ•°å‘¼ã³å‡ºã—æ¼”ç®—å­ã®ãƒã‚¤ãƒ³ã‚¿ã‚’ä¿æŒã—ã¾ã™ã€‚

`function_ref`ã¯ãƒ•ã‚¡ãƒ³ã‚¯ã‚¿/ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãƒ©ãƒ ãƒ€ã€é–¢æ•°ãƒã‚¤ãƒ³ã‚¿/ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãƒ©ãƒ ãƒ€ã€ãƒ¡ãƒ³ãƒé–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã€ã®3ç¨®é¡ã®*Callable*ã‚’ä¿æŒã™ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ãŒã€2ã¤ã®ãƒ¡ãƒ³ãƒãŒãƒ•ãƒ«ã«æ´»ç”¨ã•ã‚Œã‚‹ã®ã¯ãƒ•ã‚¡ãƒ³ã‚¯ã‚¿/ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãƒ©ãƒ ãƒ€ã®æ™‚ã ã‘ã§ã€ãã‚Œä»¥å¤–ã®ã‚±ãƒ¼ã‚¹ã§ã¯`erased_object`ã¯æœ‰åŠ¹åˆ©ç”¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚ãƒ¡ãƒ³ãƒé–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã«å¯¾ã™ã‚‹`this`ã‚„ãƒ•ãƒªãƒ¼é–¢æ•°ã®æœ€åˆã®å¼•æ•°ãªã©ã‚’æŸç¸›ã—ãŸä¸Šã§`function_ref`ã«æ¸¡ã™ã«ã¯ãƒ©ãƒ ãƒ€å¼ãªã©ã§ãƒ©ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€`erased_object`ã‚’æœ‰åŠ¹åˆ©ç”¨ã™ã‚Œã°ãã®å¿…è¦ãªãä¸€éƒ¨ã®å¼•æ•°ã‚’å‹æ¶ˆå»ã—ãªãŒã‚‰æŸç¸›ã™ã‚‹ã“ã¨ãŒã§ããã†ã§ã™ã€‚

ã“ã®ã‚ˆã†ãªå˜ä¸€é–¢æ•°ã«å¯¾ã™ã‚‹å®Ÿè¡Œæ™‚ãƒãƒªãƒ¢ãƒ«ãƒ•ã‚£ã‚ºãƒ ã¯ã€C#ã®ãƒ‡ãƒªã‚²ãƒ¼ãƒˆãªã©OOPã®ä¸–ç•Œã§ã‚ˆãè¦‹ã‚‰ã‚Œã€C++ã«ãŠã„ã¦ã‚‚ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‹ã‚‰é¡ä¼¼ã®ã‚‚ã®ã®ã‚¢ã‚¤ãƒ‡ã‚¢ãŒã„ãã¤ã‹æç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚ãã‚Œã‚‰ã¯å…±é€šã—ã¦ã€`function_ref`ã®2ã¤ã®ãƒ¡ãƒ³ãƒã‚’ç›´æ¥æŒ‡å®šã—ã¦åˆæœŸåŒ–ã™ã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã«ã‚ˆã£ã¦å®Ÿè£…å¯èƒ½ã§ã™ã€‚

ã“ã®ææ¡ˆã¯ãã®å®Ÿç¾ã®ãŸã‚ã€`function_ref`ã«ãã®2ã¤ã®ãƒã‚¤ãƒ³ã‚¿ãƒ¡ãƒ³ãƒã‚’ç›´æ¥åˆæœŸåŒ–å¯èƒ½ãªã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’è¿½åŠ ã—ãŸä¸Šã§ã€ãã®åˆæœŸåŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹`make_function_ref()`ãƒ˜ãƒ«ãƒ‘é–¢æ•°ã‚’è¿½åŠ ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

```cpp
template<typename F>
class function_ref;

template<typename R, typename... Args>
class function_ref<R(Args...)> {
  void* erased_object;
  R(*erased_function)(void*, Args...);

public:

  template<typename F>
  function_ref(F&&);

  // è¿½åŠ ã™ã‚‹ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
  function_ref(void* obj, R(*func)(void*, Args...))
    : erased_object{obj}
    , erased_function{func}
  {}

  // ...
};


template<auto mf, typename T>
  requires std::is_member_function_pointer<decltype(mf)>::value
auto make_function_ref(const T& obj) {
  return function_ref(std::addressof(obj), mf);
}

template<auto mf>
  requires std::is_member_function_pointer<decltype(mf)>::value
auto make_function_ref() {
  return function_ref(mf);
}

template<auto f>
  requires is_function_pointer<decltype(f)>::value
auto make_function_ref() {
  return function_ref(f);
}

// ä»–å¤šæ•°ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰
```

`make_function_ref`ã¯NTTPã¨ã—ã¦ï¼ˆãƒ¡ãƒ³ãƒï¼‰é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã‚’ã€é–¢æ•°å¼•æ•°ã§æŸç¸›å¯¾è±¡ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å—ã‘å–ã‚Šã€ãã‚Œã‚‰ã‚’æŒ‡å®šã—ã¦`function_ref`ã®2ã¤ã®ãƒ¡ãƒ³ãƒã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚ä¾‹ãˆã°æ¬¡ã®ã‚ˆã†ã«åˆ©ç”¨ã—ã¾ã™

```cpp
struct bar {
  void baz(bool b, int i, float f) {
      std::cout << "bar::baz" << std::endl;
  }

  void baznoe(bool b, int i, float f) noexcept {
      std::cout << "bar::baznoe" << std::endl;
  }
};

void third_party_lib_function1(tl::function_ref<void(bool, int, float)> callback) {
  callback(true, 11, 3.1459f);
}

void application_function_ref(function_ref<void(bar*, bool, int, float)> callback) {
  bar b;
  callback(b, true, 11, 3.1459f);
}

void free_baz1(bool b, int i, float f) {
  std::cout << "free_baz1" << std::endl;
}

int main() {
  bar b;

  // ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«ãƒ©ãƒ ãƒ€ï¼ˆmake_function_refãŒãªã„å ´åˆã®æ¸¡ã—æ–¹ï¼‰
  third_party_lib_function1([&b](bool b1, int i, float f){ b.baz(b1, i, f); });
  // ãƒ¡ãƒ³ãƒé–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã¨thisï¼ˆä¸Šè¨˜ã¨åŒç­‰ãªæ¸¡ã—æ–¹ï¼‰
  third_party_lib_function1(make_function_ref<&bar::baz>(b));
  // é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã®ã¿
  third_party_lib_function1(make_function_ref<free_baz1>());

  // ãƒ¡ãƒ³ãƒé–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã®ã¿ï¼ˆthisã¯å¾Œã‹ã‚‰æ¸¡ã™ï¼‰
  application_function_ref(make_function_ref<&bar::baz>());
  application_function_ref(make_function_ref<&bar::baznoe>());
}
```

- [`function_ref`: a non-owning reference to a Callable](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p0792r5.html)
- [P2472 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1130)

### [P2473R0 Distributing C++ Module Libraries](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2473r0.pdf)

C++ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ“ãƒ«ãƒ‰æ¸ˆã¿æˆæœç‰©ã®é…å¸ƒã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã®ã€ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ»é™çš„è§£æãƒ„ãƒ¼ãƒ«é–“ã®ç›¸äº’é‹ç”¨æ€§ã®ãŸã‚ã®å…±é€šãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ææ¡ˆã€‚

ã“ã®ææ¡ˆã¯[P2409R0](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2409r0.pdf)ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ã¦ã€ãã“ã§æŒ™ã’ã‚‰ã‚Œã¦ã„ã‚‹è¦ä»¶ã«æ²¿ã†ã‚ˆã†ãªè¦å‰‡ã‚’å®šã‚ã‚ˆã†ã¨ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚’ä½¿ç”¨ã—ã¦ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é…å¸ƒã™ã‚‹ç’°å¢ƒã§ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯ãƒ‡ã‚£ã‚¹ã‚¯ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦è¡¨ã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ã€‚ã“ã®ææ¡ˆã¯C++ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãã‚Œã‚‰ã®ãƒ“ãƒ«ãƒ‰æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦é…å¸ƒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã®è¦å‰‡ã‚’å®šã‚ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ææ¡ˆã®ç›®æ¨™ã¯ä»¥ä¸‹ã®3ç‚¹ã§ã€ãã‚Œä»¥å¤–ã®ç‚¹ã¯ç›®çš„ã¨ã—ã¦ã„ã¾ã›ã‚“

1. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ç™ºè¦‹å¯èƒ½æ€§
   - ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£é–“ã§æ±ºå®šã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ¤œç´¢ãƒ‘ã‚¹ãŒä¸ãˆã‚‰ã‚ŒãŸæ™‚ã€ãã‚Œã‚’ç”¨ã„ã¦ã‚·ã‚¹ãƒ†ãƒ ã§åˆ©ç”¨å¯èƒ½ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ã®è¦å‰‡ã‚’å®šã‚ã‚‹
2. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ‘ãƒ¼ã‚¹æ‰‹é †
   - C++ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è§£æã¨ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ç¿»è¨³å˜ä½ã®åŒºåˆ¥ãŒå°å…¥ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã€ä¸­é–“ã®ãƒã‚¤ãƒŠãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒç›¸äº’é‹ç”¨ä¸å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã€ã“ã®ææ¡ˆã§ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ãƒ¼ã‚¹æ–¹æ³•ã‚’æ”¯æŒã™ã‚‹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å®šç¾©ã™ã‚‹
3. ä¾å­˜é–¢ä¿‚ã®æ¤œå‡ºã‚’æœ€é©åŒ–ã™ã‚‹è¦å‰‡
   - ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•æ§‹ç¯‰ã®éš›ã«ã€ãƒ—ãƒªãƒ—ãƒ­ã‚»ãƒƒã‚µã®å®Ÿè¡Œã‚’å›é¿ã™ã‚‹ã“ã¨ã¯æœ›ã¾ã—ã„æœ€é©åŒ–ã®ä¸€ã¤ã§ã‚ã‚‹ãŒå¿…é ˆã§ã¯ãªã„ã€‚ã“ã®ææ¡ˆã¯ã€ãã®é¸æŠã‚’ã—ãŸå®Ÿè£…è€…ã®ãŸã‚ã®è¦ç´„ã‚’å®šã‚ã‚‹

ææ¡ˆã—ã¦ã„ã‚‹è¦å‰‡ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¯ãƒ•ã‚¡ã‚¤ãƒ«åã¨å¯¾å¿œã™ã‚‹

`import`å®£è¨€ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¯æ¬¡ã®è¦å‰‡ã«ã‚ˆã£ã¦ãƒ•ã‚¡ã‚¤ãƒ«åã«å¤‰æ›ã•ã‚Œã‚‹ã€‚

- `.`ã¯éšå±¤ã‚’è¡¨ã—ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¸å¤‰æ›ã•ã‚Œã‚‹
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ‘ãƒ¼ãƒ†ã‚¤ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã«`.part`ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒä»˜ã„ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€ãƒ•ã‚¡ã‚¤ãƒ«åã¯ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³åã¨ãªã‚‹
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å˜ä½ã®æ‹¡å¼µå­ã¯`.ixx`ã¨ãªã‚‹


|ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å|æ¤œç´¢ãƒ«ãƒ¼ãƒˆã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹|
|---|---|
|foo|foo.ixx|
|foo.bar|foo/bar.ixx|
|foo.bar:baz|foo/bar.part/baz.ixx|

ã“ã‚Œã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¤‰ã‚ã£ã¦ç¿»è¨³ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã®å¤–éƒ¨ã‹ã‚‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ï¼ˆ`import`ã«å¯¾å¿œã—ãŸèª­ã¿è¾¼ã¿ï¼‰ã™ã‚‹éš›ã«æ±ºå®šè«–çš„ãªæ¢ç´¢ãŒå¯èƒ½ã¨ãªã‚‹ã€‚

#### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹æ‰‹é †

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹æ‰‹é †ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¨ã‚‚ã«ï¼ˆåŒã˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ï¼‰é…ç½®ã•ã‚Œã€æ‹¡å¼µå­ã¯`.meta-ixx-info`ã€‚

ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¬¡ã®ã‚­ãƒ¼ã‚’æŒã¤JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã‚‹

- `include_path` : ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å˜ä½ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ—ãƒªãƒ—ãƒ­ã‚»ã‚¹æ™‚ã«å¿…è¦ãª`#include`å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªã‚¹ãƒˆã€‚æ¨™æº–ãƒ˜ãƒƒãƒ€é¡ã¯å«ã¾ã‚Œãªã„ã€‚
- `definitions` : äº‹å‰å®šç¾©ãƒã‚¯ãƒ­ã®ã‚­ãƒ¼ã¨å€¤ã®ãƒšã‚¢ã€‚
- `imports` : å¯¾å¿œã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å˜ä½ã«ã‚ˆã£ã¦ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã®ãƒªã‚¹ãƒˆã€‚ã“ã‚Œã¯ã€ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å˜ä½ã‚’è§£æã—ã¦ä¾å­˜é–¢ä¿‚ã‚’æŠŠæ¡ã™ã‚‹ã®ã‚’å›é¿ã™ã‚‹ãŸã‚ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã€‚
- `_VENDOR_extension` : ãƒ™ãƒ³ãƒ€ãƒ¼ã¯ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’æŒ‡å®šã™ã‚‹ãŸã‚ã«ã“ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ä½¿ç”¨ã§ãã‚‹

ã“ã®è¦å‰‡ã®å‰æã¨ã—ã¦ã€ãƒ—ãƒªãƒ—ãƒ­ã‚»ã‚¹æ™‚ã«é©ç”¨ã•ã‚Œã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»¥å¤–ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹ç¿»è¨³å˜ä½ã¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å˜ä½ã®ãƒ‘ãƒ¼ã‚¹ã®é–“ã§ä¸€å¾‹ã«é©ç”¨ã•ã‚Œãªã‘ã‚Œã°ãªã‚‰ãªã„ã€‚ãã‚Œã¯ä¾‹ãˆã°ã€è¨€èªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®šã™ã‚‹ãƒ•ãƒ©ã‚°ã‚„ABIäº’æ›ã«å½±éŸ¿ã™ã‚‹ãƒ•ãƒ©ã‚°ãªã©ã€‚

ã¾ãŸã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹ç¿»è¨³å˜ä½ã‹ã‚‰ã®ã‚¤ãƒ³ã‚¯ãƒ«ãƒ¼ãƒ‰ãƒ‘ã‚¹ã¨ãƒã‚¯ãƒ­å®šç¾©ã¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ¶ˆè²»ã™ã‚‹éš›ã«ä½¿ç”¨ã—ãªã„ã“ã¨ã‚‚æƒ³å®šã—ã¦ã„ã‚‹ã€‚

#### ãƒã‚¤ãƒŠãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®é…å¸ƒ

ãƒã‚¤ãƒŠãƒªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆBMIï¼‰ã®ç›¸äº’é‹ç”¨å¯èƒ½ãªç¯„å›²ã¯éå¸¸ã«é™ã‚‰ã‚Œã¦ã„ã‚‹ãŒã€ã‚³ãƒ¼ãƒ‰ãŒã»ã¼åŒã˜ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚Œã‚‹ç’°å¢ƒã§ã¯é‡è¦ãªæœ€é©åŒ–ã¨ãªã‚‹ã€‚ä¾‹ãˆã°ã€ã»ã¨ã‚“ã©ã®GNU/Linuxãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒè©²å½“ã™ã‚‹ã€‚ãŸã ã—ã€BMIãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«é©ç”¨å¯èƒ½ã‹ã©ã†ã‹ãŒè­˜åˆ¥å¯èƒ½ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã—ãŸãŒã£ã¦ã€ã“ã®ãƒ«ãƒ¼ãƒ«ã§ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ã‚µãƒãƒ¼ãƒˆã™ã‚‹äº’æ›æ€§ã¨åŒã˜ãã‚‰ã„ä¸€æ„ã®è­˜åˆ¥å­ã‚’æä¾›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

ãã®è­˜åˆ¥å­ã¯ã€`.bmi.vendor.id`ã®ã‚ˆã†ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã§ç”¨æ„ã™ã‚‹ã€‚ä¾‹ãˆã°ã€g++ãŒUUID-v4ã‚’ä½¿ç”¨ã—ã¦BMIãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åˆ©ç”¨å¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‚’è¡¨æ˜ã™ã‚‹ã«ã¯ã€`foo.bar`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å ´åˆãƒ•ã‚¡ã‚¤ãƒ«åã¯ã€Œfoo/bar.bmi.g++.20734238-4fc7-4725-bf22-be9700326774ã€ã«ãªã‚Šã¾ã™ã€‚

ã“ã®è¦å‰‡ã§ã¯ã€ã“ã®ã‚ˆã†ãªè­˜åˆ¥å­ã®ã†ã¡ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯1ã¤ã®å…¥åŠ›å½¢å¼ã ã‘ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯ãƒ•ã‚¡ã‚¤ãƒ«åã®æœ‰åŠ¹ãªæ‹¡å¼µå­ã¨ãªã‚‹ä»»æ„ã®è­˜åˆ¥å­ã‚’ä½¿ç”¨ã§ãã€è¤‡æ•°ã®è­˜åˆ¥å­ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆå¯èƒ½ã ãŒã€ã“ã“ã§ãã‚Œã‚’è¦å®šã™ã‚‹ã¨æ¢ç´¢ã®è¤‡é›‘ã•ãŒå¢—å¤§ã™ã‚‹ã€‚

#### æ¤œç´¢é †åº

ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ¢ç´¢æ™‚ã¯ã€æœ€åˆã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©å›ºæœ‰ã®BMIï¼ˆæ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚‚ã®ãªã©ï¼‰ã‚’æ¢ç´¢ã—ã¦ã‹ã‚‰2å›ç›®ã®æ¢ç´¢ã§`.ixx`ãƒ•ã‚¡ã‚¤ãƒ«ã¨`.meta-ixx-info`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ç´¢ã§ãã‚‹ã¯ãšã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ é–“ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«BMIãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆã§ãã‚‹ã€‚

#### BMIãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã‚’æœ€é©åŒ–ã—ãªã„

ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒç¾åœ¨ã®ãƒ“ãƒ«ãƒ‰ã¨äº’æ›æ€§ã®ã‚ã‚‹BMIãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã‚’ç¢ºèªã—ãŸæ™‚ã€ä¾å­˜é–¢ä¿‚ã®æ¢ç´¢ã‚’ã‚„ã‚ã¦ç›´æ¥ãã‚Œã‚’æ¶ˆè²»ã™ã‚‹ã“ã¨ãŒæœ‰åŠ¹ãªæœ€é©åŒ–ã ãŒã€ãã†ã™ã‚‹ã¨ã€ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã¯é€£æºã™ã‚‹ãƒ„ãƒ¼ãƒ«ã‹ã‚‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ‘ãƒ¼ã‚¹ã‚’å†ç¾ã™ã‚‹æ–¹æ³•ã®è©³ç´°ã‚’éš è”½ã—ã¦ã—ã¾ã†ã€‚ã—ãŸãŒã£ã¦ã€ç›¸äº’é‹ç”¨æ€§ã‚’ç¶­æŒã—ãŸã„ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒãªã„ã¨åˆ¤æ–­ã—ãŸå ´åˆã§ã‚‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ‘ãƒ¼ã‚¹ã‚’ç¶™ç¶šã—ã¦ã€ãã®æƒ…å ±ã‚’ç¾åœ¨ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚ˆã†ã«åˆ©ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

#### Discovery tooling

ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æä¾›ã•ã‚Œã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ¨ç§»çš„ãªé–¢ä¿‚ã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«ã€å…¨ã¦ã®å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è§£æã™ã‚‹ã‚‚ã®ãŒå¿…è¦ã¨ãªã‚‹ã€‚ãã®ãŸã‚ã«ã€`c++-modules-config`ã¨å‘¼ã°ã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã‚’ææ¡ˆã™ã‚‹ã€‚

ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ¢ç´¢ãƒ‘ã‚¹ã€BMIãƒ•ã‚¡ã‚¤ãƒ«ã®è­˜åˆ¥å­ã€è§£æ±ºãŒå¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã®ãƒªã‚¹ãƒˆã‚’å…¥åŠ›ã¨ã—ã€ãƒ“ãƒ«ãƒ‰ã«é–¢ä¿‚ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å®Œå…¨ãªãƒªã‚¹ãƒˆã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ã‚½ãƒ¼ã‚¹ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã®ã«å¿…è¦ãªæ‰‹é †ã€ãŠã‚ˆã³ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾å­˜é–¢ä¿‚ã‚’å‡ºåŠ›ã™ã‚‹ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã¯å†å¸°çš„ãªæ¢ç´¢ã‚’è¡Œã„ã€ãƒ“ãƒ«ãƒ‰ã‚·ã‚¹ãƒ†ãƒ ãŒæ¶ˆè²»ã™ã‚‹å¿…è¦ã®ã‚ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹å…¨ã¦ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ‘ãƒ¼ã‚¹ã‚’è¨ˆç”»ã™ã‚‹ã®ã«ååˆ†ãªè¨˜è¿°ã‚’è¿”ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€åˆ©ç”¨å¯èƒ½ã ãŒæ¶ˆè²»ã•ã‚Œã‚‹äºˆå®šã®ãªã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯é™¤å¤–ã•ã‚Œã‚‹ã€‚

ã“ã®ãƒ„ãƒ¼ãƒ«ã®å‡ºåŠ›ã¯[P1689R4](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p1689r4.html)ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¨äº’æ›æ€§ã‚’æŒãŸã›ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã¾ãŸã“ã®å‡ºåŠ›ã¯`module_config.json`ã¨ã„ã†åå‰ã§ã€ç¾åœ¨`compile_commands.json`ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹å ´æ‰€ã¨åŒã˜å ´æ‰€ã«ä¿å­˜ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

- [P2473 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1131)

### [P2475R0 WG21 2021-10 Virtual Meeting Record of Discussion](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2475r0.pdf)

2021å¹´10æœˆ4æ—¥ï¼ˆåŒ—ç±³æ™‚é–“ï¼‰ã«è¡Œã‚ã‚ŒãŸã€WG21å…¨ä½“ä¼šè­°ã®ãƒ‡ã‚¤ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³è­°äº‹éŒ²ã€‚

CWG/LWG/LEWGã®æŠ•ç¥¨æ™‚ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã®æ§˜å­ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚

### [P2477R0 Allow programmer to control and detect coroutine elision by static constexpr bool should_elide() and](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2477r0.html)

ã‚³ãƒ«ãƒ¼ãƒãƒ³ã®å‹•çš„ãƒ¡ãƒ¢ãƒªç¢ºä¿ã‚’é¿ã‘ã‚‹æœ€é©åŒ–ã‚’åˆ¶å¾¡ã—ã€èµ·ã“ã£ãŸã“ã¨ã‚’æ¤œå‡ºã™ã‚‹APIã‚’è¿½åŠ ã™ã‚‹ææ¡ˆã€‚

ã‚³ãƒ«ãƒ¼ãƒãƒ³ã¯ã‚µã‚¹ãƒšãƒ³ãƒ‰ã¨å†é–‹ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«ãã®çŠ¶æ…‹ï¼ˆã‚³ãƒ«ãƒ¼ãƒãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰ã‚’ä¿å­˜ã—ã¦ãŠãé ˜åŸŸã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚ç¾åœ¨ã®C++ã‚³ãƒ«ãƒ¼ãƒãƒ³ã§ã¯ã€ã“ã®é ˜åŸŸã®ç¢ºä¿ã¯å‹•çš„ãƒ¡ãƒ¢ãƒªç¢ºä¿ï¼ˆ`operator new`ï¼‰ã«ã‚ˆã£ã¦è¡Œã‚ã‚Œã€ãã‚Œã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã™ã€‚

ãã‚Œã‚’è»½æ¸›ã™ã‚‹ãŸã‚ã«ã€[HALO](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0981r0.html)ã¨å‘¼ã°ã‚Œã‚‹å‹•çš„ãƒ¡ãƒ¢ãƒªç¢ºä¿ã‚’å›é¿ã™ã‚‹æœ€é©åŒ–ãŒãƒ‡ã‚¶ã‚¤ãƒ³ã•ã‚Œã¦ãŠã‚Šã€ã“ã‚Œã‚’*coroutine elision*ã¨å‘¼ã³ã¾ã™ã€‚clang/LLVMã§ã¯ãã‚Œã¯CoroElideã¨ã—ã¦å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚C++æ¨™æº–ã§ã¯åå‰ä»˜ã‘ã•ã‚Œã¦ã„ãªã„ã‚‚ã®ã®*coroutine elision*ã¯è¨±å¯ã•ã‚Œã¦ã„ã¾ã™ï¼ˆã¤ã¾ã‚Šå¿…é ˆã§ã¯ãªã„ï¼‰ã€‚

ã“ã‚Œã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®æœ€é©åŒ–ã§ã‚ã‚Šã€å¿…ãšè¡Œã‚ã‚Œã‚‹ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ã‚³ãƒ«ãƒ¼ãƒãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒã¯ã“ã®æœ€é©åŒ–ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ã‚‚ã€ãã‚ŒãŒè¡Œã‚ã‚ŒãŸã“ã¨ã‚’å¯ŸçŸ¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã›ã‚“ã€‚

ã¾ãŸã€çµ„ã¿è¾¼ã¿ã®ã‚ˆã†ã«ãƒªã‚½ãƒ¼ã‚¹ãŒé™ã‚‰ã‚Œã¦ã„ã‚‹ç’°å¢ƒã§ã¯*coroutine elision*ã‚’ç„¡åŠ¹åŒ–ã—ãŸã†ãˆã§`promise_type::operator new`ãŒé™çš„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ãƒã‚¤ãƒˆé…åˆ—ã‹ã‚‰ã®é ˜åŸŸã‚’è¿”ã™ã‚ˆã†ã«ã™ã‚‹ã“ã¨ãŒå¥½ã¾ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚ã—ã‹ã—ã€*coroutine elision*ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹æ–¹æ³•ã‚‚ã¾ãŸæ¨™æº–ã§ã¯æä¾›ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚

ã“ã®ææ¡ˆã§ã¯ã€*coroutine elision*ã‚’åˆ¶å¾¡ã™ã‚‹ãŸã‚ã®`promise_type::should_elide()`ã€*coroutine elision*ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã®`std::coroutine_handle<>::elided()`ã®2ã¤ã®é–¢æ•°ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒã¯*coroutine elision*ã‚’åˆ¶å¾¡ã—æ¤œå‡ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

`should_elide()`ã¯æ¬¡ã®ã‚ˆã†ã«*coroutine elision*ã®å®Ÿè¡Œã«ã¤ã„ã¦ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«æŒ‡ç¤ºã—ã¾ã™

- `promise_type`ã®ã‚¹ã‚³ãƒ¼ãƒ—ã§`should_elide()`ã¨ã„ã†é–¢æ•°ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ãã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«è©•ä¾¡ã—ãŸçµæœãŒ
    - `true`ã«è©•ä¾¡ã•ã‚ŒãŸå ´åˆ : *coroutine elision*ãŒä¿è¨¼ã•ã‚Œã‚‹
    - `false`ã«è©•ä¾¡ã•ã‚ŒãŸå ´åˆ : *coroutine elision*ãŒè¡Œã‚ã‚Œãªã„ã“ã¨ãŒä¿è¨¼ã•ã‚Œã‚‹
- `should_elide()`ãŒè¦‹ã¤ã‹ã‚‰ãªã„ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«è©•ä¾¡ã§ããªã„å ´åˆ
    - å¾“æ¥é€šã‚Šï¼ˆ*coroutine elision*ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã®è£é‡ã§è¡Œã‚ã‚Œã‚‹ï¼‰

`should_elide()`ã¯`promise_type`ã®ãƒ¡ãƒ³ãƒé–¢æ•°ã¨ã—ã¦å®Ÿè£…ã•ã‚Œã‚‹ã‚‚ã®ã§ã€`promise_type`ã¯ã‚³ãƒ«ãƒ¼ãƒãƒ³ã®å‹•ä½œã‚’ã‚«ã‚¹ã‚¿ãƒ ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®šç¾©ã—ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€`should_elide()`ã‚‚ã¾ãŸå¿…è¦ã§ã‚ã‚Œã°ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå®šç¾©ã™ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€ãã‚Œã¯`constexpr`é–¢æ•°ã¨ã—ã¦å®šç¾©ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

`elided()`ã¯`std::coroutine_handle`ã®ãƒ¡ãƒ³ãƒé–¢æ•°ã¨ã—ã¦è¿½åŠ ã•ã‚Œã€*coroutine elision*ãŒè¡Œã‚ã‚Œã¦ã„ãŸæ™‚ã«`true`ã‚’è¿”ã—ã€è¡Œã‚ã‚Œã¦ã„ãªã„å ´åˆã«`false`ã‚’è¿”ã—ã¾ã™ã€‚


```cpp
namespace std {
  template<>
  struct coroutine_handle<void> { 
    // ...

    bool elided() const noexcept; // è¿½åŠ 
    
    // ...
  };

  template<class Promise>
  struct coroutine_handle<Promise> {
    // ...
    
    bool elided() const noexcept; // è¿½åŠ 
    
    // ...
  };
}
```

- [C++20 ã‚³ãƒ«ãƒ¼ãƒãƒ³ - cpprefjp](https://cpprefjp.github.io/lang/cpp20/coroutines.html)
- [P2477 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1133)

### [P2478R0 _Thread_local for better C++ interoperability with C](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2478r0.pdf)

C++`thread_local`å¤‰æ•°ã¯å‹•çš„åˆæœŸåŒ–ã¨ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å‘¼ã³å‡ºã—ã‚’ä¼´ã†ã“ã¨ãŒã§ãã¾ã™ã€‚ãã®åˆæœŸåŒ–ã¯ã€ã‚¹ãƒ¬ãƒƒãƒ‰èµ·å‹•æ™‚ã«éãƒ–ãƒ­ãƒƒã‚¯ï¼ˆåå‰ç©ºé–“ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰å¤‰æ•°ã«å¯¾ã—ã¦è¡Œã‚ã‚Œã‚‹ã‹ã€æœ€åˆã«å¤‰æ•°ãŒä½¿ç”¨ã•ã‚Œã‚‹ã¨ãã«è¡Œã‚ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®ä¸»ãªå®Ÿè£…ã¯ã€å¤‰æ•°ãŒä½¿ç”¨ã•ã‚Œã‚‹å ´æ‰€ã«é–¢æ•°ã‚’æŒ¿å…¥ã—ã€ãã®é–¢æ•°ãŒå‘¼ã°ã‚Œã‚‹ã“ã¨ã§éãƒ–ãƒ­ãƒƒã‚¯å¤‰æ•°ã®é…å»¶åˆæœŸåŒ–ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

ãã®ã‚ˆã†ãªé–¢æ•°ã¨ãã®å‘¼ã³å‡ºã—ã«ã‚ˆã£ã¦å®Ÿè¡Œæ™‚ã«ã‚µã‚¤ã‚ºã¨æ™‚é–“ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒã‹ã‹ã‚Šã¾ã™ã€‚ã“ã‚Œã¯å¤‰æ•°ãŒå‹•çš„åˆæœŸåŒ–ã‚‚ãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿å‘¼ã³å‡ºã—ã‚‚å¿…è¦ãªã„ã“ã¨ãŒåˆ†ã‹ã£ã¦ã„ã‚Œã°å›é¿å¯èƒ½ã§ã™ã€‚

ã“ã®ã“ã¨ã¯ã€å˜ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒã‹ã‹ã‚‹ã ã‘ã§ã¯ãªãã€Cã®`_Thread_local`ã¨ã®éäº’æ›ã‚’ç”Ÿã¿å‡ºã—ã¦ã„ã¾ã™ã€‚Cã®`_Thread_local`ã¯C++`thread_local`ã¨ã—ã¦ã®ä½¿ç”¨ã«å¿…è¦ãªã‚‚ã®ï¼ˆåˆæœŸåŒ–ãƒ»ç ´æ£„ã«å¿…è¦ãªè¿½åŠ ã®é–¢æ•°ãªã©ï¼‰ã‚’æä¾›ã—ã¾ã›ã‚“ã€‚ã“ã®ãŸã‚ã€C`_Thread_local`å¤‰æ•°ã‚’C++ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å‚ç…§ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ã¾ãŸã€C++ã§å®šç¾©ã•ã‚ŒãŸå‹•çš„åˆæœŸåŒ–ã•ã‚Œã‚‹ã‹éãƒˆãƒªãƒ“ã‚¢ãƒ«ãªãƒ‡ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚‚ã¤é™çš„å¤‰æ•°ï¼ˆéã‚¹ãƒ¬ãƒƒãƒ‰ãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ã«Cã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã¯ã€C++ã‹ã‚‰åŒã˜ã‚‚ã®ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã®ã¨æ¯”ã¹ã¦å±é™ºã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãªãœãªã‚‰ã€ä¸»è¦ãªå®Ÿè£…ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ èµ·å‹•æ™‚ã«ãã‚Œã‚‰ã®åˆæœŸåŒ–ã‚’è¡Œã†ãŸã‚ã§ã™ã€‚ã—ã‹ã—ã€åŒæ§˜ã«å®£è¨€ã•ã‚Œã¦ã„ã‚‹ã‚¹ãƒ¬ãƒƒãƒ‰ãƒ­ãƒ¼ã‚«ãƒ«ãªå¤‰æ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸå ´åˆã¯åŒã˜ã“ã¨ã¯è¨€ãˆã¾ã›ã‚“ã€‚Cã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯åˆæœŸåŒ–å‰ã®å¤‰æ•°ã‚’è¦³æ¸¬ã™ã‚‹å¯èƒ½æ€§ãŒé«˜ããªã‚Šã¾ã™ã€‚

ã“ã®ææ¡ˆã¯C23ã«å¯¾ã—ã¦ã€`_Thread_local`ã‚’`thread_local`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ç½®ãæ›ãˆã‚‹ã®ã‚’ã‚„ã‚ã‚‹ã‚ˆã†ã«ææ¡ˆã™ã‚‹ã‚‚ã®ã§ã™ã€‚ä¸Šè¨˜ã®ã‚ˆã†ãªå•é¡ŒãŒã‚ã‚‹ãŸã‚ã€å®‰æ˜“ã«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’C++ã¨å…±é€šåŒ–ã—ã¦ã—ã¾ã†ã“ã¨ã¯å±é™ºã§ã™ã€‚ä¸€æ–¹ã€C++ãŒä¸Šè¨˜å•é¡Œã®å›é¿ã‚’è¡Œã„ãŸã„å ´åˆã«Cã¨åŒæ§˜ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã§`_Thread_local`ã‚’ä½¿ç”¨ã™ã‚‹æ–¹å‘æ€§ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚

- [P2478 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1134)

### [P2479R0 Slides for P2464](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2479r0.pdf)

[P2464R0 Ruminations on networking and executors](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2464r0.html)ã®ç´¹ä»‹ã‚¹ãƒ©ã‚¤ãƒ‰ã€‚

å¾ŒåŠã§ã¯P2469ã«å¯¾ã™ã‚‹åè«–ã‚‚è¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚

### [P2480R0 Response to P2471: "NetTS, Asio, and Sender library design comparison" - corrected and expanded](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2480r0.pdf)

[P2471R1](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2471r1.pdf)ã®è¨‚æ­£ã‚„è¿½è¨˜ã‚’è¡Œã†æ–‡æ›¸ã€‚

P2471R1ã¯ASIO/NetrworkingTSã¨P2300ã¨ã®æ¯”è¼ƒã‚’è¡Œã£ã¦ã„ã‚‹æ–‡æ›¸ã§ã™ãŒã€ãã®å†…å®¹ã«ã¤ã„ã¦ä¸æ­£ç¢ºãªéƒ¨åˆ†ã‚’ä¿®æ­£ã—ãŸã‚Šè¿½è¨˜ã—ãŸã‚Šã™ã‚‹æ–‡æ›¸ã§ã™ã€‚

### [P2481R0 Forwarding reference to specific type/template](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2021/p2481r0.html)

ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æŒ‡å®šæ™‚ã«`const`ã¨ä¾¡ã‚«ãƒ†ã‚´ãƒªã‚’æŒ‡å®šå¯èƒ½ã«ã™ã‚‹æ§‹æ–‡ã®å¿…è¦æ€§ã«ã¤ã„ã¦èª¬æ˜ã—ãŸæ–‡æ›¸ã€‚

`std::tuple<Ts...>`ã«ã¯`std::tuple<Us...>`ã‹ã‚‰ã®å¤‰æ›ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå­˜åœ¨ã—ã¾ã™ã€‚ãã‚Œã¯ã€`Us...`ã®ãã‚Œãã‚ŒãŒå¯¾å¿œã™ã‚‹`Ts...`ã®ãã‚Œãã‚Œã«å¤‰æ›å¯èƒ½ã§ã‚ã‚Œã°åˆ©ç”¨å¯èƒ½ã¨ãªã‚Šã¾ã™ãŒã€`std::tuple<Us...>`ã®çŠ¶æ…‹ã«ã‚ˆã£ã¦4ã¤ã®å®šç¾©ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚

```cpp
template <typename... Ts>
struct tuple {
  template <typename... Us>
      requires sizeof...(Ts) == sizeof...(Us)
            && (is_constructible_v<Ts, Us&> && ...)
  tuple(tuple<Us...>&);

  template <typename... Us>
      requires sizeof...(Ts) == sizeof...(Us)
            && (is_constructible_v<Ts, Us const&> && ...)
  tuple(tuple<Us...> const&); // (1)

  template <typename... Us>
      requires sizeof...(Ts) == sizeof...(Us)
            && (is_constructible_v<Ts, Us&&> && ...)
  tuple(tuple<Us...>&&);      // (2)

  template <typename... Us>
      requires sizeof...(Ts) == sizeof...(Us)
            && (is_constructible_v<Ts, Us const&&> && ...)
  tuple(tuple<Us...> const&&);
};
```

ã“ã‚Œã¯ç°¡æ˜“ãªä¾‹ã§ã—ã‹ãªã„ã®ã§æ­£ç¢ºã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªã“ã¨ã¯ã€`tuple<Us...>`ãŒ`const`ã®æœ‰ç„¡ã¨å€¤ã‚«ãƒ†ã‚´ãƒªã®çµ„ã¿åˆã‚ã›ã§2x2=4ã¤ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ãŒå¿…è¦ã¨ãªã‚‹ã†ãˆã€åˆ¶ç´„ã‚‚ãã‚Œã«å¿œã˜ã¦å¾®å¦™ã«ç´°éƒ¨ã‚’èª¿æ•´ã—ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚

ã“ã‚Œã¯ã‹ãªã‚Šå†—é•·ãªã‚³ãƒ¼ãƒ‰ã§ã‚ã‚‹ã†ãˆã€ã“ã‚Œã‚‰ãŒã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰ã€ã‚ã‚‹é©åˆ‡ãªã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒãã®åˆ¶ç´„ã«ã‚ˆã£ã¦é©åˆ‡ã«å€™è£œã‹ã‚‰å¤–ã‚ŒãŸæ™‚ã§ã‚‚ã€åˆ¥ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå‘¼ã°ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

```cpp
void f(tuple<int&>);
auto g() -> tuple<int&&>;

void h() {
  f(g()); // ok!
}
```

ã“ã‚Œã¯ã€`tuple<int&&> -> tuple<int&>`ã®æ§‹ç¯‰ã‚’è¡Œã£ã¦ã„ã‚‹ã‚‚ã®ã§ã€`int&& -> int&`ã®ã‚ˆã†ãªè¿”é‚„ã¯ä¸å¯èƒ½ãªã®ã§å¤±æ•—ã—ã¦ã»ã—ã„ã—å¤±æ•—ã™ã‚‹ã¯ãšã§ã™ã€‚ã—ã‹ã—å®Ÿéš›ã«ã¯ã€(2)ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒåˆ¶ç´„ã‚’æº€ãŸã•ãªã„ãŸã‚ã«é™¤å¤–ã•ã‚ŒãŸå¾Œã€(1)ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒåˆ©ç”¨ã•ã‚Œã¾ã™ã€‚`g()`ã®æˆ»ã‚Šå€¤ã¯å³è¾ºå€¤ã§ã‚ã‚Šã€(1)ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®`tuple<Us...> const&`ã§ã‚‚å—ã‘ã‚‹ã“ã¨ãŒã§ãã¦ã€ãã®åˆ¶ç´„ä¸­ã®`Us const&`ã¯`int&& const & -> int&`ã¨ãªã£ã¦`int& -> int&`ã®å¤‰æ›ãŒå¯èƒ½ã§ã‚ã‚‹ã“ã¨ã‹ã‚‰(1)ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å‘¼ã³å‡ºã—ã¦ã—ã¾ã„ã¾ã™ã€‚

ã“ã®å•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã«ã¯ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’1ã¤ã ã‘ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å¿…è¦ãªã“ã¨ã¯ã€`tuple<Us...>`ã‚’æŒ‡å®šã—ãªãŒã‚‰ã€CVãƒ»å‚ç…§ä¿®é£¾ã‚’æ¨è«–ã—ã¦ã‚‚ã‚‰ã†ã“ã¨ã§ã™ã€‚ç¾åœ¨ã®ã¨ã“ã‚ãã‚Œã¯ã§ããšã€ä¸Šè¨˜ã®ã‚ˆã†ã«æ›¸ãã‹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã“ã­å›ã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```cpp
template <typename... Ts>
struct tuple {
  template <typename Other>
      requires is_specialization_of<remove_cvref_t<Other>, tuple>
            && /* ???? */
  tuple(Other&& rhs);
};
```

ã—ã‹ã—ã€ã“ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®åˆ¶ç´„ã‚’æ­£ã—ãæ›¸ãäº‹ã¯å›°é›£ã§ã€ã„ã„è§£æ±ºç­–ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚çµå±€ã€æœ€ä½4ã¤ã®ä¼¼ãŸã‚ˆã†ãªã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ‰ã‚’ç”¨æ„ã™ã‚‹ã®ãŒä¸€ç•ªç°¡æ˜“ã¨ãªã‚Šã¾ã™ã€‚

ã“ã‚Œã¨åŒã˜å•é¡Œã¯ã€`std::get`ã§ã‚‚è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```cpp
template <size_t I, typename... Ts>
auto get(tuple<Ts...>&) -> tuple_element_t<I, tuple<Ts...>>&;

template <size_t I, typename... Ts>
auto get(tuple<Ts...> const&) -> tuple_element_t<I, tuple<Ts...>> const&;

template <size_t I, typename... Ts>
auto get(tuple<Ts...>&&) -> tuple_element_t<I, tuple<Ts...>>&&;

template <size_t I, typename... Ts>
auto get(tuple<Ts...> const&&) -> tuple_element_t<I, tuple<Ts...>> const&&;
```

ã“ã‚Œã‚‚ä¸€ã¤ã®é–¢æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§è¨˜è¿°ã‚’å‰Šæ¸›ã§ãå…ˆã»ã©ã®ã‚ˆã†ãªå•é¡Œã‚’å›é¿ã§ãã¾ã™ãŒã€ã‚„ã¯ã‚Šãã®åˆ¶ç´„ã‚’æ­£ã—ãæ›¸ãã“ã¨ãŒå›°é›£ã§ã€`std:tuple`ã®æ´¾ç”Ÿå‹ã«å¯¾ã—ã¦æ©Ÿèƒ½ã—ãªããªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

`std::optional::transform`ã®ã‚ˆã†ãªãƒ¡ãƒ³ãƒé–¢æ•°ã¨*deducing this*ã‚’çµ„ã¿åˆã‚ã›ãŸæ™‚ã«ã‚‚ã€åˆ¥ã®å•é¡ŒãŒæµ®ã‹ã³ä¸ŠãŒã‚Šã¾ã™ã€‚

```cpp
template <typename T>
struct optional {
  template <typename F>
  constexpr auto transform(F&&) &;

  template <typename F>
  constexpr auto transform(F&&) const&;

  template <typename F>
  constexpr auto transform(F&&) &&;

  template <typename F>
  constexpr auto transform(F&&) const&&;
};
```

ã“ã®ã‚ˆã†ãªå†—é•·ãªã‚³ãƒ¼ãƒ‰ã¯ã€*deducing this*ã«ã‚ˆã£ã¦æ¬¡ã®ã‚ˆã†ã«ã²ã¨ã¾ã¨ã‚ã«ã§ãã¾ã™ã€‚

```cpp
template <typename T>
struct optional {
  template <typename Self, typename F>
  constexpr auto transform(this Self&&, F&&);
};
```

ã—ã‹ã—ã€ä»Šåº¦ã¯ã“ã®`Self`ã®å¯¾è±¡ã¨ã™ã‚‹ç¯„å›²ãŒåºƒã™ãã¾ã™ã€‚ã“ã“ã§ã¯`std::optional`ã®æ´¾ç”Ÿå‹ã‚’å¯¾è±¡ã¨ã—ãŸãã¯ãªãã€ã‚„ã£ã¦ã»ã—ã„ã“ã¨ã¯CVãƒ»å‚ç…§ä¿®é£¾ã®æ¨è«–ã ã‘ã§ã™ã€‚

ã“ã‚Œã‚‰ã®å•é¡Œã¯ã€ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ãŠã„ã¦ã‚ã‚‹ç¨‹åº¦å‹ã‚’æŒ‡å®šã—ãªãŒã‚‰ã§ã‚‚CVãƒ»å‚ç…§ä¿®é£¾ã®æ¨è«–ãŒå¯èƒ½ã¨ãªã£ã¦ãã‚Œã‚Œã°è§£æ±ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®æ–‡æ›¸ã§ã¯ã€ã„ãã¤ã‹ã®æ§‹æ–‡ã®å€™è£œã‚’æç¤ºã™ã‚‹ã¨ã¨ã‚‚ã«ã‚ˆã‚Šè‰¯ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’å‹Ÿã£ã¦ã„ã¾ã™ï¼ˆã¾ã ææ¡ˆã«ã¯è‡³ã£ã¦ã„ã¾ã›ã‚“ï¼‰ã€‚

ä»¥ä¸‹ã®ä¾‹ã§ã¯æ¬¡ã®ã‚ˆã†ãªãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™

```cpp
#define FWD(e) static_cast<decltype(e)&&>(e)

template <bool RV, typename T>
using apply_ref = std::conditional_t<RV, T&&, T&>;

template <bool C, typename T>
using apply_const = std::conditional_t<C, T const, T>;

template <bool C, bool RV, typename T>
using apply_const_ref = apply_ref<RV, apply_const<C, T>>;

template <typename T, typename U>
using copy_cvref_t = apply_const_ref<
  is_const_v<remove_reference_t<T>>,
  !is_lvalue_reference_v<T>,
  U>;
```

#### `T auto&&`

ã“ã‚Œã¯ã‚³ãƒ³ã‚»ãƒ—ãƒˆã«ã‚ˆã‚‹ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€å‹ã®åˆ¶ç´„ï¼ˆ`range auto&& r`ï¼‰ã‚’ç™ºå±•ã•ã›ã¦ã€ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’æŒ‡å®šã™ã‚‹éƒ¨åˆ†ã«ã‚ˆã‚Šå…·ä½“çš„ãªå‹ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ãŸã‚‚ã®ã§ã™

```cpp
template <typename... Ts>
struct tuple {
  template <typename... Us>
  tuple(tuple<Us...> auto&& rhs)
    requires sizeof...(Us) == sizeof...(Ts)
          && (constructible_from<
                Ts,
                copy_cvref_t<decltype(rhs), Us>
              > && ...);
};
```
```cpp
template <typename T>
struct optional {
  template <typename F>
  auto transform(this optional auto&& self, F&& f) {
      using U = remove_cv_t<invoke_result_t<F,
          decltype(FWD(self).value())>;

      if (self) {
        return optional<U>(invoke(FWD(f), FWD(self).value()));
      } else {
        return optional<U>();
      }
  }
};
```

- åˆ©ç‚¹
  - ç°¡æ½”ã«ã‚„ã‚ŠãŸã„ã“ã¨ã‚’å®Ÿç¾ãƒ»è¡¨ç¾ã§ãã‚‹
- æ¬ ç‚¹
  - æ­£ç¢ºãªå‹ã‚’å–å¾—ã™ã‚‹ã«ã¯`decltype(param)`ã¨ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„
      - ã“ã®ãŸã‚ã€`requires`ç¯€ã‚’é–¢æ•°ã®å¾Œã‚ã«ã—ã‹æ›¸ã‘ãªããªã‚‹
  - `concept auto`ã®è¨˜æ³•ã¨çŸ›ç›¾ã™ã‚‹ï¼ˆã“ã®æ§‹æ–‡ã¯å¤‰æ›ã‚’è¡Œã‚ãªã„ï¼‰

#### `T&&&`

å…ˆã»ã©ã®ã€`T auto&&`ã®ä»£ã‚ã‚Šã«`T&&&`ã‚’å°å…¥ã™ã‚‹ã‚‚ã®ã§ã™ã€‚ï¼ˆã‚µãƒ³ãƒ—ãƒ«ã¯çœç•¥ï¼‰

- åˆ©ç‚¹
  - `tuple<Us...>&&&`ã¯æ´¾ç”Ÿå‹ã‹ã‚‰ã®å¤‰æ›ã‚’è¡Œã†ã“ã¨ãŒã§ãã‚‹
- æ¬ ç‚¹
  - `T auto&&`ã¨åŒã˜
  - `T&&&`ã¨ã„ã†å‚ç…§ãƒˆãƒ¼ã‚¯ãƒ³ãã®ã‚‚ã®

#### `const(bool)`

`noexcept(bool)`ã‚„`explicit(bool)`ã®ã‚ˆã†ã«ã€`const`ã¨`&&`ã‚’æ¡ä»¶ä»˜ãã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

```cpp
template <typename... Ts>
struct tuple {
  template <typename... Us, bool C, bool RV>
    requires sizeof...(Us) == sizeof...(Ts)
          && (constructible_from<
                Ts,
                apply_const_ref<C, RV, Us>
              > && ...)
  tuple(tuple<Us...> const(C) &&(RV) rhs);
};
```
```cpp
template <typename T>
struct optional {
  template <typename F, bool C, bool RV>
  auto transform(this optional const(C) &&(RV) self, F&& f) {
    using U = remove_cv_t<invoke_result_t<F,
        // apply_const_ref<C, RV, T>
        decltype(FWD(self).value())>;

    if (self) {
      return optional<U>(invoke(FWD(f), FWD(self).value()));
    } else {
      return optional<U>();
    }
  }
};
```

- åˆ©ç‚¹
  - `const`æ€§ã¨å‚ç…§ä¿®é£¾ã ã‘ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã“ã¨ãŒæ˜ç¢ºã«ãªã‚‹
  - `requires`ç¯€ã®é…ç½®è‡ªç”±åº¦ãŒä¿ãŸã‚Œã‚‹
- æ¬ ç‚¹
  - æ§‹æ–‡ãŒå¥‡å¦™ï¼ˆç‰¹ã«`&&(bool)`ï¼‰
  - æ¨è«–ã•ã‚ŒãŸ`bool`å€¤ã‚’ä½¿ç”¨ã™ã‚‹ã®ã«ãƒ¡ã‚¿ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãŒå¿…è¦ã«ãªã‚‹

#### `Q`ä¿®é£¾å­

ã“ã‚Œã¯å…¨ãæ–°ã—ã„å½¢ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°å…¥ã™ã‚‹ã‚‚ã®ã§ã€ã“ã‚Œã‚’`qualifier`ï¼ˆä¿®é£¾å­ï¼‰ã¨å‘¼ã³ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ¨è«–ã—ã¾ã™

```cpp
template <typename... Ts>
struct tuple {
  template <typename... Us, qualifiers Q>
    requires sizeof...(Us) == sizeof...(Ts)
          && (constructible_from<Ts, Q<Us>> && ...)
  tuple(Q<tuple<Us...>> rhs);
};
```
```cpp
template <typename T>
struct optional {
  template <typename F, qualifiers Q>
  auto transform(this Q<optional> self, F&& f) {
    using U = remove_cv_t<invoke_result_t<F, Q<T>>>;

    if (self) {
      return optional<U>(invoke(FWD(f), FWD(self).value()));
    } else {
      return optional<U>();
    }
  }
};
```

ã“ã“ã§ã¯ã€`Q<T>`ã®`Q`ã¨`T`ã¯ãã‚Œãã‚Œåˆ¥ã€…ã«æ¨è«–ã•ã‚Œã¾ã™ãŒã€`Q`ã¯æ¬¡ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã„ãšã‚Œã‹ã¨ã—ã¦æ¨è«–ã•ã‚Œã¾ã™

```cpp
template <typename T>
using Q = T&;

template <typename T>
using Q = T const&;

template <typename T>
using Q = T&&;

template <typename T>
using Q = T const&&;
```

- åˆ©ç‚¹
  - æ¨è«–ã—ãŸCVãƒ»å‚ç…§ä¿®é£¾ã‚’é©ç”¨ï¼ˆåˆ©ç”¨ï¼‰ã™ã‚‹ã®ãŒå®¹æ˜“
  - æ­£ç¢ºãªå‹ã®å–å¾—ãŒå®¹æ˜“
- æ¬ ç‚¹
  - æ–¬æ–°ãªæ§‹æ–‡ã§ã‚ã‚Šã€å¥‡å¦™
  - `Q`ã®åå‰ãŒå•é¡Œã¨ãªã‚‹
  - `const`ã ã‘ã‚’æ¨è«–ã—ãŸã„ã¨ãã«ã€èª¤ç”¨ã®å¯èƒ½æ€§ãŒã‚ã‚‹

ä½œè€…ã®æ–¹ã¯ã“ã‚Œã‚‰ã®è§£æ±ºç­–ã«ç´å¾—ã—ã¦ãªã„ã‚‰ã—ãã€ã‚ˆã‚Šè‰¯ã„æ§‹æ–‡ã‚’å‹Ÿã‚‹ãŸã‚ã«ã“ã®æ–‡æ›¸ã‚’æ›¸ã„ãŸã‚ˆã†ã§ã™ã€‚

- [P2481 é€²è¡ŒçŠ¶æ³](https://github.com/cplusplus/papers/issues/1137)